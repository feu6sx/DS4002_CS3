<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8" />
<title>How to Develop a CNN for MNIST Handwritten Digit Classification - MachineLearningMastery.com</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="pingback" href="https://machinelearningmastery.com/xmlrpc.php" />
<script data-no-optimize="1" data-cfasync="false">!function(){"use strict";function e(e){const t=e.match(/((?=([a-z0-9._!#$%+^&*()[\]<>-]+))\2@[a-z0-9._-]+\.[a-z0-9._-]+)/gi);return t?t[0]:""}function t(t){return e(a(t.toLowerCase()))}function a(e){return e.replace(/\s/g,"")}async function n(e){const t={sha256Hash:"",sha1Hash:""};if(!("msCrypto"in window)&&"https:"===location.protocol&&"crypto"in window&&"TextEncoder"in window){const a=(new TextEncoder).encode(e),[n,c]=await Promise.all([s("SHA-256",a),s("SHA-1",a)]);t.sha256Hash=n,t.sha1Hash=c}return t}async function s(e,t){const a=await crypto.subtle.digest(e,t);return Array.from(new Uint8Array(a)).map(e=>("00"+e.toString(16)).slice(-2)).join("")}function c(e){let t=!0;return Object.keys(e).forEach(a=>{0===e[a].length&&(t=!1)}),t}function i(e,t,a){e.splice(t,1);const n="?"+e.join("&")+a.hash;history.replaceState(null,"",n)}var o={checkEmail:e,validateEmail:t,trimInput:a,hashEmail:n,hasHashes:c,removeEmailAndReplaceHistory:i,detectEmails:async function(){const e=new URL(window.location.href),a=Array.from(e.searchParams.entries()).map(e=>`${e[0]}=${e[1]}`);let s,o;const r=["adt_eih","sh_kit"];if(a.forEach((e,t)=>{const a=decodeURIComponent(e),[n,c]=a.split("=");if("adt_ei"===n&&(s={value:c,index:t,emsrc:"url"}),r.includes(n)){o={value:c,index:t,emsrc:"sh_kit"===n?"urlhck":"urlh"}}}),s)t(s.value)&&n(s.value).then(e=>{if(c(e)){const t={value:e,created:Date.now()};localStorage.setItem("adt_ei",JSON.stringify(t)),localStorage.setItem("adt_emsrc",s.emsrc)}});else if(o){const e={value:{sha256Hash:o.value,sha1Hash:""},created:Date.now()};localStorage.setItem("adt_ei",JSON.stringify(e)),localStorage.setItem("adt_emsrc",o.emsrc)}s&&i(a,s.index,e),o&&i(a,o.index,e)},cb:"adthrive"};const{detectEmails:r,cb:l}=o;r()}();
</script><meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	
<script>
MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};

</script>
<style data-no-optimize="1" data-cfasync="false">
	.adthrive-ad {
		margin-top: 10px;
		margin-bottom: 10px;
		text-align: center;
		overflow-x: visible;
		clear: both;
		line-height: 0;
	}
	.adthrive-ad.adthrive-sidebar.adthrive-sidebar-9.adthrive-sticky {
top: 3rem
}

.adthrive-content.adthrive-ad-cls {
min-height: 90px !important;
}

/* offset sticky sidebar */
.adthrive-ad.adthrive-sticky-sidebar > div {
  top: 225px !important;
}</style>
<script data-no-optimize="1" data-cfasync="false">
	window.adthriveCLS = {
		enabledLocations: ['Content', 'Recipe'],
		injectedSlots: [],
		injectedFromPlugin: true,
		branch: '9c650da',bucket: 'prod',			};
	window.adthriveCLS.siteAds = {"betaTester":false,"targeting":[{"value":"5d4c8ca4693e634b2e5d98cf","key":"siteId"},{"value":"6233884dd842a370880ea737","key":"organizationId"},{"value":"Machine Learning Mastery","key":"siteName"},{"value":"Prime","key":"service"},{"value":"on","key":"bidding"},{"value":["Tech"],"key":"verticals"}],"siteUrl":"https://machinelearningmastery.com/blog","siteId":"5d4c8ca4693e634b2e5d98cf","siteName":"Machine Learning Mastery","breakpoints":{"tablet":768,"desktop":1024},"cloudflare":null,"adUnits":[{"sequence":null,"targeting":[{"value":["Sidebar"],"key":"location"}],"devices":["desktop","tablet"],"name":"Sidebar","sticky":false,"location":"Sidebar","dynamic":{"pageSelector":"","spacing":0,"max":1,"lazyMax":null,"enable":true,"lazy":false,"elementSelector":".widget #right-sidebar","skip":0,"classNames":[],"position":"afterbegin","every":1,"enabled":true},"stickyOverlapSelector":"","adSizes":[[300,250]],"priority":299,"autosize":false},{"sequence":null,"targeting":[{"value":["Content"],"key":"location"}],"devices":["desktop","tablet"],"name":"Content","sticky":false,"location":"Content","dynamic":{"pageSelector":"body.post-template-default","spacing":1.5,"max":9,"lazyMax":90,"enable":true,"lazy":true,"elementSelector":".entry > h3, .entry > h4, .entry > h2","skip":1,"classNames":[],"position":"beforebegin","every":1,"enabled":true},"stickyOverlapSelector":"","adSizes":[[1,1],[1,2],[250,250],[300,250],[300,300],[320,100],[336,280],[468,60],[552,334],[728,90],[728,250],[300,200],[320,300]],"priority":199,"autosize":true},{"sequence":null,"targeting":[{"value":["Content"],"key":"location"}],"devices":["phone"],"name":"Content","sticky":false,"location":"Content","dynamic":{"pageSelector":"body.post-template-default","spacing":1.5,"max":9,"lazyMax":90,"enable":true,"lazy":true,"elementSelector":".entry > h3, .entry > h4, .entry > h2","skip":1,"classNames":[],"position":"beforebegin","every":1,"enabled":true},"stickyOverlapSelector":"","adSizes":[[1,1],[1,2],[250,250],[300,50],[300,250],[300,300],[320,50],[320,100],[300,200],[320,300]],"priority":199,"autosize":true},{"sequence":1,"targeting":[{"value":["Below Post"],"key":"location"}],"devices":["desktop","tablet","phone"],"name":"Below_Post_1","sticky":false,"location":"Below Post","dynamic":{"pageSelector":"","spacing":0,"max":0,"lazyMax":1,"enable":true,"lazy":true,"elementSelector":".crp_related  ","skip":0,"classNames":[],"position":"beforebegin","every":1,"enabled":true},"stickyOverlapSelector":"","adSizes":[[1,1],[250,250],[300,250],[320,50],[320,100],[336,280],[468,60],[728,90],[728,250],[970,250],[300,50],[300,200],[300,300],[320,300]],"priority":99,"autosize":true},{"sequence":null,"targeting":[{"value":["Footer"],"key":"location"},{"value":true,"key":"sticky"}],"devices":["desktop","tablet","phone"],"name":"Footer","sticky":true,"location":"Footer","dynamic":{"pageSelector":"body.post-template-default","spacing":0,"max":1,"lazyMax":null,"enable":true,"lazy":false,"elementSelector":"body","skip":0,"classNames":[],"position":"beforeend","every":1,"enabled":true},"stickyOverlapSelector":"","adSizes":[[320,50],[320,100],[728,90],[970,90],[468,60],[1,1],[300,50]],"priority":-1,"autosize":true},{"sequence":9,"targeting":[{"value":["Sidebar"],"key":"location"},{"value":true,"key":"sticky"}],"devices":["desktop","tablet"],"name":"Sidebar_9","sticky":true,"location":"Sidebar","dynamic":{"pageSelector":"body.single","spacing":0,"max":1,"lazyMax":null,"enable":true,"lazy":false,"elementSelector":"aside#sidebar","skip":0,"classNames":[],"position":"beforeend","every":1,"enabled":true},"stickyOverlapSelector":"#footer","adSizes":[[1,1],[160,600],[250,250],[300,50],[300,250],[300,420],[300,600],[300,1050],[320,50],[320,100],[336,280]],"priority":291,"autosize":false}],"adDensityLayout":{"mobile":{"adDensity":0.22,"onePerViewport":false},"pageOverrides":[{"mobile":{"adDensity":0.22,"onePerViewport":false},"note":null,"pageSelector":"body.post-template-default","desktop":{"adDensity":0.22,"onePerViewport":false}}],"desktop":{"adDensity":0.22,"onePerViewport":false}},"adDensityEnabled":true,"siteExperiments":[],"adTypes":{"sponsorTileDesktop":true,"interscrollerDesktop":true,"nativeBelowPostDesktop":true,"miniscroller":true,"largeFormatsMobile":true,"nativeMobileContent":true,"inRecipeRecommendationMobile":true,"nativeMobileRecipe":true,"sponsorTileMobile":true,"expandableCatalogAdsMobile":false,"outstreamMobile":true,"nativeHeaderMobile":true,"inRecipeRecommendationDesktop":true,"nativeDesktopContent":true,"outstreamDesktop":false,"animatedFooter":true,"skylineHeader":false,"expandableFooter":false,"nativeDesktopSidebar":true,"videoFootersMobile":true,"videoFootersDesktop":true,"interscroller":false,"nativeDesktopRecipe":true,"nativeHeaderDesktop":true,"nativeBelowPostMobile":true,"expandableCatalogAdsDesktop":false,"largeFormatsDesktop":true},"adOptions":{"theTradeDesk":true,"rtbhouse":true,"undertone":false,"sidebarConfig":{"dynamicStickySidebar":{"minHeight":1800,"enabled":true,"blockedSelectors":[]}},"footerCloseButton":true,"teads":true,"pmp":true,"thirtyThreeAcross":true,"sharethrough":true,"optimizeVideoPlayersForEarnings":true,"removeVideoTitleWrapper":true,"pubMatic":true,"infiniteScroll":false,"yahoossp":true,"improvedigital":true,"spa":false,"stickyContainerConfig":{"recipeDesktop":{"minHeight":null,"enabled":false},"blockedSelectors":[],"stickyHeaderSelectors":[],"content":{"minHeight":null,"enabled":false},"recipeMobile":{"minHeight":null,"enabled":false}},"sonobi":true,"yieldmo":true,"footerSelector":"","amazonUAM":true,"gamMCMEnabled":true,"gamMCMChildNetworkCode":"22523581566","stickyContainerAds":false,"rubiconMediaMath":true,"rubicon":true,"conversant":false,"openx":true,"customCreativeEnabled":true,"mobileHeaderHeight":1,"secColor":"#000000","unruly":true,"mediaGrid":true,"bRealTime":true,"adInViewTime":null,"gumgum":true,"comscoreFooter":false,"desktopInterstitial":false,"footerCloseButtonDesktop":true,"ozone":true,"isAutoOptimized":false,"adform":true,"comscoreTAL":true,"targetaff":false,"bgColor":"#FFFFFF","tripleLiftMobile":true,"advancePlaylistOptions":{"playlistPlayer":{"enabled":true},"relatedPlayer":{"enabled":true,"applyToFirst":true}},"kargo":true,"liveRampATS":true,"footerCloseButtonMobile":true,"interstitialBlockedPageSelectors":"","prioritizeShorterVideoAds":true,"allowSmallerAdSizes":true,"comscore":null,"wakeLock":{"desktopEnabled":true,"mobileValue":15,"mobileEnabled":true,"desktopValue":30},"mobileInterstitial":false,"tripleLift":true,"sensitiveCategories":["alc","ast","cbd","conl","cosm","dat","drg","gamc","gamv","pol","rel","sst","ssr","srh","ske","tob","wtl"],"liveRamp":true,"adthriveEmailIdentity":true,"criteo":true,"nativo":true,"infiniteScrollOptions":{"selector":"","heightThreshold":0},"siteAttributes":{"mobileHeaderSelectors":[],"desktopHeaderSelectors":[]},"dynamicContentSlotLazyLoading":true,"clsOptimizedAds":true,"ogury":true,"aidem":true,"verticals":["Tech"],"inImage":false,"usCMP":{"enabled":false,"regions":[]},"advancePlaylist":true,"flipp":true,"delayLoading":true,"tripleLiftDesktop":false,"inImageZone":null,"appNexus":false,"rise":true,"liveRampId":"","infiniteScrollRefresh":false,"indexExchange":true},"siteAdsProfiles":[],"videoPlayers":{"contextual":{"autoplayCollapsibleEnabled":false,"overrideEmbedLocation":false,"defaultPlayerType":"static"},"videoEmbed":"div","footerSelector":"","contentSpecificPlaylists":[],"players":[{"pageSelector":"","devices":["mobile"],"mobileLocation":"top-right","description":"","skip":0,"title":"","type":"stickyPlaylist","enabled":false,"footerSelector":"","formattedType":"Sticky Playlist","elementSelector":"","id":4062755,"position":"afterend","saveVideoCloseState":false,"shuffle":true},{"pageSelector":"","devices":["desktop"],"description":"","skip":0,"title":"","type":"stickyPlaylist","enabled":false,"footerSelector":"","formattedType":"Sticky Playlist","elementSelector":"","id":4062754,"position":"afterend","saveVideoCloseState":false,"shuffle":true},{"devices":["desktop","mobile"],"formattedType":"Stationary Related","description":"","id":4062751,"title":"Stationary related player - desktop and mobile","type":"stationaryRelated","enabled":false,"playerId":null},{"pageSelector":"","devices":["desktop"],"formattedType":"Sticky Related","description":"","elementSelector":"","skip":0,"id":4062752,"position":"afterend","title":"Sticky related player - desktop","type":"stickyRelated","enabled":false,"playerId":null},{"pageSelector":"","devices":["mobile"],"mobileLocation":"top-right","description":"","skip":0,"title":"Sticky related player - mobile","type":"stickyRelated","enabled":false,"formattedType":"Sticky Related","elementSelector":"","id":4062753,"position":"afterend","playerId":null}],"partners":{"theTradeDesk":true,"unruly":true,"mediaGrid":true,"undertone":false,"gumgum":true,"adform":true,"pmp":true,"kargo":true,"thirtyThreeAcross":true,"stickyOutstream":{"desktop":{"enabled":true},"blockedPageSelectors":"body.category","mobileLocation":null,"allowOnHomepage":false,"mobile":{"enabled":false},"saveVideoCloseState":false,"mobileHeaderSelector":"","allowForPageWithStickyPlayer":{"enabled":true}},"sharethrough":true,"tripleLift":true,"pubMatic":true,"criteo":true,"yahoossp":true,"nativo":true,"improvedigital":true,"aidem":true,"yieldmo":true,"amazonUAM":true,"rubicon":true,"appNexus":false,"rise":true,"openx":true,"indexExchange":true}}};</script>

<script data-no-optimize="1" data-cfasync="false">
(function(w, d) {
	w.adthrive = w.adthrive || {};
	w.adthrive.cmd = w.adthrive.cmd || [];
	w.adthrive.plugin = 'adthrive-ads-3.7.4';
	w.adthrive.host = 'ads.adthrive.com';
	w.adthrive.integration = 'plugin';

	var commitParam = (w.adthriveCLS && w.adthriveCLS.bucket !== 'prod' && w.adthriveCLS.branch) ? '&commit=' + w.adthriveCLS.branch : '';

	var s = d.createElement('script');
	s.async = true;
	s.referrerpolicy='no-referrer-when-downgrade';
	s.src = 'https://' + w.adthrive.host + '/sites/5d4c8ca4693e634b2e5d98cf/ads.min.js?referrer=' + w.encodeURIComponent(w.location.href) + commitParam + '&cb=' + (Math.floor(Math.random() * 100) + 1) + '';
	var n = d.getElementsByTagName('script')[0];
	n.parentNode.insertBefore(s, n);
})(window, document);
</script>
<link rel="dns-prefetch" href="https://ads.adthrive.com/"><link rel="preconnect" href="https://ads.adthrive.com/"><link rel="preconnect" href="https://ads.adthrive.com/" crossorigin>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>

	<!-- This site is optimized with the Yoast SEO plugin v24.9 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>How to Develop a CNN for MNIST Handwritten Digit Classification - MachineLearningMastery.com</title>
	<link rel="canonical" href="https://www.machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="How to Develop a CNN for MNIST Handwritten Digit Classification - MachineLearningMastery.com" />
	<meta property="og:description" content="How to Develop a Convolutional Neural Network From Scratch for MNIST Handwritten Digit Classification. The MNIST handwritten digit classification problem is a standard dataset used in computer vision and deep learning. Although the dataset is effectively solved, it can be used as the basis for learning and practicing how to develop, evaluate, and use convolutional [&hellip;]" />
	<meta property="og:url" content="https://www.machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/" />
	<meta property="og:site_name" content="MachineLearningMastery.com" />
	<meta property="article:publisher" content="https://www.facebook.com/MachineLearningMastery/" />
	<meta property="article:author" content="https://www.facebook.com/MachineLearningMastery/" />
	<meta property="article:published_time" content="2019-05-07T19:00:02+00:00" />
	<meta property="article:modified_time" content="2021-11-14T05:05:20+00:00" />
	<meta property="og:image" content="https://www.machinelearningmastery.com/wp-content/uploads/2019/02/Plot-of-a-Subset-of-Images-from-the-MNIST-Dataset.png" />
	<meta property="og:image:width" content="1280" />
	<meta property="og:image:height" content="960" />
	<meta property="og:image:type" content="image/png" />
	<meta name="author" content="Jason Brownlee" />
	<meta name="twitter:label1" content="Written by" />
	<meta name="twitter:data1" content="Jason Brownlee" />
	<meta name="twitter:label2" content="Est. reading time" />
	<meta name="twitter:data2" content="34 minutes" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://www.machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#article","isPartOf":{"@id":"https://www.machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/"},"author":{"name":"Jason Brownlee","@id":"https://www.machinelearningmastery.com/#/schema/person/8a7b819d3cca7cfe78f1e65296f0c8fe"},"headline":"How to Develop a CNN for MNIST Handwritten Digit Classification","datePublished":"2019-05-07T19:00:02+00:00","dateModified":"2021-11-14T05:05:20+00:00","mainEntityOfPage":{"@id":"https://www.machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/"},"wordCount":3842,"commentCount":193,"publisher":{"@id":"https://www.machinelearningmastery.com/#organization"},"image":{"@id":"https://www.machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#primaryimage"},"thumbnailUrl":"https://machinelearningmastery.com/wp-content/uploads/2019/02/Plot-of-a-Subset-of-Images-from-the-MNIST-Dataset.png","articleSection":["Deep Learning for Computer Vision"],"inLanguage":"en-US","potentialAction":[{"@type":"CommentAction","name":"Comment","target":["https://www.machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#respond"]}]},{"@type":"WebPage","@id":"https://www.machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/","url":"https://www.machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/","name":"How to Develop a CNN for MNIST Handwritten Digit Classification - MachineLearningMastery.com","isPartOf":{"@id":"https://www.machinelearningmastery.com/#website"},"primaryImageOfPage":{"@id":"https://www.machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#primaryimage"},"image":{"@id":"https://www.machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#primaryimage"},"thumbnailUrl":"https://machinelearningmastery.com/wp-content/uploads/2019/02/Plot-of-a-Subset-of-Images-from-the-MNIST-Dataset.png","datePublished":"2019-05-07T19:00:02+00:00","dateModified":"2021-11-14T05:05:20+00:00","breadcrumb":{"@id":"https://www.machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://www.machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/"]}]},{"@type":"ImageObject","inLanguage":"en-US","@id":"https://www.machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#primaryimage","url":"https://machinelearningmastery.com/wp-content/uploads/2019/02/Plot-of-a-Subset-of-Images-from-the-MNIST-Dataset.png","contentUrl":"https://machinelearningmastery.com/wp-content/uploads/2019/02/Plot-of-a-Subset-of-Images-from-the-MNIST-Dataset.png","width":1280,"height":960,"caption":"Plot of a Subset of Images From the MNIST Dataset"},{"@type":"BreadcrumbList","@id":"https://www.machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://machinelearningmastery.com/"},{"@type":"ListItem","position":2,"name":"Blog","item":"https://machinelearningmastery.com/blog/"},{"@type":"ListItem","position":3,"name":"How to Develop a CNN for MNIST Handwritten Digit Classification"}]},{"@type":"WebSite","@id":"https://www.machinelearningmastery.com/#website","url":"https://www.machinelearningmastery.com/","name":"MachineLearningMastery.com","description":"Making developers awesome at machine learning","publisher":{"@id":"https://www.machinelearningmastery.com/#organization"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://www.machinelearningmastery.com/?s={search_term_string}"},"query-input":{"@type":"PropertyValueSpecification","valueRequired":true,"valueName":"search_term_string"}}],"inLanguage":"en-US"},{"@type":"Organization","@id":"https://www.machinelearningmastery.com/#organization","name":"Machine Learning Mastery","url":"https://www.machinelearningmastery.com/","logo":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://www.machinelearningmastery.com/#/schema/logo/image/","url":"https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon.png","contentUrl":"https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon.png","width":512,"height":512,"caption":"Machine Learning Mastery"},"image":{"@id":"https://www.machinelearningmastery.com/#/schema/logo/image/"},"sameAs":["https://www.facebook.com/MachineLearningMastery/","https://x.com/TeachTheMachine","https://www.linkedin.com/company/machine-learning-mastery"]},{"@type":"Person","@id":"https://www.machinelearningmastery.com/#/schema/person/8a7b819d3cca7cfe78f1e65296f0c8fe","name":"Jason Brownlee","image":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://www.machinelearningmastery.com/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=96&d=mm&r=g","caption":"Jason Brownlee"},"description":"Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.","sameAs":["https://machinelearningmastery.com","https://www.facebook.com/MachineLearningMastery/","https://www.linkedin.com/company/machine-learning-mastery","https://x.com/teachthemachine"],"url":"https://machinelearningmastery.com/author/jasonb/"}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//cdn.jsdelivr.net' />
<link rel="alternate" type="application/rss+xml" title="MachineLearningMastery.com &raquo; Feed" href="https://feeds.feedburner.com/MachineLearningMastery" />
<link rel="alternate" type="application/rss+xml" title="MachineLearningMastery.com &raquo; Comments Feed" href="https://machinelearningmastery.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="MachineLearningMastery.com &raquo; How to Develop a CNN for MNIST Handwritten Digit Classification Comments Feed" href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/feed/" />
		<!-- This site uses the Google Analytics by MonsterInsights plugin v9.4.1 - Using Analytics tracking - https://www.monsterinsights.com/ -->
							<script src="//www.googletagmanager.com/gtag/js?id=G-JZP3DWZZ8W"  data-cfasync="false" data-wpfc-render="false" type="text/javascript" async></script>
			<script data-cfasync="false" data-wpfc-render="false" type="text/javascript">
				var mi_version = '9.4.1';
				var mi_track_user = true;
				var mi_no_track_reason = '';
								var MonsterInsightsDefaultLocations = {"page_location":"https:\/\/machinelearningmastery.com\/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification\/"};
				if ( typeof MonsterInsightsPrivacyGuardFilter === 'function' ) {
					var MonsterInsightsLocations = (typeof MonsterInsightsExcludeQuery === 'object') ? MonsterInsightsPrivacyGuardFilter( MonsterInsightsExcludeQuery ) : MonsterInsightsPrivacyGuardFilter( MonsterInsightsDefaultLocations );
				} else {
					var MonsterInsightsLocations = (typeof MonsterInsightsExcludeQuery === 'object') ? MonsterInsightsExcludeQuery : MonsterInsightsDefaultLocations;
				}

								var disableStrs = [
										'ga-disable-G-JZP3DWZZ8W',
									];

				/* Function to detect opted out users */
				function __gtagTrackerIsOptedOut() {
					for (var index = 0; index < disableStrs.length; index++) {
						if (document.cookie.indexOf(disableStrs[index] + '=true') > -1) {
							return true;
						}
					}

					return false;
				}

				/* Disable tracking if the opt-out cookie exists. */
				if (__gtagTrackerIsOptedOut()) {
					for (var index = 0; index < disableStrs.length; index++) {
						window[disableStrs[index]] = true;
					}
				}

				/* Opt-out function */
				function __gtagTrackerOptout() {
					for (var index = 0; index < disableStrs.length; index++) {
						document.cookie = disableStrs[index] + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
						window[disableStrs[index]] = true;
					}
				}

				if ('undefined' === typeof gaOptout) {
					function gaOptout() {
						__gtagTrackerOptout();
					}
				}
								window.dataLayer = window.dataLayer || [];

				window.MonsterInsightsDualTracker = {
					helpers: {},
					trackers: {},
				};
				if (mi_track_user) {
					function __gtagDataLayer() {
						dataLayer.push(arguments);
					}

					function __gtagTracker(type, name, parameters) {
						if (!parameters) {
							parameters = {};
						}

						if (parameters.send_to) {
							__gtagDataLayer.apply(null, arguments);
							return;
						}

						if (type === 'event') {
														parameters.send_to = monsterinsights_frontend.v4_id;
							var hookName = name;
							if (typeof parameters['event_category'] !== 'undefined') {
								hookName = parameters['event_category'] + ':' + name;
							}

							if (typeof MonsterInsightsDualTracker.trackers[hookName] !== 'undefined') {
								MonsterInsightsDualTracker.trackers[hookName](parameters);
							} else {
								__gtagDataLayer('event', name, parameters);
							}
							
						} else {
							__gtagDataLayer.apply(null, arguments);
						}
					}

					__gtagTracker('js', new Date());
					__gtagTracker('set', {
						'developer_id.dZGIzZG': true,
											});
					if ( MonsterInsightsLocations.page_location ) {
						__gtagTracker('set', MonsterInsightsLocations);
					}
										__gtagTracker('config', 'G-JZP3DWZZ8W', {"forceSSL":"true","author":"Jason Brownlee","category":"Deep Learning for Computer Vision"} );
															window.gtag = __gtagTracker;										(function () {
						/* https://developers.google.com/analytics/devguides/collection/analyticsjs/ */
						/* ga and __gaTracker compatibility shim. */
						var noopfn = function () {
							return null;
						};
						var newtracker = function () {
							return new Tracker();
						};
						var Tracker = function () {
							return null;
						};
						var p = Tracker.prototype;
						p.get = noopfn;
						p.set = noopfn;
						p.send = function () {
							var args = Array.prototype.slice.call(arguments);
							args.unshift('send');
							__gaTracker.apply(null, args);
						};
						var __gaTracker = function () {
							var len = arguments.length;
							if (len === 0) {
								return;
							}
							var f = arguments[len - 1];
							if (typeof f !== 'object' || f === null || typeof f.hitCallback !== 'function') {
								if ('send' === arguments[0]) {
									var hitConverted, hitObject = false, action;
									if ('event' === arguments[1]) {
										if ('undefined' !== typeof arguments[3]) {
											hitObject = {
												'eventAction': arguments[3],
												'eventCategory': arguments[2],
												'eventLabel': arguments[4],
												'value': arguments[5] ? arguments[5] : 1,
											}
										}
									}
									if ('pageview' === arguments[1]) {
										if ('undefined' !== typeof arguments[2]) {
											hitObject = {
												'eventAction': 'page_view',
												'page_path': arguments[2],
											}
										}
									}
									if (typeof arguments[2] === 'object') {
										hitObject = arguments[2];
									}
									if (typeof arguments[5] === 'object') {
										Object.assign(hitObject, arguments[5]);
									}
									if ('undefined' !== typeof arguments[1].hitType) {
										hitObject = arguments[1];
										if ('pageview' === hitObject.hitType) {
											hitObject.eventAction = 'page_view';
										}
									}
									if (hitObject) {
										action = 'timing' === arguments[1].hitType ? 'timing_complete' : hitObject.eventAction;
										hitConverted = mapArgs(hitObject);
										__gtagTracker('event', action, hitConverted);
									}
								}
								return;
							}

							function mapArgs(args) {
								var arg, hit = {};
								var gaMap = {
									'eventCategory': 'event_category',
									'eventAction': 'event_action',
									'eventLabel': 'event_label',
									'eventValue': 'event_value',
									'nonInteraction': 'non_interaction',
									'timingCategory': 'event_category',
									'timingVar': 'name',
									'timingValue': 'value',
									'timingLabel': 'event_label',
									'page': 'page_path',
									'location': 'page_location',
									'title': 'page_title',
									'referrer' : 'page_referrer',
								};
								for (arg in args) {
																		if (!(!args.hasOwnProperty(arg) || !gaMap.hasOwnProperty(arg))) {
										hit[gaMap[arg]] = args[arg];
									} else {
										hit[arg] = args[arg];
									}
								}
								return hit;
							}

							try {
								f.hitCallback();
							} catch (ex) {
							}
						};
						__gaTracker.create = newtracker;
						__gaTracker.getByName = newtracker;
						__gaTracker.getAll = function () {
							return [];
						};
						__gaTracker.remove = noopfn;
						__gaTracker.loaded = true;
						window['__gaTracker'] = __gaTracker;
					})();
									} else {
										console.log("");
					(function () {
						function __gtagTracker() {
							return null;
						}

						window['__gtagTracker'] = __gtagTracker;
						window['gtag'] = __gtagTracker;
					})();
									}
			</script>
				<!-- / Google Analytics by MonsterInsights -->
		<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.1.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.1.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.8"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\ud83d\udd25","\ud83d\udc26\u200b\ud83d\udd25")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<!-- machinelearningmastery.com is managing ads with Advanced Ads 2.0.5 – https://wpadvancedads.com/ --><script id="machi-ready">
			window.advanced_ads_ready=function(e,a){a=a||"complete";var d=function(e){return"interactive"===a?"loading"!==e:"complete"===e};d(document.readyState)?e():document.addEventListener("readystatechange",(function(a){d(a.target.readyState)&&e()}),{once:"interactive"===a})},window.advanced_ads_ready_queue=window.advanced_ads_ready_queue||[];		</script>
		<style type="text/css">
@media only screen and (min-width: 980px) {
body.two-col-left-1280 #main-sidebar-container { width: 100%; }
body.two-col-left-1280 #main-sidebar-container #sidebar { width: 28.385%; }
body.two-col-left-1280 #main-sidebar-container #main { width: 68.385%; }
}
</style>
<link rel='stylesheet' id='urvanov_syntax_highlighter-css' href='https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/min/urvanov_syntax_highlighter.min.css?ver=2.8.38' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css' href='https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/themes/classic/classic.css?ver=2.8.38' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css' href='https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/fonts/monaco.css?ver=2.8.38' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://machinelearningmastery.com/wp-includes/css/dist/block-library/style.min.css?ver=6.8' type='text/css' media='all' />
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='safe-svg-svg-icon-style-inline-css' type='text/css'>
.safe-svg-cover{text-align:center}.safe-svg-cover .safe-svg-inside{display:inline-block;max-width:100%}.safe-svg-cover svg{height:100%;max-height:100%;max-width:100%;width:100%}

</style>
<style id='cloudcatch-splide-carousel-style-inline-css' type='text/css'>
.wp-block-splide-carousel{position:relative;visibility:hidden}.wp-block-splide-carousel .splide__container{box-sizing:border-box;position:relative}.wp-block-splide-carousel .splide__list{backface-visibility:hidden;display:flex;height:100%;margin:0!important;padding:0!important}.wp-block-splide-carousel.is-initialized:not(.is-active) .splide__list{display:block}.wp-block-splide-carousel .splide__pagination{align-items:center;display:flex;flex-wrap:wrap;justify-content:center;margin:0;pointer-events:none}.wp-block-splide-carousel .splide__pagination li{display:inline-block;line-height:1;list-style-type:none;margin:0;pointer-events:auto}.wp-block-splide-carousel:not(.is-overflow) .splide__pagination{display:none}.wp-block-splide-carousel .splide__progress__bar{width:0}.wp-block-splide-carousel.is-initialized,.wp-block-splide-carousel.is-rendered{visibility:visible}.wp-block-splide-carousel .splide__slide{backface-visibility:hidden;box-sizing:border-box;flex-shrink:0;list-style-type:none!important;margin:0;position:relative}.wp-block-splide-carousel .splide__slide img{vertical-align:bottom}.wp-block-splide-carousel .splide__spinner{animation:splide-loading 1s linear infinite;border:2px solid #999;border-left-color:transparent;border-radius:50%;bottom:0;contain:strict;display:inline-block;height:20px;left:0;margin:auto;position:absolute;right:0;top:0;width:20px}.wp-block-splide-carousel .splide__sr{clip:rect(0 0 0 0);border:0;height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.wp-block-splide-carousel .splide__toggle.is-active .splide__toggle__play,.wp-block-splide-carousel .splide__toggle__pause{display:none}.wp-block-splide-carousel .splide__toggle.is-active .splide__toggle__pause{display:inline}.wp-block-splide-carousel .splide__track{overflow:hidden;position:relative;z-index:0}@keyframes splide-loading{0%{transform:rotate(0)}to{transform:rotate(1turn)}}.wp-block-splide-carousel .splide__track--draggable{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.wp-block-splide-carousel .splide__track--fade>.splide__list>.splide__slide{margin:0!important;opacity:0;z-index:0}.wp-block-splide-carousel .splide__track--fade>.splide__list>.splide__slide.is-active{opacity:1;z-index:1}.wp-block-splide-carousel.splide--rtl{direction:rtl}.wp-block-splide-carousel .splide__track--ttb>.splide__list{display:block}.wp-block-splide-carousel .splide__arrow{align-items:center;background:#ccc;border:0;border-radius:50%;cursor:pointer;display:flex;height:2em;justify-content:center;opacity:.7;padding:0;position:absolute;top:50%;transform:translateY(-50%);width:2em;z-index:1}.wp-block-splide-carousel .splide__arrow svg{fill:#000;height:1.2em;width:1.2em}.wp-block-splide-carousel .splide__arrow:hover:not(:disabled){opacity:.9}.wp-block-splide-carousel .splide__arrow:disabled{opacity:.3}.wp-block-splide-carousel .splide__arrow:focus-visible{outline:3px solid #0bf;outline-offset:3px}.wp-block-splide-carousel .splide__arrow--prev{left:1em}.wp-block-splide-carousel .splide__arrow--prev svg{transform:scaleX(-1)}.wp-block-splide-carousel .splide__arrow--next{right:1em}.wp-block-splide-carousel.is-focus-in .splide__arrow:focus{outline:3px solid #0bf;outline-offset:3px}.wp-block-splide-carousel .splide__pagination{bottom:.5em;left:0;padding:0 1em;position:absolute;right:0;z-index:1}.wp-block-splide-carousel .splide__pagination__page{background:#ccc;border:0;border-radius:50%;display:inline-block;height:8px;margin:3px;opacity:.7;padding:0;position:relative;transition:transform .2s linear;width:8px}.wp-block-splide-carousel .splide__pagination__page.is-active{background:#fff;transform:scale(1.4);z-index:1}.wp-block-splide-carousel .splide__pagination__page:hover{cursor:pointer;opacity:.9}.wp-block-splide-carousel .splide__pagination__page:focus-visible{outline:3px solid #0bf;outline-offset:3px}.wp-block-splide-carousel.is-focus-in .splide__pagination__page:focus{outline:3px solid #0bf;outline-offset:3px}.wp-block-splide-carousel .splide__progress__bar{background:#ccc;height:3px}.wp-block-splide-carousel .splide__slide{-webkit-tap-highlight-color:rgba(0,0,0,0)}.wp-block-splide-carousel .splide__slide:focus{outline:0}@supports(outline-offset:-3px){.wp-block-splide-carousel .splide__slide:focus-visible{outline:3px solid #0bf;outline-offset:-3px}}@media screen and (-ms-high-contrast:none){.wp-block-splide-carousel .splide__slide:focus-visible{border:3px solid #0bf}}@supports(outline-offset:-3px){.wp-block-splide-carousel.is-focus-in .splide__slide:focus{outline:3px solid #0bf;outline-offset:-3px}}@media screen and (-ms-high-contrast:none){.wp-block-splide-carousel.is-focus-in .splide__slide:focus{border:3px solid #0bf}.wp-block-splide-carousel.is-focus-in .splide__track>.splide__list>.splide__slide:focus{border-color:#0bf}}.wp-block-splide-carousel .splide__toggle{cursor:pointer}.wp-block-splide-carousel .splide__toggle:focus-visible{outline:3px solid #0bf;outline-offset:3px}.wp-block-splide-carousel.is-focus-in .splide__toggle:focus{outline:3px solid #0bf;outline-offset:3px}.wp-block-splide-carousel .splide__track--nav>.splide__list>.splide__slide{border:3px solid transparent;cursor:pointer}.wp-block-splide-carousel .splide__track--nav>.splide__list>.splide__slide.is-active{border:3px solid #000}.wp-block-splide-carousel .splide__arrows--rtl .splide__arrow--prev{left:auto;right:1em}.wp-block-splide-carousel .splide__arrows--rtl .splide__arrow--prev svg{transform:scaleX(1)}.wp-block-splide-carousel .splide__arrows--rtl .splide__arrow--next{left:1em;right:auto}.wp-block-splide-carousel .splide__arrows--rtl .splide__arrow--next svg{transform:scaleX(-1)}.wp-block-splide-carousel .splide__arrows--ttb .splide__arrow{left:50%;transform:translate(-50%)}.wp-block-splide-carousel .splide__arrows--ttb .splide__arrow--prev{top:1em}.wp-block-splide-carousel .splide__arrows--ttb .splide__arrow--prev svg{transform:rotate(-90deg)}.wp-block-splide-carousel .splide__arrows--ttb .splide__arrow--next{bottom:1em;top:auto}.wp-block-splide-carousel .splide__arrows--ttb .splide__arrow--next svg{transform:rotate(90deg)}.wp-block-splide-carousel .splide__pagination--ttb{bottom:0;display:flex;flex-direction:column;left:auto;padding:1em 0;right:.5em;top:0}.wp-block-splide-carousel .splide.splide--ttb{padding-bottom:64px;padding-top:64px}.wp-block-splide-carousel .splide__arrows .splide__arrow{height:36px;transition:all .2s linear;width:36px}@media screen and (min-width:782px){.wp-block-splide-carousel .splide__arrows--ltr .splide__arrow--prev{left:calc(-2em - 30px)}.wp-block-splide-carousel .splide__arrows--ltr .splide__arrow--next{right:calc(-2em - 30px)}.wp-block-splide-carousel .splide__arrows--rtl .splide__arrow--prev{left:auto;right:calc(-2em - 30px)}.wp-block-splide-carousel .splide__arrows--rtl .splide__arrow--next{left:calc(-2em - 30px);right:auto}}.wp-block-splide-carousel .splide__arrows--ttb .splide__arrow--prev{top:14px}.wp-block-splide-carousel .splide__arrows--ttb .splide__arrow--next{bottom:14px}.wp-block-splide-carousel .splide__slide{display:flex;flex-direction:column;overflow:hidden}.wp-block-splide-carousel .splide__slide .wp-block-cover:last-child,.wp-block-splide-carousel .splide__slide .wp-block-image:last-child{margin-bottom:0}.wp-block-splide-carousel .splide__slide .wp-block-cover:first-child,.wp-block-splide-carousel .splide__slide .wp-block-image:first-child{margin-top:0}.wp-block-splide-carousel .splide__slide.is-vertically-aligned-center{justify-content:center}.wp-block-splide-carousel .splide__slide.is-vertically-aligned-top{justify-content:flex-start}.wp-block-splide-carousel .splide__slide.is-vertically-aligned-bottom{justify-content:flex-end}.wp-block-splide-carousel .splide__slide-link{bottom:0;left:0;position:absolute;right:0;top:0}.wp-block-splide-carousel .splide__slide-link+.wp-block-image:nth-child(2){margin-top:0}.wp-block-splide-carousel .splide--cover .splide__slide>*,.wp-block-splide-carousel .splide--cover .splide__slide>*>*>.components-placeholder,.wp-block-splide-carousel .splide--cover .splide__slide>*>.wp-block-cover,.wp-block-splide-carousel .splide--cover .splide__slide>*>.wp-block-image,.wp-block-splide-carousel .splide--cover .splide__slide>*>.wp-block-image>div{height:100%}.wp-block-splide-carousel .splide--cover .splide__slide embed,.wp-block-splide-carousel .splide--cover .splide__slide iframe,.wp-block-splide-carousel .splide--cover .splide__slide img,.wp-block-splide-carousel .splide--cover .splide__slide video{height:100%;-o-object-fit:cover;object-fit:cover;-o-object-position:center;object-position:center;width:100%}.wp-block-splide-carousel .splide__pagination{bottom:-24px}.wp-block-splide-carousel .splide__pagination__page{display:block}.wp-block-splide-carousel .splide__pagination__page.is-active{background:#888;transform:scale(1.2)}.wp-block-splide-carousel .splide__controls{align-items:center;display:flex;justify-content:center;margin-top:1rem}.wp-block-splide-carousel .splide__controls .splide__pagination{bottom:auto;left:auto;padding:0;position:relative;transform:none;width:auto}.wp-block-splide-carousel .splide__toggle{align-items:center;background:#ccc;border:none;border-radius:50%;box-shadow:none;display:inline-flex;height:36px;justify-content:center;margin-right:1em;opacity:.7;transition:all .2s linear;width:36px}.wp-block-splide-carousel .splide__toggle svg{fill:#000;height:14px;transition:fill .2s ease;width:14px}.wp-block-splide-carousel .splide__toggle:hover{opacity:.9}.wp-block-splide-carousel .splide__toggle__play{margin-left:2px}.wp-block-splide-carousel .splide__toggle.is-active .wp-block-splide-carousel .splide__toggle__pause{display:inline}

</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='ssb-front-css-css' href='https://machinelearningmastery.com/wp-content/plugins/simple-social-buttons/assets/css/front.css?ver=6.1.0' type='text/css' media='all' />
<link rel='stylesheet' id='crp-style-grid-css' href='https://machinelearningmastery.com/wp-content/plugins/contextual-related-posts/css/grid.min.css?ver=4.0.1' type='text/css' media='all' />
<style id='crp-style-grid-inline-css' type='text/css'>

			.crp_related.crp-grid ul li a.crp_link {
				grid-template-rows: 200px auto;
			}
			.crp_related.crp-grid ul {
				grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
			}
			
</style>
<style id='crp-custom-style-inline-css' type='text/css'>
.crp_title {
    font-size: medium;
}
.group.portfolio-img img {
    height: auto;
    padding: 3px;
	  border: 0px solid #fff;
    background: rgba(255,255,255,.7);
}
.crp_related ul li {
    background: #fff;
    padding: 3px;
    margin: 0 0 1em;
    width: 100%;
    box-sizing: border-box;
    -moz-box-sizing: border-box;
    -webkit-box-sizing: border-box;
    box-shadow: 0 0px 0px 0 rgb(0 0 0 / 18%);
    border-radius: 3px;
    -moz-border-radius: 3px;
    -webkit-border-radius: 3px;
    border: 0px solid #fff;
    animation: wzslideup .8s ease-out,wzfadein 1s ease-out;
    -webkit-animation: wzslideup .8s ease-out,wzfadein 1s ease-out;
    -moz-animation: wzslideup .8s ease-out,wzfadein 1s ease;
    font-size: 1em;
    text-align: center;
    display: inline-block;
}

.crp_related.crp-grid ul li a.crp_link {
	gap: 20px;
}


.crp_related.crp-grid ul li img {
	width: 100%;
	height: 200px;
	object-fit: cover;
}
</style>
<link rel='stylesheet' id='megamenu-css' href='https://machinelearningmastery.com/wp-content/uploads/maxmegamenu/style.css?ver=ac06aa' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css' href='https://machinelearningmastery.com/wp-includes/css/dashicons.min.css?ver=6.8' type='text/css' media='all' />
<link rel='stylesheet' id='megamenu-genericons-css' href='https://machinelearningmastery.com/wp-content/plugins/megamenu-pro/icons/genericons/genericons/genericons.css?ver=2.4' type='text/css' media='all' />
<link rel='stylesheet' id='megamenu-fontawesome6-css' href='https://machinelearningmastery.com/wp-content/plugins/megamenu-pro/icons/fontawesome6/css/all.min.css?ver=2.4' type='text/css' media='all' />
<link rel='stylesheet' id='woo-testimonials-css-css' href='https://machinelearningmastery.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=6.8' type='text/css' media='all' />
<style id='akismet-widget-style-inline-css' type='text/css'>

			.a-stats {
				--akismet-color-mid-green: #357b49;
				--akismet-color-white: #fff;
				--akismet-color-light-grey: #f6f7f7;

				max-width: 350px;
				width: auto;
			}

			.a-stats * {
				all: unset;
				box-sizing: border-box;
			}

			.a-stats strong {
				font-weight: 600;
			}

			.a-stats a.a-stats__link,
			.a-stats a.a-stats__link:visited,
			.a-stats a.a-stats__link:active {
				background: var(--akismet-color-mid-green);
				border: none;
				box-shadow: none;
				border-radius: 8px;
				color: var(--akismet-color-white);
				cursor: pointer;
				display: block;
				font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen-Sans', 'Ubuntu', 'Cantarell', 'Helvetica Neue', sans-serif;
				font-weight: 500;
				padding: 12px;
				text-align: center;
				text-decoration: none;
				transition: all 0.2s ease;
			}

			/* Extra specificity to deal with TwentyTwentyOne focus style */
			.widget .a-stats a.a-stats__link:focus {
				background: var(--akismet-color-mid-green);
				color: var(--akismet-color-white);
				text-decoration: none;
			}

			.a-stats a.a-stats__link:hover {
				filter: brightness(110%);
				box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06), 0 0 2px rgba(0, 0, 0, 0.16);
			}

			.a-stats .count {
				color: var(--akismet-color-white);
				display: block;
				font-size: 1.5em;
				line-height: 1.4;
				padding: 0 13px;
				white-space: nowrap;
			}
		
</style>
<link rel='stylesheet' id='theme-stylesheet-css' href='https://machinelearningmastery.com/wp-content/themes/canvas-new/style.css?ver=5.9.21' type='text/css' media='all' />
<style id='kadence-blocks-global-variables-inline-css' type='text/css'>
:root {--global-kb-font-size-sm:clamp(0.8rem, 0.73rem + 0.217vw, 0.9rem);--global-kb-font-size-md:clamp(1.1rem, 0.995rem + 0.326vw, 1.25rem);--global-kb-font-size-lg:clamp(1.75rem, 1.576rem + 0.543vw, 2rem);--global-kb-font-size-xl:clamp(2.25rem, 1.728rem + 1.63vw, 3rem);--global-kb-font-size-xxl:clamp(2.5rem, 1.456rem + 3.26vw, 4rem);--global-kb-font-size-xxxl:clamp(2.75rem, 0.489rem + 7.065vw, 6rem);}:root {--global-palette1: #3182CE;--global-palette2: #2B6CB0;--global-palette3: #1A202C;--global-palette4: #2D3748;--global-palette5: #4A5568;--global-palette6: #718096;--global-palette7: #EDF2F7;--global-palette8: #F7FAFC;--global-palette9: #ffffff;}
</style>
<!--[if lt IE 9]>
<link href="https://machinelearningmastery.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 1280px; max-width: 1280px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 1280px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script type="text/javascript" src="https://machinelearningmastery.com/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="https://machinelearningmastery.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script type="text/javascript" id="urvanov_syntax_highlighter_js-js-extra">
/* <![CDATA[ */
var UrvanovSyntaxHighlighterSyntaxSettings = {"version":"2.8.38","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"urvanov-syntax-highlighter-","setting":"urvanov-syntax-highlighter-setting","selected":"urvanov-syntax-highlighter-setting-selected","changed":"urvanov-syntax-highlighter-setting-changed","special":"urvanov-syntax-highlighter-setting-special","orig_value":"data-orig-value","debug":""};
var UrvanovSyntaxHighlighterSyntaxStrings = {"copy":"Copied to the clipboard","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/js/min/urvanov_syntax_highlighter.min.js?ver=2.8.38" id="urvanov_syntax_highlighter_js-js"></script>
<script type="text/javascript" src="https://machinelearningmastery.com/wp-content/plugins/google-analytics-premium/assets/js/frontend-gtag.min.js?ver=9.4.1" id="monsterinsights-frontend-script-js" async="async" data-wp-strategy="async"></script>
<script data-cfasync="false" data-wpfc-render="false" type="text/javascript" id='monsterinsights-frontend-script-js-extra'>/* <![CDATA[ */
var monsterinsights_frontend = {"js_events_tracking":"true","download_extensions":"doc,pdf,ppt,zip,xls,docx,pptx,xlsx","inbound_paths":"[]","home_url":"https:\/\/machinelearningmastery.com","hash_tracking":"false","v4_id":"G-JZP3DWZZ8W"};/* ]]> */
</script>
<script type="text/javascript" id="advanced-ads-advanced-js-js-extra">
/* <![CDATA[ */
var advads_options = {"blog_id":"1","privacy":{"enabled":false,"state":"not_needed"}};
/* ]]> */
</script>
<script type="text/javascript" src="https://machinelearningmastery.com/wp-content/uploads/966/590/public/assets/js/898.js?ver=2.0.5" id="advanced-ads-advanced-js-js"></script>
<script type="text/javascript" id="advanced_ads_pro/visitor_conditions-js-extra">
/* <![CDATA[ */
var advanced_ads_pro_visitor_conditions = {"referrer_cookie_name":"advanced_ads_pro_visitor_referrer","referrer_exdays":"365","page_impr_cookie_name":"advanced_ads_page_impressions","page_impr_exdays":"3650"};
/* ]]> */
</script>
<script type="text/javascript" src="https://machinelearningmastery.com/wp-content/uploads/966/902/88/649/701/563.js?ver=3.0.3" id="advanced_ads_pro/visitor_conditions-js"></script>
<script type="text/javascript" src="https://machinelearningmastery.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=6.8" id="third-party-js"></script>
<script type="text/javascript" src="https://machinelearningmastery.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" id="modernizr-js"></script>
<script type="text/javascript" src="https://machinelearningmastery.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=6.8" id="general-js"></script>

<!-- Adjust the website width -->
<style type="text/css">
	.col-full, #wrapper { max-width: 1280px !important; }
</style>

<link rel="https://api.w.org/" href="https://machinelearningmastery.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://machinelearningmastery.com/wp-json/wp/v2/posts/7553" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://machinelearningmastery.com/xmlrpc.php?rsd" />

<link rel='shortlink' href='https://machinelearningmastery.com/?p=7553' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fhow-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fhow-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification%2F&#038;format=xml" />
 <style media="screen">

		.simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like, .simplesocialbuttons.simplesocialbuttons_inline amp-facebook-like {
	  margin: ;
	}
		 /*inline margin*/
	
	
	
	
	
	
			 .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
		 margin: ;
	 }

			 /*margin-digbar*/

	
	
	
	
	
	
	
</style>

<!-- Open Graph Meta Tags generated by Simple Social Buttons 6.1.0 -->
<meta property="og:title" content="How to Develop a CNN for MNIST Handwritten Digit Classification - MachineLearningMastery.com" />
<meta property="og:description" content="How to Develop a Convolutional Neural Network From Scratch for MNIST Handwritten Digit Classification. The MNIST handwritten digit classification problem is a standard dataset used in computer vision and deep learning. Although the dataset is effectively solved, it can be used as the basis for learning and practicing how to develop, evaluate, and use convolutional deep learning neural networks for&hellip;" />
<meta property="og:url" content="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/" />
<meta property="og:site_name" content="MachineLearningMastery.com" />
<meta property="og:image" content="https://machinelearningmastery.com/wp-content/uploads/2019/02/Plot-of-a-Subset-of-Images-from-the-MNIST-Dataset.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="How to Develop a Convolutional Neural Network From Scratch for MNIST Handwritten Digit Classification. The MNIST handwritten digit classification problem is a standard dataset used in computer vision and deep learning. Although the dataset is effectively solved, it can be used as the basis for learning and practicing how to develop, evaluate, and use convolutional deep learning neural networks for&hellip;" />
<meta name="twitter:title" content="How to Develop a CNN for MNIST Handwritten Digit Classification - MachineLearningMastery.com" />
<meta property="twitter:image" content="https://machinelearningmastery.com/wp-content/uploads/2019/02/Plot-of-a-Subset-of-Images-from-the-MNIST-Dataset.png" />
    
    <script type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>
<script type="text/javascript">
		var advadsCfpQueue = [];
		var advadsCfpAd = function( adID ){
			if ( 'undefined' == typeof advadsProCfp ) { advadsCfpQueue.push( adID ) } else { advadsProCfp.addElement( adID ) }
		};
		</script>
		
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
#nav-container{background:#84abc7;}#nav-container{border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:none;border-right:none;}#nav-container #navigation ul#main-nav > li:first-child{border-left: 0px solid #dbdbdb;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 15px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#ffffff; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#ffffff;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#eeeeee!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#84abc7!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#84abc7;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>

<!-- Custom Favicon -->
<link rel="shortcut icon" href="https://machinelearningmastery.com/wp-content/uploads/2019/09/icon-16x16.png"/>
<!-- Options Panel Custom CSS -->
<style type="text/css">
#logo img {
   max-width: 100%;
   height: auto;
}
</style>


<!-- Woo Shortcodes CSS -->
<link href="https://machinelearningmastery.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css" />

<!-- Custom Stylesheet -->
<link href="https://machinelearningmastery.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css" />

<!-- Theme version -->
<meta name="generator" content="Canvas 5.9.21" />
<meta name="generator" content="WooFramework 6.2.9" />
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TS7H3T8L');</script>
<!-- End Google Tag Manager -->		<script type="text/javascript">
			if ( typeof advadsGATracking === 'undefined' ) {
				window.advadsGATracking = {
					delayedAds: {},
					deferedAds: {}
				};
			}
		</script>
		<link rel="icon" href="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" sizes="32x32" />
<link rel="icon" href="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" />
<meta name="msapplication-TileImage" content="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" />
<script data-no-optimize='1' data-cfasync='false' id='cls-disable-ads-9c650da'>var cls_disable_ads=function(t){"use strict";window.adthriveCLS.buildDate="2025-04-16";const e="Content",i="Recipe";const s=new class{info(t,e,...i){this.call(console.info,t,e,...i)}warn(t,e,...i){this.call(console.warn,t,e,...i)}error(t,e,...i){this.call(console.error,t,e,...i),this.sendErrorLogToCommandQueue(t,e,...i)}event(t,e,...i){var s;"debug"===(null==(s=window.adthriveCLS)?void 0:s.bucket)&&this.info(t,e)}sendErrorLogToCommandQueue(t,e,...i){window.adthrive=window.adthrive||{},window.adthrive.cmd=window.adthrive.cmd||[],window.adthrive.cmd.push((()=>{void 0!==window.adthrive.logError&&"function"==typeof window.adthrive.logError&&window.adthrive.logError(t,e,i)}))}call(t,e,i,...s){const o=[`%c${e}::${i} `],a=["color: #999; font-weight: bold;"];s.length>0&&"string"==typeof s[0]&&o.push(s.shift()),a.push(...s);try{Function.prototype.apply.call(t,console,[o.join(""),...a])}catch(t){return void console.error(t)}}},o=t=>{const e=window.location.href;return t.some((t=>new RegExp(t,"i").test(e)))};class a{checkCommandQueue(){this.adthrive&&this.adthrive.cmd&&this.adthrive.cmd.forEach((t=>{const e=t.toString(),i=this.extractAPICall(e,"disableAds");i&&this.disableAllAds(this.extractPatterns(i));const s=this.extractAPICall(e,"disableContentAds");s&&this.disableContentAds(this.extractPatterns(s));const o=this.extractAPICall(e,"disablePlaylistPlayers");o&&this.disablePlaylistPlayers(this.extractPatterns(o))}))}extractPatterns(t){const e=t.match(/["'](.*?)['"]/g);if(null!==e)return e.map((t=>t.replace(/["']/g,"")))}extractAPICall(t,e){const i=new RegExp(e+"\\((.*?)\\)","g"),s=t.match(i);return null!==s&&s[0]}disableAllAds(t){t&&!o(t)||(this.all=!0,this.reasons.add("all_page"))}disableContentAds(t){t&&!o(t)||(this.content=!0,this.recipe=!0,this.locations.add(e),this.locations.add(i),this.reasons.add("content_plugin"))}disablePlaylistPlayers(t){t&&!o(t)||(this.video=!0,this.locations.add("Video"),this.reasons.add("video_page"))}urlHasEmail(t){if(!t)return!1;return null!==/([A-Z0-9._%+-]+(@|%(25)*40)[A-Z0-9.-]+\.[A-Z]{2,})/i.exec(t)}constructor(t){this.adthrive=t,this.all=!1,this.content=!1,this.recipe=!1,this.video=!1,this.locations=new Set,this.reasons=new Set,(this.urlHasEmail(window.location.href)||this.urlHasEmail(window.document.referrer))&&(this.all=!0,this.reasons.add("all_email"));try{this.checkCommandQueue(),null!==document.querySelector(".tag-novideo")&&(this.video=!0,this.locations.add("Video"),this.reasons.add("video_tag"))}catch(t){s.error("ClsDisableAds","checkCommandQueue",t)}}}const n=window.adthriveCLS;return n&&(n.disableAds=new a(window.adthrive)),t.ClsDisableAds=a,t}({});
</script>		<style type="text/css" id="wp-custom-css">
			.display-posts-listing.image-left .listing-item {
	overflow: hidden; 
	margin-bottom: 30px;
	width: 100%;
}

.display-posts-listing.image-left .image {
	float: left;
	margin: 0 10px 0 0;
}

.display-posts-listing.image-left .attachment-thumbnail {
	height: auto; 
	width: auto; 
	max-width: 50px; 
	max-height: 50px;
	border-radius: 50%;
}

.display-posts-listing.image-left .title {
	display: block;
}

.display-posts-listing.image-left .excerpt-dash { 
	display: none; 
}

.display-posts-listing.image-left {
	margin: 0 0 40px 0;
}
.entry, .entry p {
    padding-left: 10px;
}		</style>
		<style type="text/css">/** Mega Menu CSS: fs **/</style>

	
	
</head>
<body class="wp-singular post-template-default single single-post postid-7553 single-format-standard wp-custom-logo wp-theme-canvas-new mega-menu-primary-menu gecko alt-style-default two-col-left width-1280 two-col-left-1280 full-width full-header aa-prefix-machi-">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TS7H3T8L"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) --><div id="wrapper">

	<div id="inner-wrapper">

	    <!--#header-container-->
    <div id="header-container">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>

	<!-- <header id="header" class="col-full site-header"> -->
	<header id="header" class="site-header">

				<link rel='stylesheet' id='kadence-blocks-column-css' href='https://machinelearningmastery.com/wp-content/plugins/kadence-blocks/dist/style-blocks-column.css?ver=3.5.3' type='text/css' media='all' />
<link rel='stylesheet' id='kadence-blocks-rowlayout-css' href='https://machinelearningmastery.com/wp-content/plugins/kadence-blocks/dist/style-blocks-rowlayout.css?ver=3.5.3' type='text/css' media='all' />
<style>.kb-row-layout-id15526_74c6ad-ec > .kt-row-column-wrap{align-content:center;}:where(.kb-row-layout-id15526_74c6ad-ec > .kt-row-column-wrap) > .wp-block-kadence-column{justify-content:center;}.kb-row-layout-id15526_74c6ad-ec > .kt-row-column-wrap{column-gap:var(--global-kb-gap-md, 2rem);row-gap:var(--global-kb-gap-none, 0rem );max-width:1280px;margin-left:auto;margin-right:auto;grid-template-columns:minmax(0, 1fr);}.kb-row-layout-id15526_74c6ad-ec > .kt-row-layout-overlay{opacity:0.30;}@media all and (max-width: 1024px){.kb-row-layout-id15526_74c6ad-ec > .kt-row-column-wrap{grid-template-columns:minmax(0, 1fr);}}@media all and (max-width: 767px){.kb-row-layout-id15526_74c6ad-ec > .kt-row-column-wrap{grid-template-columns:minmax(0, 1fr);}}</style><div class="kb-row-layout-wrap kb-row-layout-id15526_74c6ad-ec alignfull mobile-header wp-block-kadence-rowlayout"><div class="kt-row-column-wrap kt-has-1-columns kt-row-layout-equal kt-tab-layout-inherit kt-mobile-layout-row kt-row-valign-middle kt-inner-column-height-full">
<style>.kadence-column15526_f3dcd2-ae > .kt-inside-inner-col{display:flex;}.kadence-column15526_f3dcd2-ae > .kt-inside-inner-col,.kadence-column15526_f3dcd2-ae > .kt-inside-inner-col:before{border-top-left-radius:0px;border-top-right-radius:0px;border-bottom-right-radius:0px;border-bottom-left-radius:0px;}.kadence-column15526_f3dcd2-ae > .kt-inside-inner-col{row-gap:var(--global-kb-gap-none, 0rem );column-gap:var(--global-kb-gap-none, 0rem );}.kadence-column15526_f3dcd2-ae > .kt-inside-inner-col{flex-direction:row;flex-wrap:wrap;align-items:flex-start;flex-wrap:nowrap;}.kadence-column15526_f3dcd2-ae > .kt-inside-inner-col > *, .kadence-column15526_f3dcd2-ae > .kt-inside-inner-col > figure.wp-block-image, .kadence-column15526_f3dcd2-ae > .kt-inside-inner-col > figure.wp-block-kadence-image{margin-top:0px;margin-bottom:0px;}.kadence-column15526_f3dcd2-ae > .kt-inside-inner-col > .kb-image-is-ratio-size{flex-grow:1;}.kt-row-column-wrap > .kadence-column15526_f3dcd2-ae{align-self:flex-start;}.kt-inner-column-height-full:not(.kt-has-1-columns) > .wp-block-kadence-column.kadence-column15526_f3dcd2-ae{align-self:auto;}.kt-inner-column-height-full:not(.kt-has-1-columns) > .wp-block-kadence-column.kadence-column15526_f3dcd2-ae > .kt-inside-inner-col{align-items:flex-start;}.kadence-column15526_f3dcd2-ae > .kt-inside-inner-col:before{opacity:0.3;}.kadence-column15526_f3dcd2-ae{position:relative;}@media all and (max-width: 1024px){.kt-row-column-wrap > .kadence-column15526_f3dcd2-ae{align-self:flex-start;}}@media all and (max-width: 1024px){.kt-inner-column-height-full:not(.kt-has-1-columns) > .wp-block-kadence-column.kadence-column15526_f3dcd2-ae{align-self:auto;}}@media all and (max-width: 1024px){.kt-inner-column-height-full:not(.kt-has-1-columns) > .wp-block-kadence-column.kadence-column15526_f3dcd2-ae > .kt-inside-inner-col{align-items:flex-start;}}@media all and (max-width: 1024px){.kadence-column15526_f3dcd2-ae > .kt-inside-inner-col{flex-direction:row;flex-wrap:wrap;align-items:flex-start;flex-wrap:nowrap;}}@media all and (min-width: 768px) and (max-width: 1024px){.kadence-column15526_f3dcd2-ae > .kt-inside-inner-col > *, .kadence-column15526_f3dcd2-ae > .kt-inside-inner-col > figure.wp-block-image, .kadence-column15526_f3dcd2-ae > .kt-inside-inner-col > figure.wp-block-kadence-image{margin-top:0px;margin-bottom:0px;}.kadence-column15526_f3dcd2-ae > .kt-inside-inner-col > .kb-image-is-ratio-size{flex-grow:1;}}@media all and (max-width: 767px){.kt-row-column-wrap > .kadence-column15526_f3dcd2-ae{align-self:flex-start;}.kt-inner-column-height-full:not(.kt-has-1-columns) > .wp-block-kadence-column.kadence-column15526_f3dcd2-ae{align-self:auto;}.kt-inner-column-height-full:not(.kt-has-1-columns) > .wp-block-kadence-column.kadence-column15526_f3dcd2-ae > .kt-inside-inner-col{align-items:flex-start;}.kadence-column15526_f3dcd2-ae > .kt-inside-inner-col{flex-direction:row;flex-wrap:wrap;flex-wrap:nowrap;}.kadence-column15526_f3dcd2-ae > .kt-inside-inner-col > *, .kadence-column15526_f3dcd2-ae > .kt-inside-inner-col > figure.wp-block-image, .kadence-column15526_f3dcd2-ae > .kt-inside-inner-col > figure.wp-block-kadence-image{margin-top:0px;margin-bottom:0px;}.kadence-column15526_f3dcd2-ae > .kt-inside-inner-col > .kb-image-is-ratio-size{flex-grow:1;}}</style>
<div class="wp-block-kadence-column kadence-column15526_f3dcd2-ae kb-section-dir-horizontal kb-section-md-dir-horizontal kb-section-sm-dir-horizontal inner-column-1"><div class="kt-inside-inner-col"><div class="is-style-default hide-mobile hide-tablet wp-block-site-logo"><a href="https://machinelearningmastery.com/" class="custom-logo-link" rel="home"><img width="260" height="129" src="https://machinelearningmastery.com/wp-content/uploads/2024/10/mlm-logo.svg" class="custom-logo" alt="MachineLearningMastery.com" decoding="async" /></a></div>

<p class="hide-desktop hide-tablet hide-mobile wp-block-site-tagline">Making developers awesome at machine learning</p>

<style>.kadence-column15526_ce6b2a-21 > .kt-inside-inner-col,.kadence-column15526_ce6b2a-21 > .kt-inside-inner-col:before{border-top-left-radius:0px;border-top-right-radius:0px;border-bottom-right-radius:0px;border-bottom-left-radius:0px;}.kadence-column15526_ce6b2a-21 > .kt-inside-inner-col{column-gap:var(--global-kb-gap-sm, 1rem);}.kadence-column15526_ce6b2a-21 > .kt-inside-inner-col{flex-direction:column;}.kadence-column15526_ce6b2a-21 > .kt-inside-inner-col > .aligncenter{width:100%;}.kadence-column15526_ce6b2a-21 > .kt-inside-inner-col:before{opacity:0.3;}.kadence-column15526_ce6b2a-21{position:relative;}@media all and (max-width: 1024px){.kadence-column15526_ce6b2a-21 > .kt-inside-inner-col{flex-direction:column;}}@media all and (max-width: 767px){.kadence-column15526_ce6b2a-21 > .kt-inside-inner-col{flex-direction:column;}}</style>
<div class="wp-block-kadence-column kadence-column15526_ce6b2a-21 hide-desktop hide-tablet"><div class="kt-inside-inner-col"><nav id="mega-menu-wrap-primary-menu" class="mega-menu-wrap"><div class="mega-menu-toggle"><div class="mega-toggle-blocks-left"><div class='mega-toggle-block mega-logo-block mega-toggle-block-1' id='mega-toggle-block-1'><a class="mega-menu-logo" href="https://machinelearningmastery.com/" target="_self"><img class="mega-menu-logo" src="https://machinelearningmastery.com/wp-content/uploads/2024/10/mlm-logo.svg" /></a></div><div class='mega-toggle-block mega-html-block mega-toggle-block-2' id='mega-toggle-block-2'><p class="wp-block-site-tagline">Making Developers Awesome at Machine Learning</p></div></div><div class="mega-toggle-blocks-center"></div><div class="mega-toggle-blocks-right"><div class='mega-toggle-block mega-html-block mega-toggle-block-3' id='mega-toggle-block-3'><div class="mobile-cta-btn">
<div id="custom_html-33" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><div style="text-align: right;">
	<script src="https://embed.lpcontent.net/leadboxes/current/embed.js" async defer></script> <a href="" data-leadbox-popup="ENjQkSg3mXWBSzxzvb3R9e" data-leadbox-domain="machinelearningmastery.lpages.co">Click to Take the FREE Computer Vision Crash-Course</a> 
</div></div></div>
</div></div><div class='mega-toggle-block mega-menu-toggle-animated-block mega-toggle-block-4' id='mega-toggle-block-4'><button aria-label="Toggle Menu" class="mega-toggle-animated mega-toggle-animated-slider" type="button" aria-expanded="false">
                  <span class="mega-toggle-animated-box">
                    <span class="mega-toggle-animated-inner"></span>
                  </span>
                </button></div></div></div><ul id="mega-menu-primary-menu" class="mega-menu max-mega-menu mega-menu-horizontal mega-no-js" data-event="hover_intent" data-effect="fade_up" data-effect-speed="200" data-effect-mobile="slide" data-effect-speed-mobile="200" data-panel-width=".site-header .kt-row-column-wrap" data-mobile-force-width="body" data-second-click="go" data-document-click="collapse" data-vertical-behaviour="standard" data-breakpoint="1186" data-unbind="true" data-mobile-state="collapse_all" data-mobile-direction="vertical" data-hover-intent-timeout="300" data-hover-intent-interval="100" data-overlay-desktop="false" data-overlay-mobile="false"><li class="mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-align-bottom-left mega-menu-flyout mega-menu-item-6503" id="mega-menu-item-6503"><a class="mega-menu-link" href="https://machinelearningmastery.com/start-here/" tabindex="0">Get Started</a></li><li class="mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-current_page_parent mega-align-bottom-left mega-menu-flyout mega-menu-item-6501" id="mega-menu-item-6501"><a class="mega-menu-link" href="https://machinelearningmastery.com/blog/" tabindex="0">Blog</a></li><li class="mega-menu-item mega-menu-item-type-custom mega-menu-item-object-custom mega-menu-item-has-children mega-menu-megamenu mega-align-bottom-left mega-menu-megamenu mega-menu-item-6506" id="mega-menu-item-6506"><a class="mega-menu-link" href="#" aria-expanded="false" tabindex="0">Topics<span class="mega-indicator" aria-hidden="true"></span></a>
<ul class="mega-sub-menu">
<li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-14062" style="--columns:3; --span:1" id="mega-menu-item-14062"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/attention/">Attention</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-7106" style="--columns:3; --span:1" id="mega-menu-item-7106"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/better-deep-learning/">Better Deep Learning</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-13302" style="--columns:3; --span:1" id="mega-menu-item-13302"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/calculus/">Calculus</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-clear mega-menu-item-15216" style="--columns:3; --span:1" id="mega-menu-item-15216"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/chatgpt/">ChatGPT</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-has-description mega-menu-item-6507" style="--columns:3; --span:1" id="mega-menu-item-6507"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/algorithms-from-scratch/"><span class="mega-description-group"><span class="mega-menu-title">Code Algorithms</span><span class="mega-menu-description">Implementing machine learning algorithms from scratch.</span></span></a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-current-post-ancestor mega-current-menu-parent mega-current-post-parent mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-7921" style="--columns:3; --span:1" id="mega-menu-item-7921"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/deep-learning-for-computer-vision/">Computer Vision</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-clear mega-menu-item-10674" style="--columns:3; --span:1" id="mega-menu-item-10674"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/data-preparation/">Data Preparation</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-has-description mega-menu-item-6508" style="--columns:3; --span:1" id="mega-menu-item-6508"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/deep-learning/"><span class="mega-description-group"><span class="mega-menu-title">Deep Learning (keras)</span><span class="mega-menu-description">Deep Learning</span></span></a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-14782" style="--columns:3; --span:1" id="mega-menu-item-14782"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/deep-learning-with-pytorch/">Deep Learning with PyTorch</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-clear mega-menu-item-11055" style="--columns:3; --span:1" id="mega-menu-item-11055"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/ensemble-learning/">Ensemble Learning</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-18613" style="--columns:3; --span:1" id="mega-menu-item-18613"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/foundations-of-data-science/">Foundations of Data Science</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-8576" style="--columns:3; --span:1" id="mega-menu-item-8576"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/generative-adversarial-networks/">GANs</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-clear mega-has-description mega-menu-item-6509" style="--columns:3; --span:1" id="mega-menu-item-6509"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/deep-learning-time-series/"><span class="mega-description-group"><span class="mega-menu-title">Neural Net Time Series</span><span class="mega-menu-description">Deep Learning for Time Series Forecasting</span></span></a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-6515" style="--columns:3; --span:1" id="mega-menu-item-6515"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/natural-language-processing/">NLP (Text)</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-9966" style="--columns:3; --span:1" id="mega-menu-item-9966"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/imbalanced-classification/">Imbalanced Learning</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-clear mega-menu-item-18614" style="--columns:3; --span:1" id="mega-menu-item-18614"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/intermediate-data-science/">Intermediate Data Science</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-6520" style="--columns:3; --span:1" id="mega-menu-item-6520"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/time-series/">Intro to Time Series</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-6512" style="--columns:3; --span:1" id="mega-menu-item-6512"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Intro to Algorithms</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-clear mega-menu-item-6510" style="--columns:3; --span:1" id="mega-menu-item-6510"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-has-description mega-menu-item-6511" style="--columns:3; --span:1" id="mega-menu-item-6511"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/lstm/"><span class="mega-description-group"><span class="mega-menu-title">LSTMs</span><span class="mega-menu-description">Long Short-Term Memory Networks</span></span></a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-16040" style="--columns:3; --span:1" id="mega-menu-item-16040"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/opencv/">OpenCV</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-clear mega-menu-item-12825" style="--columns:3; --span:1" id="mega-menu-item-12825"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/optimization/">Optimization</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-8989" style="--columns:3; --span:1" id="mega-menu-item-8989"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/probability/">Probability</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-6516" style="--columns:3; --span:1" id="mega-menu-item-6516"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-clear mega-menu-item-13672" style="--columns:3; --span:1" id="mega-menu-item-13672"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/python-for-machine-learning/">Python for Machine Learning</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-6517" style="--columns:3; --span:1" id="mega-menu-item-6517"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-17914" style="--columns:3; --span:1" id="mega-menu-item-17914"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/stable-diffusion/">Stable Diffusion</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-clear mega-menu-item-6519" style="--columns:3; --span:1" id="mega-menu-item-6519"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/statistical-methods/">Statistics</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-6522" style="--columns:3; --span:1" id="mega-menu-item-6522"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-6523" style="--columns:3; --span:1" id="mega-menu-item-6523"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li></ul>
</li><li class="mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-align-bottom-left mega-menu-flyout mega-menu-item-6502" id="mega-menu-item-6502"><a class="mega-menu-link" href="https://machinelearningmastery.com/products/" tabindex="0">eBooks</a></li><li class="mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-align-bottom-left mega-menu-flyout mega-menu-item-6500" id="mega-menu-item-6500"><a class="mega-menu-link" href="https://machinelearningmastery.com/faq/" tabindex="0">FAQ</a></li><li class="mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-align-bottom-left mega-menu-flyout mega-menu-item-6504" id="mega-menu-item-6504"><a class="mega-menu-link" href="https://machinelearningmastery.com/about/" tabindex="0">About</a></li><li class="mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-align-bottom-left mega-menu-flyout mega-menu-item-6505" id="mega-menu-item-6505"><a class="mega-menu-link" href="https://machinelearningmastery.com/contact/" tabindex="0">Contact</a></li><li class="mega-menu-item mega-menu-item-type-custom mega-menu-item-object-custom mega-align-bottom-left mega-menu-flyout mega-menu-item-18434" id="mega-menu-item-18434"><div class='mega-search-wrap'>    <form class='mega-search expand-to-left mega-search-closed' role='search' action='https://machinelearningmastery.com/'><input  type='text' tabindex='-1' role='searchbox' id='mega-search-18434' aria-label='Search...' data-placeholder='Search...' name='s' autocomplete='off' /><span tabindex='0' role='button' class='dashicons dashicons-search search-icon' aria-controls='mega-search-18434' aria-label='Search' aria-expanded='false' aria-haspopup='true'></span><input type='submit' value='Search'>    </form></div></li></ul></nav></div></div>


<style>.kb-row-layout-id15526_68a92c-b2 > .kt-row-column-wrap{align-content:center;}:where(.kb-row-layout-id15526_68a92c-b2 > .kt-row-column-wrap) > .wp-block-kadence-column{justify-content:center;}.kb-row-layout-id15526_68a92c-b2 > .kt-row-column-wrap{column-gap:10px;row-gap:10px;padding-top:13px;grid-template-columns:minmax(0, 1fr);}.kb-row-layout-id15526_68a92c-b2 > .kt-row-layout-overlay{opacity:0.30;}@media all and (max-width: 1024px){.kb-row-layout-id15526_68a92c-b2 > .kt-row-column-wrap{padding-top:0px;grid-template-columns:minmax(0, 1fr);}}@media all and (max-width: 767px){.kb-row-layout-id15526_68a92c-b2 > .kt-row-column-wrap{grid-template-columns:minmax(0, 1fr);}}.kb-row-layout-id15526_68a92c-b2 {flex: 1;}</style><div class="kb-row-layout-wrap kb-row-layout-id15526_68a92c-b2 alignnone hide-mobile wp-block-kadence-rowlayout"><div class="kt-row-column-wrap kt-has-2-columns kt-row-layout-row kt-tab-layout-row kt-mobile-layout-row kt-row-valign-middle kt-inner-column-height-full">
<style>.kadence-column15526_1a4b11-90 > .kt-inside-inner-col{display:flex;}.kadence-column15526_1a4b11-90 > .kt-inside-inner-col,.kadence-column15526_1a4b11-90 > .kt-inside-inner-col:before{border-top-left-radius:0px;border-top-right-radius:0px;border-bottom-right-radius:0px;border-bottom-left-radius:0px;}.kadence-column15526_1a4b11-90 > .kt-inside-inner-col{row-gap:var(--global-kb-gap-none, 0rem );column-gap:var(--global-kb-gap-sm, 1rem);}.kadence-column15526_1a4b11-90 > .kt-inside-inner-col{flex-direction:row;flex-wrap:wrap;align-items:center;justify-content:space-between;}.kadence-column15526_1a4b11-90 > .kt-inside-inner-col > *, .kadence-column15526_1a4b11-90 > .kt-inside-inner-col > figure.wp-block-image, .kadence-column15526_1a4b11-90 > .kt-inside-inner-col > figure.wp-block-kadence-image{margin-top:0px;margin-bottom:0px;}.kadence-column15526_1a4b11-90 > .kt-inside-inner-col > .kb-image-is-ratio-size{flex-grow:1;}.kt-row-column-wrap > .kadence-column15526_1a4b11-90{align-self:center;}.kt-inner-column-height-full:not(.kt-has-1-columns) > .wp-block-kadence-column.kadence-column15526_1a4b11-90{align-self:auto;}.kt-inner-column-height-full:not(.kt-has-1-columns) > .wp-block-kadence-column.kadence-column15526_1a4b11-90 > .kt-inside-inner-col{align-items:center;}.kadence-column15526_1a4b11-90 > .kt-inside-inner-col:before{opacity:0.3;}.kadence-column15526_1a4b11-90{position:relative;}@media all and (max-width: 1024px){.kt-row-column-wrap > .kadence-column15526_1a4b11-90{align-self:center;}}@media all and (max-width: 1024px){.kt-inner-column-height-full:not(.kt-has-1-columns) > .wp-block-kadence-column.kadence-column15526_1a4b11-90{align-self:auto;}}@media all and (max-width: 1024px){.kt-inner-column-height-full:not(.kt-has-1-columns) > .wp-block-kadence-column.kadence-column15526_1a4b11-90 > .kt-inside-inner-col{align-items:center;}}@media all and (max-width: 1024px){.kadence-column15526_1a4b11-90 > .kt-inside-inner-col{flex-direction:row;flex-wrap:wrap;align-items:center;justify-content:space-between;}}@media all and (min-width: 768px) and (max-width: 1024px){.kadence-column15526_1a4b11-90 > .kt-inside-inner-col > *, .kadence-column15526_1a4b11-90 > .kt-inside-inner-col > figure.wp-block-image, .kadence-column15526_1a4b11-90 > .kt-inside-inner-col > figure.wp-block-kadence-image{margin-top:0px;margin-bottom:0px;}.kadence-column15526_1a4b11-90 > .kt-inside-inner-col > .kb-image-is-ratio-size{flex-grow:1;}}@media all and (max-width: 767px){.kt-row-column-wrap > .kadence-column15526_1a4b11-90{align-self:center;}.kt-inner-column-height-full:not(.kt-has-1-columns) > .wp-block-kadence-column.kadence-column15526_1a4b11-90{align-self:auto;}.kt-inner-column-height-full:not(.kt-has-1-columns) > .wp-block-kadence-column.kadence-column15526_1a4b11-90 > .kt-inside-inner-col{align-items:center;}.kadence-column15526_1a4b11-90 > .kt-inside-inner-col{flex-direction:row;flex-wrap:wrap;justify-content:space-between;}.kadence-column15526_1a4b11-90 > .kt-inside-inner-col > *, .kadence-column15526_1a4b11-90 > .kt-inside-inner-col > figure.wp-block-image, .kadence-column15526_1a4b11-90 > .kt-inside-inner-col > figure.wp-block-kadence-image{margin-top:0px;margin-bottom:0px;}.kadence-column15526_1a4b11-90 > .kt-inside-inner-col > .kb-image-is-ratio-size{flex-grow:1;}}</style>
<div class="wp-block-kadence-column kadence-column15526_1a4b11-90 kb-section-dir-horizontal hide-tablet"><div class="kt-inside-inner-col"><p class="wp-block-site-tagline">Making developers awesome at machine learning</p>

<div id="custom_html-33" class="widget_text widget widget_custom_html">
<div class="textwidget custom-html-widget">
<div style="text-align: right;">
	<script src="https://embed.lpcontent.net/leadboxes/current/embed.js" async defer></script> <a href="" data-leadbox-popup="ENjQkSg3mXWBSzxzvb3R9e" data-leadbox-domain="machinelearningmastery.lpages.co">Click to Take the FREE Computer Vision Crash-Course</a>
</div>
</div>
</div>
</div></div>


<style>.kadence-column15526_249179-e4 > .kt-inside-inner-col{padding-left:var(--global-kb-spacing-lg, 3rem);}.kadence-column15526_249179-e4 > .kt-inside-inner-col,.kadence-column15526_249179-e4 > .kt-inside-inner-col:before{border-top-left-radius:0px;border-top-right-radius:0px;border-bottom-right-radius:0px;border-bottom-left-radius:0px;}.kadence-column15526_249179-e4 > .kt-inside-inner-col{column-gap:var(--global-kb-gap-sm, 1rem);}.kadence-column15526_249179-e4 > .kt-inside-inner-col{flex-direction:column;}.kadence-column15526_249179-e4 > .kt-inside-inner-col > .aligncenter{width:100%;}.kadence-column15526_249179-e4 > .kt-inside-inner-col:before{opacity:0.3;}.kadence-column15526_249179-e4{position:relative;}@media all and (max-width: 1024px){.kadence-column15526_249179-e4 > .kt-inside-inner-col{padding-left:0px;flex-direction:column;}}@media all and (max-width: 767px){.kadence-column15526_249179-e4 > .kt-inside-inner-col{flex-direction:column;}}</style>
<div class="wp-block-kadence-column kadence-column15526_249179-e4"><div class="kt-inside-inner-col"><nav id="mega-menu-wrap-primary-menu" class="mega-menu-wrap"><div class="mega-menu-toggle"><div class="mega-toggle-blocks-left"><div class='mega-toggle-block mega-logo-block mega-toggle-block-1' id='mega-toggle-block-1'><a class="mega-menu-logo" href="https://machinelearningmastery.com/" target="_self"><img class="mega-menu-logo" src="https://machinelearningmastery.com/wp-content/uploads/2024/10/mlm-logo.svg" /></a></div><div class='mega-toggle-block mega-html-block mega-toggle-block-2' id='mega-toggle-block-2'><p class="wp-block-site-tagline">Making Developers Awesome at Machine Learning</p></div></div><div class="mega-toggle-blocks-center"></div><div class="mega-toggle-blocks-right"><div class='mega-toggle-block mega-html-block mega-toggle-block-3' id='mega-toggle-block-3'><div class="mobile-cta-btn">
<div id="custom_html-33" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><div style="text-align: right;">
	<script src="https://embed.lpcontent.net/leadboxes/current/embed.js" async defer></script> <a href="" data-leadbox-popup="ENjQkSg3mXWBSzxzvb3R9e" data-leadbox-domain="machinelearningmastery.lpages.co">Click to Take the FREE Computer Vision Crash-Course</a> 
</div></div></div>
</div></div><div class='mega-toggle-block mega-menu-toggle-animated-block mega-toggle-block-4' id='mega-toggle-block-4'><button aria-label="Toggle Menu" class="mega-toggle-animated mega-toggle-animated-slider" type="button" aria-expanded="false">
                  <span class="mega-toggle-animated-box">
                    <span class="mega-toggle-animated-inner"></span>
                  </span>
                </button></div></div></div><ul id="mega-menu-primary-menu" class="mega-menu max-mega-menu mega-menu-horizontal mega-no-js" data-event="hover_intent" data-effect="fade_up" data-effect-speed="200" data-effect-mobile="slide" data-effect-speed-mobile="200" data-panel-width=".site-header .kt-row-column-wrap" data-mobile-force-width="body" data-second-click="go" data-document-click="collapse" data-vertical-behaviour="standard" data-breakpoint="1186" data-unbind="true" data-mobile-state="collapse_all" data-mobile-direction="vertical" data-hover-intent-timeout="300" data-hover-intent-interval="100" data-overlay-desktop="false" data-overlay-mobile="false"><li class="mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-align-bottom-left mega-menu-flyout mega-menu-item-6503" id="mega-menu-item-6503"><a class="mega-menu-link" href="https://machinelearningmastery.com/start-here/" tabindex="0">Get Started</a></li><li class="mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-current_page_parent mega-align-bottom-left mega-menu-flyout mega-menu-item-6501" id="mega-menu-item-6501"><a class="mega-menu-link" href="https://machinelearningmastery.com/blog/" tabindex="0">Blog</a></li><li class="mega-menu-item mega-menu-item-type-custom mega-menu-item-object-custom mega-menu-item-has-children mega-menu-megamenu mega-align-bottom-left mega-menu-megamenu mega-menu-item-6506" id="mega-menu-item-6506"><a class="mega-menu-link" href="#" aria-expanded="false" tabindex="0">Topics<span class="mega-indicator" aria-hidden="true"></span></a>
<ul class="mega-sub-menu">
<li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-14062" style="--columns:3; --span:1" id="mega-menu-item-14062"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/attention/">Attention</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-7106" style="--columns:3; --span:1" id="mega-menu-item-7106"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/better-deep-learning/">Better Deep Learning</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-13302" style="--columns:3; --span:1" id="mega-menu-item-13302"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/calculus/">Calculus</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-clear mega-menu-item-15216" style="--columns:3; --span:1" id="mega-menu-item-15216"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/chatgpt/">ChatGPT</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-has-description mega-menu-item-6507" style="--columns:3; --span:1" id="mega-menu-item-6507"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/algorithms-from-scratch/"><span class="mega-description-group"><span class="mega-menu-title">Code Algorithms</span><span class="mega-menu-description">Implementing machine learning algorithms from scratch.</span></span></a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-current-post-ancestor mega-current-menu-parent mega-current-post-parent mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-7921" style="--columns:3; --span:1" id="mega-menu-item-7921"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/deep-learning-for-computer-vision/">Computer Vision</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-clear mega-menu-item-10674" style="--columns:3; --span:1" id="mega-menu-item-10674"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/data-preparation/">Data Preparation</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-has-description mega-menu-item-6508" style="--columns:3; --span:1" id="mega-menu-item-6508"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/deep-learning/"><span class="mega-description-group"><span class="mega-menu-title">Deep Learning (keras)</span><span class="mega-menu-description">Deep Learning</span></span></a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-14782" style="--columns:3; --span:1" id="mega-menu-item-14782"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/deep-learning-with-pytorch/">Deep Learning with PyTorch</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-clear mega-menu-item-11055" style="--columns:3; --span:1" id="mega-menu-item-11055"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/ensemble-learning/">Ensemble Learning</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-18613" style="--columns:3; --span:1" id="mega-menu-item-18613"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/foundations-of-data-science/">Foundations of Data Science</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-8576" style="--columns:3; --span:1" id="mega-menu-item-8576"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/generative-adversarial-networks/">GANs</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-clear mega-has-description mega-menu-item-6509" style="--columns:3; --span:1" id="mega-menu-item-6509"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/deep-learning-time-series/"><span class="mega-description-group"><span class="mega-menu-title">Neural Net Time Series</span><span class="mega-menu-description">Deep Learning for Time Series Forecasting</span></span></a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-6515" style="--columns:3; --span:1" id="mega-menu-item-6515"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/natural-language-processing/">NLP (Text)</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-9966" style="--columns:3; --span:1" id="mega-menu-item-9966"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/imbalanced-classification/">Imbalanced Learning</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-clear mega-menu-item-18614" style="--columns:3; --span:1" id="mega-menu-item-18614"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/intermediate-data-science/">Intermediate Data Science</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-6520" style="--columns:3; --span:1" id="mega-menu-item-6520"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/time-series/">Intro to Time Series</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-6512" style="--columns:3; --span:1" id="mega-menu-item-6512"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Intro to Algorithms</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-clear mega-menu-item-6510" style="--columns:3; --span:1" id="mega-menu-item-6510"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-has-description mega-menu-item-6511" style="--columns:3; --span:1" id="mega-menu-item-6511"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/lstm/"><span class="mega-description-group"><span class="mega-menu-title">LSTMs</span><span class="mega-menu-description">Long Short-Term Memory Networks</span></span></a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-16040" style="--columns:3; --span:1" id="mega-menu-item-16040"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/opencv/">OpenCV</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-clear mega-menu-item-12825" style="--columns:3; --span:1" id="mega-menu-item-12825"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/optimization/">Optimization</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-8989" style="--columns:3; --span:1" id="mega-menu-item-8989"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/probability/">Probability</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-6516" style="--columns:3; --span:1" id="mega-menu-item-6516"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-clear mega-menu-item-13672" style="--columns:3; --span:1" id="mega-menu-item-13672"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/python-for-machine-learning/">Python for Machine Learning</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-6517" style="--columns:3; --span:1" id="mega-menu-item-6517"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-17914" style="--columns:3; --span:1" id="mega-menu-item-17914"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/stable-diffusion/">Stable Diffusion</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-clear mega-menu-item-6519" style="--columns:3; --span:1" id="mega-menu-item-6519"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/statistical-methods/">Statistics</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-6522" style="--columns:3; --span:1" id="mega-menu-item-6522"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li><li class="mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-column-standard mega-menu-columns-1-of-3 mega-menu-item-6523" style="--columns:3; --span:1" id="mega-menu-item-6523"><a class="mega-menu-link" href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li></ul>
</li><li class="mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-align-bottom-left mega-menu-flyout mega-menu-item-6502" id="mega-menu-item-6502"><a class="mega-menu-link" href="https://machinelearningmastery.com/products/" tabindex="0">eBooks</a></li><li class="mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-align-bottom-left mega-menu-flyout mega-menu-item-6500" id="mega-menu-item-6500"><a class="mega-menu-link" href="https://machinelearningmastery.com/faq/" tabindex="0">FAQ</a></li><li class="mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-align-bottom-left mega-menu-flyout mega-menu-item-6504" id="mega-menu-item-6504"><a class="mega-menu-link" href="https://machinelearningmastery.com/about/" tabindex="0">About</a></li><li class="mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-align-bottom-left mega-menu-flyout mega-menu-item-6505" id="mega-menu-item-6505"><a class="mega-menu-link" href="https://machinelearningmastery.com/contact/" tabindex="0">Contact</a></li><li class="mega-menu-item mega-menu-item-type-custom mega-menu-item-object-custom mega-align-bottom-left mega-menu-flyout mega-menu-item-18434" id="mega-menu-item-18434"><div class='mega-search-wrap'>    <form class='mega-search expand-to-left mega-search-closed' role='search' action='https://machinelearningmastery.com/'><input  type='text' tabindex='-1' role='searchbox' id='mega-search-18434' aria-label='Search...' data-placeholder='Search...' name='s' autocomplete='off' /><span tabindex='0' role='button' class='dashicons dashicons-search search-icon' aria-controls='mega-search-18434' aria-label='Search' aria-expanded='false' aria-haspopup='true'></span><input type='submit' value='Search'>    </form></div></li></ul></nav></div></div>

</div></div></div></div>

</div></div>
	</header>
	
	<div style="width:100%; min-height:150px;height:150px; padding-top:25px; margin: auto; text-align:center;">
	<div  class="machi-3ac169673c4bf5d96fcd467c493d7f6b machi-header" id="machi-3ac169673c4bf5d96fcd467c493d7f6b"></div></div>
       
    <!-- #content Starts -->
	    <div id="content" class="col-full">
    
    	<div id="main-sidebar-container">    

            <!-- #main Starts -->
                        <section id="main">                       
<article class="post-7553 post type-post status-publish format-standard has-post-thumbnail hentry category-deep-learning-for-computer-vision">
	
	<header>
	<h1 class="title entry-title">How to Develop a CNN for MNIST Handwritten Digit Classification</h1>	</header>
	<div class="mlm-post-meta">
		<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" title="Posts by Jason Brownlee" rel="author">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr title="2021-11-14T16:05:20+1100">November 14, 2021</abbr>   <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/deep-learning-for-computer-vision/" title="View all items in Deep Learning for Computer Vision">Deep Learning for Computer Vision</a></span>  <span class="post-comments comments"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comments"><i class="fa fa-comment"></i> 193</a></span></div>
		<p id="last-modified-info"></p>
	</div>
	<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-7553 post  simplesocialbuttons-inline-no-animation">
		<button class="ssb_fbshare-icon"  rel="nofollow"  target="_blank"  aria-label="Facebook Share" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/" onClick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="_1pbq" color="#ffffff"><path fill="#ffffff" fill-rule="evenodd" class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path></svg></span>
						<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_tweet-icon"  rel="nofollow"  target="_blank"  aria-label="Twitter Share" data-href="https://twitter.com/intent/tweet?text=How+to+Develop+a+CNN+for+MNIST+Handwritten+Digit+Classification&url=https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/" onClick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
						<span class="icon"><svg viewBox="0 0 16 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.9 0H0L5.782 7.7098L0.315 14H2.17L6.6416 8.8557L10.5 14H15.4L9.3744 5.9654L14.56 0H12.705L8.5148 4.8202L4.9 0ZM11.2 12.6L2.8 1.4H4.2L12.6 12.6H11.2Z" fill="#fff"/></svg></span><i class="simplesocialtxt">Post </i></button>
<button class="ssb_linkedin-icon"  rel="nofollow"  target="_blank"  aria-label="LinkedIn Share" data-href="https://www.linkedin.com/sharing/share-offsite/?url=https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/" onClick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" >
						<span class="icon"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="14.1px" viewBox="-301.4 387.5 15 14.1" enable-background="new -301.4 387.5 15 14.1" xml:space="preserve"> <g id="XMLID_398_"> <path id="XMLID_399_" fill="#FFFFFF" d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z"/> <path id="XMLID_400_" fill="#FFFFFF" d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z"/> <path id="XMLID_401_" fill="#FFFFFF" d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z"/> </g> </svg> </span>
						<span class="simplesocialtxt">Share</span> </button>
</div>
<h4 style="text-align: center;">How to Develop a Convolutional Neural Network From Scratch for MNIST Handwritten Digit Classification.</h4>
<p>The MNIST handwritten digit classification problem is a standard dataset used in computer vision and deep learning.</p>
<p>Although the dataset is effectively solved, it can be used as the basis for learning and practicing how to develop, evaluate, and use convolutional deep learning neural networks for image classification from scratch. This includes how to develop a robust test harness for estimating the performance of the model, how to explore improvements to the model, and how to save the model and later load it to make predictions on new data.</p>
<p>In this tutorial, you will discover how to develop a convolutional neural network for handwritten digit classification from scratch.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>How to develop a test harness to develop a robust evaluation of a model and establish a baseline of performance for a classification task.</li>
<li>How to explore extensions to a baseline model to improve learning and model capacity.</li>
<li>How to develop a finalized model, evaluate the performance of the final model, and use it to make predictions on new images.</li>
</ul>
<p><strong>Kick-start your project</strong> with my new book <a href="https://machinelearningmastery.com/deep-learning-for-computer-vision/">Deep Learning for Computer Vision</a>, including <em>step-by-step tutorials</em> and the <em>Python source code</em> files for all examples.</p>
<p>Let’s get started.</p>
<ul>
<li><strong>Updated Dec/2019</strong>: Updated examples for TensorFlow 2.0 and Keras 2.3.</li>
<li><strong>Updated Jan/2020</strong>: Fixed a bug where models were defined outside the cross-validation loop.</li>
<li><strong>Updated Nov/2021</strong>: Updated to use Tensorflow 2.6</li>
</ul>
<div id="attachment_7563" style="width: 650px" class="wp-caption aligncenter"><img fetchpriority="high" decoding="async" aria-describedby="caption-attachment-7563" class="size-full wp-image-7563" src="https://machinelearningmastery.com/wp-content/uploads/2019/05/How-to-Develop-a-Convolutional-Neural-Network-From-Scratch-for-MNIST-Handwritten-Digit-Classification.jpg" alt="How to Develop a Convolutional Neural Network From Scratch for MNIST Handwritten Digit Classification" width="640" height="426" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/05/How-to-Develop-a-Convolutional-Neural-Network-From-Scratch-for-MNIST-Handwritten-Digit-Classification.jpg 640w, https://machinelearningmastery.com/wp-content/uploads/2019/05/How-to-Develop-a-Convolutional-Neural-Network-From-Scratch-for-MNIST-Handwritten-Digit-Classification-300x200.jpg 300w" sizes="(max-width: 640px) 100vw, 640px" /><p id="caption-attachment-7563" class="wp-caption-text">How to Develop a Convolutional Neural Network From Scratch for MNIST Handwritten Digit Classification<br />Photo by <a href="https://www.flickr.com/photos/geographyalltheway_photos/2918451763/">Richard Allaway</a>, some rights reserved.</p></div>
<h2>Tutorial Overview</h2>
<p>This tutorial is divided into five parts; they are:</p>
<ol>
<li>MNIST Handwritten Digit Classification Dataset</li>
<li>Model Evaluation Methodology</li>
<li>How to Develop a Baseline Model</li>
<li>How to Develop an Improved Model</li>
<li>How to Finalize the Model and Make Predictions</li>
</ol>
<div class="woo-sc-hr"></div>
<center>
<h3>Want Results with Deep Learning for Computer Vision?</h3>
<p>Take my free 7-day email crash course now (with sample code).</p>
<p>Click to sign-up and also get a free PDF Ebook version of the course.</p>
<p><script src="https://embed.lpcontent.net/leadboxes/current/embed.js" async defer></script> <button data-leadbox-popup="3wpm2NEBjgVJVkjQop9L9Y" data-leadbox-domain="machinelearningmastery.lpages.co" style="background: rgb(255, 215, 18);border-color: rgb(255, 215, 18);border-radius: 20px;color: #FFFFFF;display: inline-block;vertical-align: middle;padding: 16px 32px;min-width: 192px;border: 1px solid rgb(255, 215, 18);font-size: 1rem;font-family: Helvetica, Arial, sans-serif;text-align: center;outline: 0;line-height: 1;cursor: pointer;-webkit-transition: background 0.3s, color 0.3s, border 0.3s;transition: background 0.3s, color 0.3s, border 0.3s;  box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.6);">Click here to subscribe</button> </p>
</center>
<div class="woo-sc-hr"></div>
<h3>Development Environment</h3>
<p>This tutorial assumes that you are using standalone Keras running on top of TensorFlow with Python 3. If you need help setting up your development environment see this tutorial:</p>
<ul>
<li><a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Setup Your Python Environment for Machine Learning with Anaconda</a></li>
</ul>
<h2>MNIST Handwritten Digit Classification Dataset</h2>
<p>The <a href="https://en.wikipedia.org/wiki/MNIST_database">MNIST dataset</a> is an acronym that stands for the Modified National Institute of Standards and Technology dataset.</p>
<p>It is a dataset of 60,000 small square 28&#215;28 pixel grayscale images of handwritten single digits between 0 and 9.</p>
<p>The task is to classify a given image of a handwritten digit into one of 10 classes representing integer values from 0 to 9, inclusively.</p>
<p>It is a widely used and deeply understood dataset and, for the most part, is &#8220;<em>solved</em>.&#8221; Top-performing models are deep learning convolutional neural networks that achieve a classification accuracy of above 99%, with an error rate between 0.4 %and 0.2% on the hold out test dataset.</p>
<p>The example below loads the MNIST dataset using the Keras API and creates a plot of the first nine images in the training dataset.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2da988486790267" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# example of loading the mnist dataset
from tensorflow.keras.datasets import mnist
from matplotlib import pyplot as plt
# load dataset
(trainX, trainy), (testX, testy) = mnist.load_data()
# summarize loaded dataset
print('Train: X=%s, y=%s' % (trainX.shape, trainy.shape))
print('Test: X=%s, y=%s' % (testX.shape, testy.shape))
# plot first few images
for i in range(9):
	# define subplot
	plt.subplot(330 + 1 + i)
	# plot raw pixel data
	plt.imshow(trainX[i], cmap=plt.get_cmap('gray'))
# show the figure
plt.show()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da988486790267-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da988486790267-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da988486790267-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da988486790267-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da988486790267-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da988486790267-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da988486790267-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da988486790267-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da988486790267-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da988486790267-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da988486790267-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da988486790267-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da988486790267-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da988486790267-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da988486790267-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da988486790267-16">16</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da988486790267-1"><span class="crayon-p"># example of loading the mnist dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da988486790267-2"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">mnist</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da988486790267-3"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">plt</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da988486790267-4"><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da988486790267-5"><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testy</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mnist</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da988486790267-6"><span class="crayon-p"># summarize loaded dataset</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da988486790267-7"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Train: X=%s, y=%s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da988486790267-8"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Test: X=%s, y=%s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testy</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da988486790267-9"><span class="crayon-p"># plot first few images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da988486790267-10"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">9</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da988486790267-11"><span class="crayon-h">	</span><span class="crayon-p"># define subplot</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da988486790267-12"><span class="crayon-h">	</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">330</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da988486790267-13"><span class="crayon-h">	</span><span class="crayon-p"># plot raw pixel data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da988486790267-14"><span class="crayon-h">	</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cmap</span><span class="crayon-o">=</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">get_cmap</span><span class="crayon-sy">(</span><span class="crayon-s">'gray'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da988486790267-15"><span class="crayon-p"># show the figure</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da988486790267-16"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Running the example loads the MNIST train and test dataset and prints their shape.</p>
<p>We can see that there are 60,000 examples in the training dataset and 10,000 in the test dataset and that images are indeed square with 28&#215;28 pixels.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2da997003652794" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Train: X=(60000, 28, 28), y=(60000,)
Test: X=(10000, 28, 28), y=(10000,)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da997003652794-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da997003652794-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da997003652794-1">Train: X=(60000, 28, 28), y=(60000,)</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da997003652794-2">Test: X=(10000, 28, 28), y=(10000,)</div></div></td>
					</tr>
				</table>
			</div>
		</div><p>A plot of the first nine images in the dataset is also created showing the natural handwritten nature of the images to be classified.</p>
<div id="attachment_7555" style="width: 1034px" class="wp-caption aligncenter"><img decoding="async" aria-describedby="caption-attachment-7555" class="size-large wp-image-7555" src="https://machinelearningmastery.com/wp-content/uploads/2019/02/Plot-of-a-Subset-of-Images-from-the-MNIST-Dataset-1024x768.png" alt="Plot of a Subset of Images From the MNIST Dataset" width="1024" height="768" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/02/Plot-of-a-Subset-of-Images-from-the-MNIST-Dataset-1024x768.png 1024w, https://machinelearningmastery.com/wp-content/uploads/2019/02/Plot-of-a-Subset-of-Images-from-the-MNIST-Dataset-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2019/02/Plot-of-a-Subset-of-Images-from-the-MNIST-Dataset-768x576.png 768w, https://machinelearningmastery.com/wp-content/uploads/2019/02/Plot-of-a-Subset-of-Images-from-the-MNIST-Dataset.png 1280w" sizes="(max-width: 1024px) 100vw, 1024px" /><p id="caption-attachment-7555" class="wp-caption-text">Plot of a Subset of Images From the MNIST Dataset</p></div>
<h2>Model Evaluation Methodology</h2>
<p>Although the MNIST dataset is effectively solved, it can be a useful starting point for developing and practicing a methodology for solving image classification tasks using convolutional neural networks.</p>
<p>Instead of reviewing the literature on well-performing models on the dataset, we can develop a new model from scratch.</p>
<p>The dataset already has a well-defined train and test dataset that we can use.</p>
<p>In order to estimate the performance of a model for a given training run, we can further split the training set into a train and validation dataset. Performance on the train and validation dataset over each run can then be plotted to provide learning curves and insight into how well a model is learning the problem.</p>
<p>The Keras API supports this by specifying the &#8220;<em>validation_data</em>&#8221; argument to the <em>model.fit()</em> function when training the model, that will, in turn, return an object that describes model performance for the chosen loss and metrics on each training epoch.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2da99d281884590" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# record model performance on a validation dataset during training
history = model.fit(..., validation_data=(valX, valY))</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da99d281884590-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da99d281884590-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da99d281884590-1"><span class="crayon-p"># record model performance on a validation dataset during training</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da99d281884590-2"><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation_data</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">valX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">valY</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>In order to estimate the performance of a model on the problem in general, we can use <a href="https://machinelearningmastery.com/k-fold-cross-validation/">k-fold cross-validation</a>, perhaps five-fold cross-validation. This will give some account of the models variance with both respect to differences in the training and test datasets, and in terms of the stochastic nature of the learning algorithm. The performance of a model can be taken as the mean performance across k-folds, given the standard deviation, that could be used to estimate a confidence interval if desired.</p>
<p>We can use the <a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html">KFold class</a> from the scikit-learn API to implement the k-fold cross-validation evaluation of a given neural network model. There are many ways to achieve this, although we can choose a flexible approach where the <em>KFold</em> class is only used to specify the row indexes used for each spit.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2da9a1639627873" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# example of k-fold cv for a neural net
data = ...
# prepare cross validation
kfold = KFold(5, shuffle=True, random_state=1)
# enumerate splits
for train_ix, test_ix in kfold.split(data):
        model = ...
	...</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9a1639627873-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9a1639627873-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9a1639627873-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9a1639627873-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9a1639627873-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9a1639627873-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9a1639627873-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9a1639627873-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9a1639627873-1"><span class="crayon-p"># example of k-fold cv for a neural net</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9a1639627873-2"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9a1639627873-3"><span class="crayon-p"># prepare cross validation</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9a1639627873-4"><span class="crayon-v">kfold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KFold</span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9a1639627873-5"><span class="crayon-p"># enumerate splits</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9a1639627873-6"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">train_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">test_ix </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">kfold</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9a1639627873-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9a1639627873-8"><span class="crayon-h">	</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>We will hold back the actual test dataset and use it as an evaluation of our final model.</p>
<h2>How to Develop a Baseline Model</h2>
<p>The first step is to develop a baseline model.</p>
<p>This is critical as it both involves developing the infrastructure for the test harness so that any model we design can be evaluated on the dataset, and it establishes a baseline in model performance on the problem, by which all improvements can be compared.</p>
<p>The design of the test harness is modular, and we can develop a separate function for each piece. This allows a given aspect of the test harness to be modified or inter-changed, if we desire, separately from the rest.</p>
<p>We can develop this test harness with five key elements. They are the loading of the dataset, the preparation of the dataset, the definition of the model, the evaluation of the model, and the presentation of results.</p>
<h3>Load Dataset</h3>
<p>We know some things about the dataset.</p>
<p>For example, we know that the images are all pre-aligned (e.g. each image only contains a hand-drawn digit), that the images all have the same square size of 28&#215;28 pixels, and that the images are grayscale.</p>
<p>Therefore, we can load the images and reshape the data arrays to have a single color channel.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2da9a5570321295" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# load dataset
(trainX, trainY), (testX, testY) = mnist.load_data()
# reshape dataset to have a single channel
trainX = trainX.reshape((trainX.shape[0], 28, 28, 1))
testX = testX.reshape((testX.shape[0], 28, 28, 1))</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9a5570321295-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9a5570321295-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9a5570321295-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9a5570321295-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9a5570321295-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9a5570321295-1"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9a5570321295-2"><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mnist</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9a5570321295-3"><span class="crayon-p"># reshape dataset to have a single channel</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9a5570321295-4"><span class="crayon-v">trainX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9a5570321295-5"><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>We also know that there are 10 classes and that classes are represented as unique integers.</p>
<p>We can, therefore, use a one hot encoding for the class element of each sample, transforming the integer into a 10 element binary vector with a 1 for the index of the class value, and 0 values for all other classes. We can achieve this with the <em>to_categorical()</em> utility function.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2da9aa381584833" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# one hot encode target values
trainY = to_categorical(trainY)
testY = to_categorical(testY)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9aa381584833-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9aa381584833-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9aa381584833-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9aa381584833-1"><span class="crayon-p"># one hot encode target values</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9aa381584833-2"><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9aa381584833-3"><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">testY</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>The <em>load_dataset()</em> function implements these behaviors and can be used to load the dataset.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2da9ae851810909" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# load train and test dataset
def load_dataset():
	# load dataset
	(trainX, trainY), (testX, testY) = mnist.load_data()
	# reshape dataset to have a single channel
	trainX = trainX.reshape((trainX.shape[0], 28, 28, 1))
	testX = testX.reshape((testX.shape[0], 28, 28, 1))
	# one hot encode target values
	trainY = to_categorical(trainY)
	testY = to_categorical(testY)
	return trainX, trainY, testX, testY</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ae851810909-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ae851810909-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ae851810909-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ae851810909-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ae851810909-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ae851810909-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ae851810909-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ae851810909-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ae851810909-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ae851810909-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ae851810909-11">11</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ae851810909-1"><span class="crayon-p"># load train and test dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ae851810909-2"><span class="crayon-e">def </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ae851810909-3"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ae851810909-4"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mnist</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ae851810909-5"><span class="crayon-h">	</span><span class="crayon-p"># reshape dataset to have a single channel</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ae851810909-6"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ae851810909-7"><span class="crayon-h">	</span><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ae851810909-8"><span class="crayon-h">	</span><span class="crayon-p"># one hot encode target values</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ae851810909-9"><span class="crayon-h">	</span><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ae851810909-10"><span class="crayon-h">	</span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">testY</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ae851810909-11"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p></p>
<h3>Prepare Pixel Data</h3>
<p>We know that the pixel values for each image in the dataset are unsigned integers in the range between black and white, or 0 and 255.</p>
<p>We do not know the best way to scale the pixel values for modeling, but we know that some scaling will be required.</p>
<p>A good starting point is to <a href="https://machinelearningmastery.com/how-to-normalize-center-and-standardize-images-with-the-imagedatagenerator-in-keras/">normalize the pixel values</a> of grayscale images, e.g. rescale them to the range [0,1]. This involves first converting the data type from unsigned integers to floats, then dividing the pixel values by the maximum value.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2da9b2950183797" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# convert from integers to floats
train_norm = train.astype('float32')
test_norm = test.astype('float32')
# normalize to range 0-1
train_norm = train_norm / 255.0
test_norm = test_norm / 255.0</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9b2950183797-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9b2950183797-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9b2950183797-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9b2950183797-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9b2950183797-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9b2950183797-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9b2950183797-1"><span class="crayon-p"># convert from integers to floats</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9b2950183797-2"><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9b2950183797-3"><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9b2950183797-4"><span class="crayon-p"># normalize to range 0-1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9b2950183797-5"><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9b2950183797-6"><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>The <em>prep_pixels()</em> function below implements these behaviors and is provided with the pixel values for both the train and test datasets that will need to be scaled.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2da9b6641429324" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# scale pixels
def prep_pixels(train, test):
	# convert from integers to floats
	train_norm = train.astype('float32')
	test_norm = test.astype('float32')
	# normalize to range 0-1
	train_norm = train_norm / 255.0
	test_norm = test_norm / 255.0
	# return normalized images
	return train_norm, test_norm</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9b6641429324-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9b6641429324-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9b6641429324-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9b6641429324-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9b6641429324-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9b6641429324-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9b6641429324-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9b6641429324-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9b6641429324-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9b6641429324-10">10</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9b6641429324-1"><span class="crayon-p"># scale pixels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9b6641429324-2"><span class="crayon-e">def </span><span class="crayon-e">prep_pixels</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9b6641429324-3"><span class="crayon-h">	</span><span class="crayon-p"># convert from integers to floats</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9b6641429324-4"><span class="crayon-h">	</span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9b6641429324-5"><span class="crayon-h">	</span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9b6641429324-6"><span class="crayon-h">	</span><span class="crayon-p"># normalize to range 0-1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9b6641429324-7"><span class="crayon-h">	</span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9b6641429324-8"><span class="crayon-h">	</span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9b6641429324-9"><span class="crayon-h">	</span><span class="crayon-p"># return normalized images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9b6641429324-10"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">train_norm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_norm</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>This function must be called to prepare the pixel values prior to any modeling.</p>
<h3>Define Model</h3>
<p>Next, we need to define a baseline convolutional neural network model for the problem.</p>
<p>The model has two main aspects: the feature extraction front end comprised of convolutional and pooling layers, and the classifier backend that will make a prediction.</p>
<p>For the convolutional front-end, we can start with a single <a href="https://machinelearningmastery.com/convolutional-layers-for-deep-learning-neural-networks/">convolutional layer</a> with a small filter size (3,3) and a modest number of filters (32) followed by a <a href="https://machinelearningmastery.com/pooling-layers-for-convolutional-neural-networks/">max pooling layer</a>. The filter maps can then be flattened to provide features to the classifier.</p>
<p>Given that the problem is a multi-class classification task, we know that we will require an output layer with 10 nodes in order to predict the probability distribution of an image belonging to each of the 10 classes. This will also require the use of a softmax activation function. Between the feature extractor and the output layer, we can add a dense layer to interpret the features, in this case with 100 nodes.</p>
<p>All layers will use the <a href="https://machinelearningmastery.com/rectified-linear-activation-function-for-deep-learning-neural-networks/">ReLU activation function</a> and the He weight initialization scheme, both best practices.</p>
<p>We will use a conservative configuration for the stochastic gradient descent optimizer with a <a href="https://machinelearningmastery.com/understand-the-dynamics-of-learning-rate-on-deep-learning-neural-networks/">learning rate</a> of 0.01 and a momentum of 0.9. The <a href="https://machinelearningmastery.com/cross-entropy-for-machine-learning/">categorical cross-entropy</a> loss function will be optimized, suitable for multi-class classification, and we will monitor the classification accuracy metric, which is appropriate given we have the same number of examples in each of the 10 classes.</p>
<p>The <em>define_model()</em> function below will define and return this model.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2da9b9782374063" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# define cnn model
def define_model():
	model = Sequential()
	model.add(Conv2D(32, (3, 3), activation='relu', kernel_initializer='he_uniform', input_shape=(28, 28, 1)))
	model.add(MaxPooling2D((2, 2)))
	model.add(Flatten())
	model.add(Dense(100, activation='relu', kernel_initializer='he_uniform'))
	model.add(Dense(10, activation='softmax'))
	# compile model
	opt = SGD(learning_rate=0.01, momentum=0.9)
	model.compile(optimizer=opt, loss='categorical_crossentropy', metrics=['accuracy'])
	return model</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9b9782374063-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9b9782374063-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9b9782374063-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9b9782374063-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9b9782374063-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9b9782374063-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9b9782374063-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9b9782374063-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9b9782374063-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9b9782374063-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9b9782374063-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9b9782374063-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9b9782374063-1"><span class="crayon-p"># define cnn model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9b9782374063-2"><span class="crayon-e">def </span><span class="crayon-e">define_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9b9782374063-3"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9b9782374063-4"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9b9782374063-5"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9b9782374063-6"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9b9782374063-7"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9b9782374063-8"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'softmax'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9b9782374063-9"><span class="crayon-h">	</span><span class="crayon-p"># compile model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9b9782374063-10"><span class="crayon-h">	</span><span class="crayon-v">opt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SGD</span><span class="crayon-sy">(</span><span class="crayon-v">learning_rate</span><span class="crayon-o">=</span><span class="crayon-cn">0.01</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">momentum</span><span class="crayon-o">=</span><span class="crayon-cn">0.9</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9b9782374063-11"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">opt</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'categorical_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9b9782374063-12"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p></p>
<h3>Evaluate Model</h3>
<p>After the model is defined, we need to evaluate it.</p>
<p>The model will be evaluated using <a href="https://machinelearningmastery.com/k-fold-cross-validation/">five-fold cross-validation</a>. The value of <em>k=5</em> was chosen to provide a baseline for both repeated evaluation and to not be so large as to require a long running time. Each test set will be 20% of the training dataset, or about 12,000 examples, close to the size of the actual test set for this problem.</p>
<p>The training dataset is shuffled prior to being split, and the sample shuffling is performed each time, so that any model we evaluate will have the same train and test datasets in each fold, providing an apples-to-apples comparison between models.</p>
<p>We will train the baseline model for a modest 10 training epochs with a default batch size of 32 examples. The test set for each fold will be used to evaluate the model both during each epoch of the training run, so that we can later create learning curves, and at the end of the run, so that we can estimate the performance of the model. As such, we will keep track of the resulting history from each run, as well as the classification accuracy of the fold.</p>
<p>The <em>evaluate_model()</em> function below implements these behaviors, taking the training dataset as arguments and returning a list of accuracy scores and training histories that can be later summarized.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2da9bd420739797" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# evaluate a model using k-fold cross-validation
def evaluate_model(dataX, dataY, n_folds=5):
	scores, histories = list(), list()
	# prepare cross validation
	kfold = KFold(n_folds, shuffle=True, random_state=1)
	# enumerate splits
	for train_ix, test_ix in kfold.split(dataX):
		# define model
		model = define_model()
		# select rows for train and test
		trainX, trainY, testX, testY = dataX[train_ix], dataY[train_ix], dataX[test_ix], dataY[test_ix]
		# fit model
		history = model.fit(trainX, trainY, epochs=10, batch_size=32, validation_data=(testX, testY), verbose=0)
		# evaluate model
		_, acc = model.evaluate(testX, testY, verbose=0)
		print('&gt; %.3f' % (acc * 100.0))
		# stores scores
		scores.append(acc)
		histories.append(history)
	return scores, histories</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9bd420739797-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9bd420739797-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9bd420739797-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9bd420739797-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9bd420739797-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9bd420739797-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9bd420739797-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9bd420739797-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9bd420739797-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9bd420739797-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9bd420739797-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9bd420739797-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9bd420739797-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9bd420739797-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9bd420739797-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9bd420739797-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9bd420739797-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9bd420739797-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9bd420739797-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9bd420739797-20">20</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9bd420739797-1"><span class="crayon-p"># evaluate a model using k-fold cross-validation</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9bd420739797-2"><span class="crayon-e">def </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">dataX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9bd420739797-3"><span class="crayon-h">	</span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">histories</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9bd420739797-4"><span class="crayon-h">	</span><span class="crayon-p"># prepare cross validation</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9bd420739797-5"><span class="crayon-h">	</span><span class="crayon-v">kfold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KFold</span><span class="crayon-sy">(</span><span class="crayon-v">n_folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9bd420739797-6"><span class="crayon-h">	</span><span class="crayon-p"># enumerate splits</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9bd420739797-7"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">train_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">test_ix </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">kfold</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">dataX</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9bd420739797-8"><span class="crayon-h">		</span><span class="crayon-p"># define model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9bd420739797-9"><span class="crayon-h">		</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9bd420739797-10"><span class="crayon-h">		</span><span class="crayon-p"># select rows for train and test</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9bd420739797-11"><span class="crayon-h">		</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataX</span><span class="crayon-sy">[</span><span class="crayon-v">train_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-sy">[</span><span class="crayon-v">train_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataX</span><span class="crayon-sy">[</span><span class="crayon-v">test_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-sy">[</span><span class="crayon-v">test_ix</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9bd420739797-12"><span class="crayon-h">		</span><span class="crayon-p"># fit model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9bd420739797-13"><span class="crayon-h">		</span><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation_data</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9bd420739797-14"><span class="crayon-h">		</span><span class="crayon-p"># evaluate model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9bd420739797-15"><span class="crayon-h">		</span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9bd420739797-16"><span class="crayon-h">		</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt; %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">acc *</span><span class="crayon-h"> </span><span class="crayon-cn">100.0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9bd420739797-17"><span class="crayon-h">		</span><span class="crayon-p"># stores scores</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9bd420739797-18"><span class="crayon-h">		</span><span class="crayon-v">scores</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">acc</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9bd420739797-19"><span class="crayon-h">		</span><span class="crayon-v">histories</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9bd420739797-20"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">histories</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p></p>
<h3>Present Results</h3>
<p>Once the model has been evaluated, we can present the results.</p>
<p>There are two key aspects to present: the diagnostics of the learning behavior of the model during training and the estimation of the model performance. These can be implemented using separate functions.</p>
<p>First, the diagnostics involve creating a line plot showing model performance on the train and test set during each fold of the k-fold cross-validation. These plots are valuable for getting an idea of whether a model is overfitting, underfitting, or has a good fit for the dataset.</p>
<p>We will create a single figure with two subplots, one for loss and one for accuracy. Blue lines will indicate model performance on the training dataset and orange lines will indicate performance on the hold out test dataset. The <em>summarize_diagnostics()</em> function below creates and shows this plot given the collected training histories.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2da9c1951886468" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# plot diagnostic learning curves
def summarize_diagnostics(histories):
	for i in range(len(histories)):
		# plot loss
		plt.subplot(2, 1, 1)
		plt.title('Cross Entropy Loss')
		plt.plot(histories[i].history['loss'], color='blue', label='train')
		plt.plot(histories[i].history['val_loss'], color='orange', label='test')
		# plot accuracy
		plt.subplot(2, 1, 2)
		plt.title('Classification Accuracy')
		plt.plot(histories[i].history['accuracy'], color='blue', label='train')
		plt.plot(histories[i].history['val_accuracy'], color='orange', label='test')
	plt.show()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9c1951886468-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9c1951886468-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9c1951886468-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9c1951886468-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9c1951886468-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9c1951886468-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9c1951886468-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9c1951886468-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9c1951886468-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9c1951886468-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9c1951886468-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9c1951886468-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9c1951886468-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9c1951886468-14">14</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9c1951886468-1"><span class="crayon-p"># plot diagnostic learning curves</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9c1951886468-2"><span class="crayon-e">def </span><span class="crayon-e">summarize_diagnostics</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9c1951886468-3"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9c1951886468-4"><span class="crayon-h">		</span><span class="crayon-p"># plot loss</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9c1951886468-5"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9c1951886468-6"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Cross Entropy Loss'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9c1951886468-7"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'loss'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'blue'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'train'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9c1951886468-8"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'val_loss'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'orange'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'test'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9c1951886468-9"><span class="crayon-h">		</span><span class="crayon-p"># plot accuracy</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9c1951886468-10"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9c1951886468-11"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Classification Accuracy'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9c1951886468-12"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'blue'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'train'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9c1951886468-13"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'val_accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'orange'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'test'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9c1951886468-14"><span class="crayon-h">	</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Next, the classification accuracy scores collected during each fold can be summarized by calculating the mean and standard deviation. This provides an estimate of the average expected performance of the model trained on this dataset, with an estimate of the average variance in the mean. We will also summarize the distribution of scores by creating and showing a box and whisker plot.</p>
<p>The <em>summarize_performance()</em> function below implements this for a given list of scores collected during model evaluation.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2da9c6466871840" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# summarize model performance
def summarize_performance(scores):
	# print summary
	print('Accuracy: mean=%.3f std=%.3f, n=%d' % (mean(scores)*100, std(scores)*100, len(scores)))
	# box and whisker plots of results
	plt.boxplot(scores)
	plt.show()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9c6466871840-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9c6466871840-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9c6466871840-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9c6466871840-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9c6466871840-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9c6466871840-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9c6466871840-7">7</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9c6466871840-1"><span class="crayon-p"># summarize model performance</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9c6466871840-2"><span class="crayon-e">def </span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9c6466871840-3"><span class="crayon-h">	</span><span class="crayon-p"># print summary</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9c6466871840-4"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Accuracy: mean=%.3f std=%.3f, n=%d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9c6466871840-5"><span class="crayon-h">	</span><span class="crayon-p"># box and whisker plots of results</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9c6466871840-6"><span class="crayon-h">	</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">boxplot</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9c6466871840-7"><span class="crayon-h">	</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p></p>
<h3>Complete Example</h3>
<p>We need a function that will drive the test harness.</p>
<p>This involves calling all of the define functions.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2da9ca977300021" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# run the test harness for evaluating a model
def run_test_harness():
	# load dataset
	trainX, trainY, testX, testY = load_dataset()
	# prepare pixel data
	trainX, testX = prep_pixels(trainX, testX)
	# evaluate model
	scores, histories = evaluate_model(trainX, trainY)
	# learning curves
	summarize_diagnostics(histories)
	# summarize estimated performance
	summarize_performance(scores)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ca977300021-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ca977300021-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ca977300021-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ca977300021-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ca977300021-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ca977300021-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ca977300021-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ca977300021-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ca977300021-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ca977300021-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ca977300021-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ca977300021-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ca977300021-1"><span class="crayon-p"># run the test harness for evaluating a model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ca977300021-2"><span class="crayon-e">def </span><span class="crayon-e">run_test_harness</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ca977300021-3"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ca977300021-4"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ca977300021-5"><span class="crayon-h">	</span><span class="crayon-p"># prepare pixel data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ca977300021-6"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">prep_pixels</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ca977300021-7"><span class="crayon-h">	</span><span class="crayon-p"># evaluate model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ca977300021-8"><span class="crayon-h">	</span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">histories</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ca977300021-9"><span class="crayon-h">	</span><span class="crayon-p"># learning curves</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ca977300021-10"><span class="crayon-h">	</span><span class="crayon-e">summarize_diagnostics</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ca977300021-11"><span class="crayon-h">	</span><span class="crayon-p"># summarize estimated performance</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ca977300021-12"><span class="crayon-h">	</span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>We now have everything we need; the complete code example for a baseline convolutional neural network model on the MNIST dataset is listed below.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2da9ce994665523" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# baseline cnn model for mnist
from numpy import mean
from numpy import std
from matplotlib import pyplot as plt
from sklearn.model_selection import KFold
from tensorflow.keras.datasets import mnist
from tensorflow.keras.utils import to_categorical
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Conv2D
from tensorflow.keras.layers import MaxPooling2D
from tensorflow.keras.layers import Dense
from tensorflow.keras.layers import Flatten
from tensorflow.keras.optimizers import SGD

# load train and test dataset
def load_dataset():
	# load dataset
	(trainX, trainY), (testX, testY) = mnist.load_data()
	# reshape dataset to have a single channel
	trainX = trainX.reshape((trainX.shape[0], 28, 28, 1))
	testX = testX.reshape((testX.shape[0], 28, 28, 1))
	# one hot encode target values
	trainY = to_categorical(trainY)
	testY = to_categorical(testY)
	return trainX, trainY, testX, testY

# scale pixels
def prep_pixels(train, test):
	# convert from integers to floats
	train_norm = train.astype('float32')
	test_norm = test.astype('float32')
	# normalize to range 0-1
	train_norm = train_norm / 255.0
	test_norm = test_norm / 255.0
	# return normalized images
	return train_norm, test_norm

# define cnn model
def define_model():
	model = Sequential()
	model.add(Conv2D(32, (3, 3), activation='relu', kernel_initializer='he_uniform', input_shape=(28, 28, 1)))
	model.add(MaxPooling2D((2, 2)))
	model.add(Flatten())
	model.add(Dense(100, activation='relu', kernel_initializer='he_uniform'))
	model.add(Dense(10, activation='softmax'))
	# compile model
	opt = SGD(learning_rate=0.01, momentum=0.9)
	model.compile(optimizer=opt, loss='categorical_crossentropy', metrics=['accuracy'])
	return model

# evaluate a model using k-fold cross-validation
def evaluate_model(dataX, dataY, n_folds=5):
	scores, histories = list(), list()
	# prepare cross validation
	kfold = KFold(n_folds, shuffle=True, random_state=1)
	# enumerate splits
	for train_ix, test_ix in kfold.split(dataX):
		# define model
		model = define_model()
		# select rows for train and test
		trainX, trainY, testX, testY = dataX[train_ix], dataY[train_ix], dataX[test_ix], dataY[test_ix]
		# fit model
		history = model.fit(trainX, trainY, epochs=10, batch_size=32, validation_data=(testX, testY), verbose=0)
		# evaluate model
		_, acc = model.evaluate(testX, testY, verbose=0)
		print('&gt; %.3f' % (acc * 100.0))
		# stores scores
		scores.append(acc)
		histories.append(history)
	return scores, histories

# plot diagnostic learning curves
def summarize_diagnostics(histories):
	for i in range(len(histories)):
		# plot loss
		plt.subplot(2, 1, 1)
		plt.title('Cross Entropy Loss')
		plt.plot(histories[i].history['loss'], color='blue', label='train')
		plt.plot(histories[i].history['val_loss'], color='orange', label='test')
		# plot accuracy
		plt.subplot(2, 1, 2)
		plt.title('Classification Accuracy')
		plt.plot(histories[i].history['accuracy'], color='blue', label='train')
		plt.plot(histories[i].history['val_accuracy'], color='orange', label='test')
	plt.show()

# summarize model performance
def summarize_performance(scores):
	# print summary
	print('Accuracy: mean=%.3f std=%.3f, n=%d' % (mean(scores)*100, std(scores)*100, len(scores)))
	# box and whisker plots of results
	plt.boxplot(scores)
	plt.show()

# run the test harness for evaluating a model
def run_test_harness():
	# load dataset
	trainX, trainY, testX, testY = load_dataset()
	# prepare pixel data
	trainX, testX = prep_pixels(trainX, testX)
	# evaluate model
	scores, histories = evaluate_model(trainX, trainY)
	# learning curves
	summarize_diagnostics(histories)
	# summarize estimated performance
	summarize_performance(scores)

# entry point, run the test harness
run_test_harness()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-60">60</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-61">61</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-62">62</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-63">63</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-64">64</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-65">65</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-66">66</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-67">67</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-68">68</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-69">69</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-70">70</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-71">71</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-72">72</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-73">73</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-74">74</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-75">75</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-76">76</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-77">77</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-78">78</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-79">79</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-80">80</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-81">81</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-82">82</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-83">83</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-84">84</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-85">85</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-86">86</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-87">87</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-88">88</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-89">89</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-90">90</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-91">91</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-92">92</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-93">93</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-94">94</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-95">95</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-96">96</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-97">97</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-98">98</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-99">99</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-100">100</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-101">101</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-102">102</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-103">103</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-104">104</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-105">105</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-106">106</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-107">107</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-108">108</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ce994665523-109">109</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-1"><span class="crayon-p"># baseline cnn model for mnist</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">mean</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">std</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-4"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">plt</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-5"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">KFold</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-6"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">mnist</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-7"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-e">to_categorical</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-8"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-9"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Conv2D</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-10"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">MaxPooling2D</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-11"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-12"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Flatten</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-13"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">optimizers </span><span class="crayon-e">import </span><span class="crayon-i">SGD</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-15"><span class="crayon-p"># load train and test dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-16"><span class="crayon-e">def </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-17"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-18"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mnist</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-19"><span class="crayon-h">	</span><span class="crayon-p"># reshape dataset to have a single channel</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-20"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-21"><span class="crayon-h">	</span><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-22"><span class="crayon-h">	</span><span class="crayon-p"># one hot encode target values</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-23"><span class="crayon-h">	</span><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-24"><span class="crayon-h">	</span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">testY</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-25"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">testY</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-26">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-27"><span class="crayon-p"># scale pixels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-28"><span class="crayon-e">def </span><span class="crayon-e">prep_pixels</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-29"><span class="crayon-h">	</span><span class="crayon-p"># convert from integers to floats</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-30"><span class="crayon-h">	</span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-31"><span class="crayon-h">	</span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-32"><span class="crayon-h">	</span><span class="crayon-p"># normalize to range 0-1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-33"><span class="crayon-h">	</span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-34"><span class="crayon-h">	</span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-35"><span class="crayon-h">	</span><span class="crayon-p"># return normalized images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-36"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">train_norm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">_</span>norm</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-37">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-38"><span class="crayon-p"># define cnn model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-39"><span class="crayon-e">def </span><span class="crayon-e">define_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-40"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-41"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-42"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-43"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-44"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-45"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'softmax'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-46"><span class="crayon-h">	</span><span class="crayon-p"># compile model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-47"><span class="crayon-h">	</span><span class="crayon-v">opt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SGD</span><span class="crayon-sy">(</span><span class="crayon-v">learning_rate</span><span class="crayon-o">=</span><span class="crayon-cn">0.01</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">momentum</span><span class="crayon-o">=</span><span class="crayon-cn">0.9</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-48"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">opt</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'categorical_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-49"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-50">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-51"><span class="crayon-p"># evaluate a model using k-fold cross-validation</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-52"><span class="crayon-e">def </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">dataX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-53"><span class="crayon-h">	</span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">histories</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-54"><span class="crayon-h">	</span><span class="crayon-p"># prepare cross validation</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-55"><span class="crayon-h">	</span><span class="crayon-v">kfold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KFold</span><span class="crayon-sy">(</span><span class="crayon-v">n_folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-56"><span class="crayon-h">	</span><span class="crayon-p"># enumerate splits</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-57"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">train_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">test_ix </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">kfold</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">dataX</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-58"><span class="crayon-h">		</span><span class="crayon-p"># define model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-59"><span class="crayon-h">		</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-60"><span class="crayon-h">		</span><span class="crayon-p"># select rows for train and test</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-61"><span class="crayon-h">		</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataX</span><span class="crayon-sy">[</span><span class="crayon-v">train_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-sy">[</span><span class="crayon-v">train_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataX</span><span class="crayon-sy">[</span><span class="crayon-v">test_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-sy">[</span><span class="crayon-v">test_ix</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-62"><span class="crayon-h">		</span><span class="crayon-p"># fit model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-63"><span class="crayon-h">		</span><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation_data</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-64"><span class="crayon-h">		</span><span class="crayon-p"># evaluate model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-65"><span class="crayon-h">		</span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-66"><span class="crayon-h">		</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt; %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">acc *</span><span class="crayon-h"> </span><span class="crayon-cn">100.0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-67"><span class="crayon-h">		</span><span class="crayon-p"># stores scores</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-68"><span class="crayon-h">		</span><span class="crayon-v">scores</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">acc</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-69"><span class="crayon-h">		</span><span class="crayon-v">histories</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-70"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">histories</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-71">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-72"><span class="crayon-p"># plot diagnostic learning curves</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-73"><span class="crayon-e">def </span><span class="crayon-e">summarize_diagnostics</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-74"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-75"><span class="crayon-h">		</span><span class="crayon-p"># plot loss</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-76"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-77"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Cross Entropy Loss'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-78"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'loss'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'blue'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'train'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-79"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'val_loss'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'orange'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'test'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-80"><span class="crayon-h">		</span><span class="crayon-p"># plot accuracy</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-81"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-82"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Classification Accuracy'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-83"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'blue'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'train'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-84"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'val_accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'orange'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'test'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-85"><span class="crayon-h">	</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-86">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-87"><span class="crayon-p"># summarize model performance</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-88"><span class="crayon-e">def </span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-89"><span class="crayon-h">	</span><span class="crayon-p"># print summary</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-90"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Accuracy: mean=%.3f std=%.3f, n=%d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-91"><span class="crayon-h">	</span><span class="crayon-p"># box and whisker plots of results</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-92"><span class="crayon-h">	</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">boxplot</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-93"><span class="crayon-h">	</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-94">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-95"><span class="crayon-p"># run the test harness for evaluating a model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-96"><span class="crayon-e">def </span><span class="crayon-e">run_test_harness</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-97"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-98"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-99"><span class="crayon-h">	</span><span class="crayon-p"># prepare pixel data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-100"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">prep_pixels</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-101"><span class="crayon-h">	</span><span class="crayon-p"># evaluate model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-102"><span class="crayon-h">	</span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">histories</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-103"><span class="crayon-h">	</span><span class="crayon-p"># learning curves</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-104"><span class="crayon-h">	</span><span class="crayon-e">summarize_diagnostics</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-105"><span class="crayon-h">	</span><span class="crayon-p"># summarize estimated performance</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-106"><span class="crayon-h">	</span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-107">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-108"><span class="crayon-p"># entry point, run the test harness</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ce994665523-109"><span class="crayon-e">run_test_harness</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Running the example prints the classification accuracy for each fold of the cross-validation process. This is helpful to get an idea that the model evaluation is progressing.</p>
<p><strong>Note</strong>: Your <a href="https://machinelearningmastery.com/different-results-each-time-in-machine-learning/">results may vary</a> given the stochastic nature of the algorithm or evaluation procedure, or differences in numerical precision. Consider running the example a few times and compare the average outcome.</p>

<p>We can see two cases where the model achieves perfect skill and one case where it achieved lower than 98% accuracy. These are good results.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2da9d4368092583" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&gt; 98.550
&gt; 98.600
&gt; 98.642
&gt; 98.850
&gt; 98.742</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9d4368092583-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9d4368092583-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9d4368092583-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9d4368092583-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9d4368092583-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9d4368092583-1">&gt; 98.550</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9d4368092583-2">&gt; 98.600</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9d4368092583-3">&gt; 98.642</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9d4368092583-4">&gt; 98.850</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9d4368092583-5">&gt; 98.742</div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Next, a diagnostic plot is shown, giving insight into the learning behavior of the model across each fold.</p>
<p>In this case, we can see that the model generally achieves a good fit, with train and test learning curves converging. There is no obvious sign of over- or underfitting.</p>
<div id="attachment_9971" style="width: 1290px" class="wp-caption aligncenter"><img decoding="async" aria-describedby="caption-attachment-9971" class="size-full wp-image-9971" src="https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Baseline-Model-During-k-Fold-Cross-Validation2.png" alt="Loss and Accuracy Learning Curves for the Baseline Model During k-Fold Cross-Validation" width="1280" height="960" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Baseline-Model-During-k-Fold-Cross-Validation2.png 1280w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Baseline-Model-During-k-Fold-Cross-Validation2-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Baseline-Model-During-k-Fold-Cross-Validation2-1024x768.png 1024w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Baseline-Model-During-k-Fold-Cross-Validation2-768x576.png 768w" sizes="(max-width: 1280px) 100vw, 1280px" /><p id="caption-attachment-9971" class="wp-caption-text">Loss and Accuracy Learning Curves for the Baseline Model During k-Fold Cross-Validation</p></div>
<p>Next, a summary of the model performance is calculated.</p>
<p>We can see in this case, the model has an estimated skill of about 98.6%, which is reasonable.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2da9d8745468477" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Accuracy: mean=98.677 std=0.107, n=5</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9d8745468477-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9d8745468477-1">Accuracy: mean=98.677 std=0.107, n=5</div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Finally, a box and whisker plot is created to summarize the distribution of accuracy scores.</p>
<div id="attachment_9972" style="width: 1290px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-9972" class="size-full wp-image-9972" src="https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-Baseline-Model-Evaluated-Using-k-Fold-Cross-Validation2.png" alt="Box and Whisker Plot of Accuracy Scores for the Baseline Model Evaluated Using k-Fold Cross-Validation" width="1280" height="960" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-Baseline-Model-Evaluated-Using-k-Fold-Cross-Validation2.png 1280w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-Baseline-Model-Evaluated-Using-k-Fold-Cross-Validation2-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-Baseline-Model-Evaluated-Using-k-Fold-Cross-Validation2-1024x768.png 1024w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-Baseline-Model-Evaluated-Using-k-Fold-Cross-Validation2-768x576.png 768w" sizes="auto, (max-width: 1280px) 100vw, 1280px" /><p id="caption-attachment-9972" class="wp-caption-text">Box and Whisker Plot of Accuracy Scores for the Baseline Model Evaluated Using k-Fold Cross-Validation</p></div>
<p>We now have a robust test harness and a well-performing baseline model.</p>
<h2>How to Develop an Improved Model</h2>
<p>There are many ways that we might explore improvements to the baseline model.</p>
<p>We will look at areas of model configuration that often result in an improvement, so-called low-hanging fruit. The first is a change to the learning algorithm, and the second is an increase in the depth of the model.</p>
<h3>Improvement to Learning</h3>
<p>There are many aspects of the learning algorithm that can be explored for improvement.</p>
<p>Perhaps the point of biggest leverage is the learning rate, such as evaluating the impact that smaller or larger values of the learning rate may have, as well as schedules that change the learning rate during training.</p>
<p>Another approach that can rapidly accelerate the learning of a model and can result in large performance improvements is batch normalization. We will evaluate the effect that batch normalization has on our baseline model.</p>
<p><a href="https://machinelearningmastery.com/how-to-accelerate-learning-of-deep-neural-networks-with-batch-normalization/">Batch normalization</a> can be used after convolutional and fully connected layers. It has the effect of changing the distribution of the output of the layer, specifically by standardizing the outputs. This has the effect of stabilizing and accelerating the learning process.</p>
<p>We can update the model definition to use batch normalization after the activation function for the convolutional and dense layers of our baseline model. The updated version of <em>define_model()</em> function with batch normalization is listed below.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2da9dd351851614" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# define cnn model
def define_model():
	model = Sequential()
	model.add(Conv2D(32, (3, 3), activation='relu', kernel_initializer='he_uniform', input_shape=(28, 28, 1)))
	model.add(BatchNormalization())
	model.add(MaxPooling2D((2, 2)))
	model.add(Flatten())
	model.add(Dense(100, activation='relu', kernel_initializer='he_uniform'))
	model.add(BatchNormalization())
	model.add(Dense(10, activation='softmax'))
	# compile model
	opt = SGD(learning_rate=0.01, momentum=0.9)
	model.compile(optimizer=opt, loss='categorical_crossentropy', metrics=['accuracy'])
	return model</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9dd351851614-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9dd351851614-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9dd351851614-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9dd351851614-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9dd351851614-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9dd351851614-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9dd351851614-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9dd351851614-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9dd351851614-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9dd351851614-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9dd351851614-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9dd351851614-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9dd351851614-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9dd351851614-14">14</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9dd351851614-1"><span class="crayon-p"># define cnn model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9dd351851614-2"><span class="crayon-e">def </span><span class="crayon-e">define_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9dd351851614-3"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9dd351851614-4"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9dd351851614-5"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">BatchNormalization</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9dd351851614-6"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9dd351851614-7"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9dd351851614-8"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9dd351851614-9"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">BatchNormalization</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9dd351851614-10"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'softmax'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9dd351851614-11"><span class="crayon-h">	</span><span class="crayon-p"># compile model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9dd351851614-12"><span class="crayon-h">	</span><span class="crayon-v">opt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SGD</span><span class="crayon-sy">(</span><span class="crayon-v">learning_rate</span><span class="crayon-o">=</span><span class="crayon-cn">0.01</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">momentum</span><span class="crayon-o">=</span><span class="crayon-cn">0.9</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9dd351851614-13"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">opt</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'categorical_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9dd351851614-14"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>The complete code listing with this change is provided below.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2da9e1030574461" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# cnn model with batch normalization for mnist
from numpy import mean
from numpy import std
from matplotlib import pyplot as plt
from sklearn.model_selection import KFold
from tensorflow.keras.datasets import mnist
from tensorflow.keras.utils import to_categorical
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Conv2D
from tensorflow.keras.layers import MaxPooling2D
from tensorflow.keras.layers import Dense
from tensorflow.keras.layers import Flatten
from tensorflow.keras.optimizers import SGD
from tensorflow.keras.layers import BatchNormalization

# load train and test dataset
def load_dataset():
	# load dataset
	(trainX, trainY), (testX, testY) = mnist.load_data()
	# reshape dataset to have a single channel
	trainX = trainX.reshape((trainX.shape[0], 28, 28, 1))
	testX = testX.reshape((testX.shape[0], 28, 28, 1))
	# one hot encode target values
	trainY = to_categorical(trainY)
	testY = to_categorical(testY)
	return trainX, trainY, testX, testY

# scale pixels
def prep_pixels(train, test):
	# convert from integers to floats
	train_norm = train.astype('float32')
	test_norm = test.astype('float32')
	# normalize to range 0-1
	train_norm = train_norm / 255.0
	test_norm = test_norm / 255.0
	# return normalized images
	return train_norm, test_norm

# define cnn model
def define_model():
	model = Sequential()
	model.add(Conv2D(32, (3, 3), activation='relu', kernel_initializer='he_uniform', input_shape=(28, 28, 1)))
	model.add(BatchNormalization())
	model.add(MaxPooling2D((2, 2)))
	model.add(Flatten())
	model.add(Dense(100, activation='relu', kernel_initializer='he_uniform'))
	model.add(BatchNormalization())
	model.add(Dense(10, activation='softmax'))
	# compile model
	opt = SGD(learning_rate=0.01, momentum=0.9)
	model.compile(optimizer=opt, loss='categorical_crossentropy', metrics=['accuracy'])
	return model

# evaluate a model using k-fold cross-validation
def evaluate_model(dataX, dataY, n_folds=5):
	scores, histories = list(), list()
	# prepare cross validation
	kfold = KFold(n_folds, shuffle=True, random_state=1)
	# enumerate splits
	for train_ix, test_ix in kfold.split(dataX):
		# define model
		model = define_model()
		# select rows for train and test
		trainX, trainY, testX, testY = dataX[train_ix], dataY[train_ix], dataX[test_ix], dataY[test_ix]
		# fit model
		history = model.fit(trainX, trainY, epochs=10, batch_size=32, validation_data=(testX, testY), verbose=0)
		# evaluate model
		_, acc = model.evaluate(testX, testY, verbose=0)
		print('&gt; %.3f' % (acc * 100.0))
		# stores scores
		scores.append(acc)
		histories.append(history)
	return scores, histories

# plot diagnostic learning curves
def summarize_diagnostics(histories):
	for i in range(len(histories)):
		# plot loss
		plt.subplot(2, 1, 1)
		plt.title('Cross Entropy Loss')
		plt.plot(histories[i].history['loss'], color='blue', label='train')
		plt.plot(histories[i].history['val_loss'], color='orange', label='test')
		# plot accuracy
		plt.subplot(2, 1, 2)
		plt.title('Classification Accuracy')
		plt.plot(histories[i].history['accuracy'], color='blue', label='train')
		plt.plot(histories[i].history['val_accuracy'], color='orange', label='test')
	plt.show()

# summarize model performance
def summarize_performance(scores):
	# print summary
	print('Accuracy: mean=%.3f std=%.3f, n=%d' % (mean(scores)*100, std(scores)*100, len(scores)))
	# box and whisker plots of results
	plt.boxplot(scores)
	plt.show()

# run the test harness for evaluating a model
def run_test_harness():
	# load dataset
	trainX, trainY, testX, testY = load_dataset()
	# prepare pixel data
	trainX, testX = prep_pixels(trainX, testX)
	# evaluate model
	scores, histories = evaluate_model(trainX, trainY)
	# learning curves
	summarize_diagnostics(histories)
	# summarize estimated performance
	summarize_performance(scores)

# entry point, run the test harness
run_test_harness()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-60">60</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-61">61</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-62">62</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-63">63</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-64">64</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-65">65</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-66">66</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-67">67</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-68">68</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-69">69</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-70">70</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-71">71</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-72">72</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-73">73</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-74">74</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-75">75</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-76">76</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-77">77</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-78">78</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-79">79</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-80">80</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-81">81</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-82">82</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-83">83</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-84">84</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-85">85</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-86">86</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-87">87</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-88">88</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-89">89</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-90">90</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-91">91</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-92">92</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-93">93</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-94">94</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-95">95</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-96">96</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-97">97</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-98">98</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-99">99</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-100">100</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-101">101</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-102">102</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-103">103</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-104">104</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-105">105</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-106">106</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-107">107</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-108">108</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-109">109</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-110">110</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-111">111</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e1030574461-112">112</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-1"><span class="crayon-p"># cnn model with batch normalization for mnist</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">mean</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">std</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-4"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">plt</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-5"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">KFold</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-6"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">mnist</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-7"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-e">to_categorical</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-8"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-9"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Conv2D</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-10"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">MaxPooling2D</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-11"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-12"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Flatten</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-13"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">optimizers </span><span class="crayon-e">import </span><span class="crayon-e">SGD</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-14"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-i">BatchNormalization</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-16"><span class="crayon-p"># load train and test dataset</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-17"><span class="crayon-e">def </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-18"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-19"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mnist</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-20"><span class="crayon-h">	</span><span class="crayon-p"># reshape dataset to have a single channel</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-21"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-22"><span class="crayon-h">	</span><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-23"><span class="crayon-h">	</span><span class="crayon-p"># one hot encode target values</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-24"><span class="crayon-h">	</span><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-25"><span class="crayon-h">	</span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">testY</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-26"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">testY</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-27">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-28"><span class="crayon-p"># scale pixels</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-29"><span class="crayon-e">def </span><span class="crayon-e">prep_pixels</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-30"><span class="crayon-h">	</span><span class="crayon-p"># convert from integers to floats</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-31"><span class="crayon-h">	</span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-32"><span class="crayon-h">	</span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-33"><span class="crayon-h">	</span><span class="crayon-p"># normalize to range 0-1</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-34"><span class="crayon-h">	</span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-35"><span class="crayon-h">	</span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-36"><span class="crayon-h">	</span><span class="crayon-p"># return normalized images</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-37"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">train_norm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">_</span>norm</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-38">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-39"><span class="crayon-p"># define cnn model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-40"><span class="crayon-e">def </span><span class="crayon-e">define_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-41"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-42"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-43"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">BatchNormalization</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-44"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-45"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-46"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-47"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">BatchNormalization</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-48"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'softmax'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-49"><span class="crayon-h">	</span><span class="crayon-p"># compile model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-50"><span class="crayon-h">	</span><span class="crayon-v">opt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SGD</span><span class="crayon-sy">(</span><span class="crayon-v">learning_rate</span><span class="crayon-o">=</span><span class="crayon-cn">0.01</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">momentum</span><span class="crayon-o">=</span><span class="crayon-cn">0.9</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-51"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">opt</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'categorical_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-52"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-53">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-54"><span class="crayon-p"># evaluate a model using k-fold cross-validation</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-55"><span class="crayon-e">def </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">dataX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-56"><span class="crayon-h">	</span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">histories</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-57"><span class="crayon-h">	</span><span class="crayon-p"># prepare cross validation</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-58"><span class="crayon-h">	</span><span class="crayon-v">kfold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KFold</span><span class="crayon-sy">(</span><span class="crayon-v">n_folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-59"><span class="crayon-h">	</span><span class="crayon-p"># enumerate splits</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-60"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">train_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">test_ix </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">kfold</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">dataX</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-61"><span class="crayon-h">		</span><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-62"><span class="crayon-h">		</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-63"><span class="crayon-h">		</span><span class="crayon-p"># select rows for train and test</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-64"><span class="crayon-h">		</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataX</span><span class="crayon-sy">[</span><span class="crayon-v">train_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-sy">[</span><span class="crayon-v">train_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataX</span><span class="crayon-sy">[</span><span class="crayon-v">test_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-sy">[</span><span class="crayon-v">test_ix</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-65"><span class="crayon-h">		</span><span class="crayon-p"># fit model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-66"><span class="crayon-h">		</span><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation_data</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-67"><span class="crayon-h">		</span><span class="crayon-p"># evaluate model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-68"><span class="crayon-h">		</span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-69"><span class="crayon-h">		</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt; %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">acc *</span><span class="crayon-h"> </span><span class="crayon-cn">100.0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-70"><span class="crayon-h">		</span><span class="crayon-p"># stores scores</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-71"><span class="crayon-h">		</span><span class="crayon-v">scores</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">acc</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-72"><span class="crayon-h">		</span><span class="crayon-v">histories</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-73"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">histories</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-74">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-75"><span class="crayon-p"># plot diagnostic learning curves</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-76"><span class="crayon-e">def </span><span class="crayon-e">summarize_diagnostics</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-77"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-78"><span class="crayon-h">		</span><span class="crayon-p"># plot loss</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-79"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-80"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Cross Entropy Loss'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-81"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'loss'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'blue'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'train'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-82"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'val_loss'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'orange'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'test'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-83"><span class="crayon-h">		</span><span class="crayon-p"># plot accuracy</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-84"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-85"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Classification Accuracy'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-86"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'blue'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'train'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-87"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'val_accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'orange'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'test'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-88"><span class="crayon-h">	</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-89">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-90"><span class="crayon-p"># summarize model performance</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-91"><span class="crayon-e">def </span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-92"><span class="crayon-h">	</span><span class="crayon-p"># print summary</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-93"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Accuracy: mean=%.3f std=%.3f, n=%d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-94"><span class="crayon-h">	</span><span class="crayon-p"># box and whisker plots of results</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-95"><span class="crayon-h">	</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">boxplot</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-96"><span class="crayon-h">	</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-97">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-98"><span class="crayon-p"># run the test harness for evaluating a model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-99"><span class="crayon-e">def </span><span class="crayon-e">run_test_harness</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-100"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-101"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-102"><span class="crayon-h">	</span><span class="crayon-p"># prepare pixel data</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-103"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">prep_pixels</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-104"><span class="crayon-h">	</span><span class="crayon-p"># evaluate model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-105"><span class="crayon-h">	</span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">histories</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-106"><span class="crayon-h">	</span><span class="crayon-p"># learning curves</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-107"><span class="crayon-h">	</span><span class="crayon-e">summarize_diagnostics</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-108"><span class="crayon-h">	</span><span class="crayon-p"># summarize estimated performance</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-109"><span class="crayon-h">	</span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-110">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-111"><span class="crayon-p"># entry point, run the test harness</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e1030574461-112"><span class="crayon-e">run_test_harness</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Running the example again reports model performance for each fold of the cross-validation process.</p>
<p><strong>Note</strong>: Your <a href="https://machinelearningmastery.com/different-results-each-time-in-machine-learning/">results may vary</a> given the stochastic nature of the algorithm or evaluation procedure, or differences in numerical precision. Consider running the example a few times and compare the average outcome.</p>

<p>We can see perhaps a small drop in model performance as compared to the baseline across the cross-validation folds.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2da9e7950529380" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&gt; 98.475
&gt; 98.608
&gt; 98.683
&gt; 98.783
&gt; 98.667</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e7950529380-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e7950529380-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e7950529380-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e7950529380-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9e7950529380-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e7950529380-1">&gt; 98.475</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e7950529380-2">&gt; 98.608</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e7950529380-3">&gt; 98.683</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9e7950529380-4">&gt; 98.783</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9e7950529380-5">&gt; 98.667</div></div></td>
					</tr>
				</table>
			</div>
		</div><p>A plot of the learning curves is created, in this case showing that the speed of learning (improvement over epochs) does not appear to be different from the baseline model.</p>
<p>The plots suggest that batch normalization, at least as implemented in this case, does not offer any benefit.</p>
<div id="attachment_9973" style="width: 1290px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-9973" class="size-full wp-image-9973" src="https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-BatchNormalization-Model-During-k-Fold-Cross-Validation2.png" alt="Loss and Accuracy Learning Curves for the BatchNormalization Model During k-Fold Cross-Validation" width="1280" height="960" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-BatchNormalization-Model-During-k-Fold-Cross-Validation2.png 1280w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-BatchNormalization-Model-During-k-Fold-Cross-Validation2-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-BatchNormalization-Model-During-k-Fold-Cross-Validation2-1024x768.png 1024w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-BatchNormalization-Model-During-k-Fold-Cross-Validation2-768x576.png 768w" sizes="auto, (max-width: 1280px) 100vw, 1280px" /><p id="caption-attachment-9973" class="wp-caption-text">Loss and Accuracy Learning Curves for the BatchNormalization Model During k-Fold Cross-Validation</p></div>
<p>Next, the estimated performance of the model is presented, showing performance with a slight decrease in the mean accuracy of the model: 98.643 as compared to 98.677 with the baseline model.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2da9eb070602023" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Accuracy: mean=98.643 std=0.101, n=5</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9eb070602023-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9eb070602023-1">Accuracy: mean=98.643 std=0.101, n=5</div></div></td>
					</tr>
				</table>
			</div>
		</div><p><div id="attachment_9974" style="width: 1290px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-9974" class="size-full wp-image-9974" src="https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-BatchNormalization-Model-Evaluated-Using-k-Fold-Cross-Validation2.png" alt="Box and Whisker Plot of Accuracy Scores for the BatchNormalization Model Evaluated Using k-Fold Cross-Validation" width="1280" height="960" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-BatchNormalization-Model-Evaluated-Using-k-Fold-Cross-Validation2.png 1280w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-BatchNormalization-Model-Evaluated-Using-k-Fold-Cross-Validation2-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-BatchNormalization-Model-Evaluated-Using-k-Fold-Cross-Validation2-1024x768.png 1024w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-BatchNormalization-Model-Evaluated-Using-k-Fold-Cross-Validation2-768x576.png 768w" sizes="auto, (max-width: 1280px) 100vw, 1280px" /><p id="caption-attachment-9974" class="wp-caption-text">Box and Whisker Plot of Accuracy Scores for the BatchNormalization Model Evaluated Using k-Fold Cross-Validation</p></div></p>
<h3>Increase in Model Depth</h3>
<p>There are many ways to change the model configuration in order to explore improvements over the baseline model.</p>
<p>Two common approaches involve changing the <a href="https://machinelearningmastery.com/how-to-control-neural-network-model-capacity-with-nodes-and-layers/">capacity</a> of the feature extraction part of the model or changing the capacity or function of the classifier part of the model. Perhaps the point of biggest influence is a change to the feature extractor.</p>
<p>We can increase the depth of the feature extractor part of the model, following a <a href="https://machinelearningmastery.com/how-to-implement-major-architecture-innovations-for-convolutional-neural-networks/">VGG-like pattern</a> of adding more convolutional and pooling layers with the same sized filter, while increasing the number of filters. In this case, we will add a double convolutional layer with 64 filters each, followed by another max pooling layer.</p>
<p>The updated version of the <em>define_model()</em> function with this change is listed below.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2da9ee857301371" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# define cnn model
def define_model():
	model = Sequential()
	model.add(Conv2D(32, (3, 3), activation='relu', kernel_initializer='he_uniform', input_shape=(28, 28, 1)))
	model.add(MaxPooling2D((2, 2)))
	model.add(Conv2D(64, (3, 3), activation='relu', kernel_initializer='he_uniform'))
	model.add(Conv2D(64, (3, 3), activation='relu', kernel_initializer='he_uniform'))
	model.add(MaxPooling2D((2, 2)))
	model.add(Flatten())
	model.add(Dense(100, activation='relu', kernel_initializer='he_uniform'))
	model.add(Dense(10, activation='softmax'))
	# compile model
	opt = SGD(learning_rate=0.01, momentum=0.9)
	model.compile(optimizer=opt, loss='categorical_crossentropy', metrics=['accuracy'])
	return model</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ee857301371-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ee857301371-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ee857301371-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ee857301371-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ee857301371-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ee857301371-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ee857301371-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ee857301371-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ee857301371-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ee857301371-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ee857301371-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ee857301371-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ee857301371-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ee857301371-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9ee857301371-15">15</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ee857301371-1"><span class="crayon-p"># define cnn model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ee857301371-2"><span class="crayon-e">def </span><span class="crayon-e">define_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ee857301371-3"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ee857301371-4"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ee857301371-5"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ee857301371-6"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ee857301371-7"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ee857301371-8"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ee857301371-9"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ee857301371-10"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ee857301371-11"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'softmax'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ee857301371-12"><span class="crayon-h">	</span><span class="crayon-p"># compile model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ee857301371-13"><span class="crayon-h">	</span><span class="crayon-v">opt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SGD</span><span class="crayon-sy">(</span><span class="crayon-v">learning_rate</span><span class="crayon-o">=</span><span class="crayon-cn">0.01</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">momentum</span><span class="crayon-o">=</span><span class="crayon-cn">0.9</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9ee857301371-14"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">opt</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'categorical_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9ee857301371-15"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>For completeness, the entire code listing, including this change, is provided below.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2da9f2546329976" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# deeper cnn model for mnist
from numpy import mean
from numpy import std
from matplotlib import pyplot as plt
from sklearn.model_selection import KFold
from tensorflow.keras.datasets import mnist
from tensorflow.keras.utils import to_categorical
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Conv2D
from tensorflow.keras.layers import MaxPooling2D
from tensorflow.keras.layers import Dense
from tensorflow.keras.layers import Flatten
from tensorflow.keras.optimizers import SGD

# load train and test dataset
def load_dataset():
	# load dataset
	(trainX, trainY), (testX, testY) = mnist.load_data()
	# reshape dataset to have a single channel
	trainX = trainX.reshape((trainX.shape[0], 28, 28, 1))
	testX = testX.reshape((testX.shape[0], 28, 28, 1))
	# one hot encode target values
	trainY = to_categorical(trainY)
	testY = to_categorical(testY)
	return trainX, trainY, testX, testY

# scale pixels
def prep_pixels(train, test):
	# convert from integers to floats
	train_norm = train.astype('float32')
	test_norm = test.astype('float32')
	# normalize to range 0-1
	train_norm = train_norm / 255.0
	test_norm = test_norm / 255.0
	# return normalized images
	return train_norm, test_norm

# define cnn model
def define_model():
	model = Sequential()
	model.add(Conv2D(32, (3, 3), activation='relu', kernel_initializer='he_uniform', input_shape=(28, 28, 1)))
	model.add(MaxPooling2D((2, 2)))
	model.add(Conv2D(64, (3, 3), activation='relu', kernel_initializer='he_uniform'))
	model.add(Conv2D(64, (3, 3), activation='relu', kernel_initializer='he_uniform'))
	model.add(MaxPooling2D((2, 2)))
	model.add(Flatten())
	model.add(Dense(100, activation='relu', kernel_initializer='he_uniform'))
	model.add(Dense(10, activation='softmax'))
	# compile model
	opt = SGD(learning_rate=0.01, momentum=0.9)
	model.compile(optimizer=opt, loss='categorical_crossentropy', metrics=['accuracy'])
	return model

# evaluate a model using k-fold cross-validation
def evaluate_model(dataX, dataY, n_folds=5):
	scores, histories = list(), list()
	# prepare cross validation
	kfold = KFold(n_folds, shuffle=True, random_state=1)
	# enumerate splits
	for train_ix, test_ix in kfold.split(dataX):
		# define model
		model = define_model()
		# select rows for train and test
		trainX, trainY, testX, testY = dataX[train_ix], dataY[train_ix], dataX[test_ix], dataY[test_ix]
		# fit model
		history = model.fit(trainX, trainY, epochs=10, batch_size=32, validation_data=(testX, testY), verbose=0)
		# evaluate model
		_, acc = model.evaluate(testX, testY, verbose=0)
		print('&gt; %.3f' % (acc * 100.0))
		# stores scores
		scores.append(acc)
		histories.append(history)
	return scores, histories

# plot diagnostic learning curves
def summarize_diagnostics(histories):
	for i in range(len(histories)):
		# plot loss
		plt.subplot(2, 1, 1)
		plt.title('Cross Entropy Loss')
		plt.plot(histories[i].history['loss'], color='blue', label='train')
		plt.plot(histories[i].history['val_loss'], color='orange', label='test')
		# plot accuracy
		plt.subplot(2, 1, 2)
		plt.title('Classification Accuracy')
		plt.plot(histories[i].history['accuracy'], color='blue', label='train')
		plt.plot(histories[i].history['val_accuracy'], color='orange', label='test')
	plt.show()

# summarize model performance
def summarize_performance(scores):
	# print summary
	print('Accuracy: mean=%.3f std=%.3f, n=%d' % (mean(scores)*100, std(scores)*100, len(scores)))
	# box and whisker plots of results
	plt.boxplot(scores)
	plt.show()

# run the test harness for evaluating a model
def run_test_harness():
	# load dataset
	trainX, trainY, testX, testY = load_dataset()
	# prepare pixel data
	trainX, testX = prep_pixels(trainX, testX)
	# evaluate model
	scores, histories = evaluate_model(trainX, trainY)
	# learning curves
	summarize_diagnostics(histories)
	# summarize estimated performance
	summarize_performance(scores)

# entry point, run the test harness
run_test_harness()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-60">60</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-61">61</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-62">62</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-63">63</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-64">64</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-65">65</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-66">66</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-67">67</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-68">68</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-69">69</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-70">70</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-71">71</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-72">72</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-73">73</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-74">74</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-75">75</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-76">76</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-77">77</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-78">78</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-79">79</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-80">80</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-81">81</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-82">82</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-83">83</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-84">84</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-85">85</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-86">86</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-87">87</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-88">88</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-89">89</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-90">90</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-91">91</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-92">92</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-93">93</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-94">94</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-95">95</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-96">96</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-97">97</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-98">98</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-99">99</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-100">100</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-101">101</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-102">102</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-103">103</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-104">104</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-105">105</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-106">106</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-107">107</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-108">108</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-109">109</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-110">110</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-111">111</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9f2546329976-112">112</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-1"><span class="crayon-p"># deeper cnn model for mnist</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">mean</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">std</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-4"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">plt</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-5"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">KFold</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-6"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">mnist</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-7"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-e">to_categorical</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-8"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-9"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Conv2D</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-10"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">MaxPooling2D</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-11"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-12"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Flatten</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-13"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">optimizers </span><span class="crayon-e">import </span><span class="crayon-i">SGD</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-15"><span class="crayon-p"># load train and test dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-16"><span class="crayon-e">def </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-17"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-18"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mnist</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-19"><span class="crayon-h">	</span><span class="crayon-p"># reshape dataset to have a single channel</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-20"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-21"><span class="crayon-h">	</span><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-22"><span class="crayon-h">	</span><span class="crayon-p"># one hot encode target values</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-23"><span class="crayon-h">	</span><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-24"><span class="crayon-h">	</span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">testY</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-25"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">testY</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-26">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-27"><span class="crayon-p"># scale pixels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-28"><span class="crayon-e">def </span><span class="crayon-e">prep_pixels</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-29"><span class="crayon-h">	</span><span class="crayon-p"># convert from integers to floats</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-30"><span class="crayon-h">	</span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-31"><span class="crayon-h">	</span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-32"><span class="crayon-h">	</span><span class="crayon-p"># normalize to range 0-1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-33"><span class="crayon-h">	</span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-34"><span class="crayon-h">	</span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-35"><span class="crayon-h">	</span><span class="crayon-p"># return normalized images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-36"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">train_norm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">_</span>norm</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-37">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-38"><span class="crayon-p"># define cnn model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-39"><span class="crayon-e">def </span><span class="crayon-e">define_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-40"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-41"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-42"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-43"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-44"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-45"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-46"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-47"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-48"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'softmax'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-49"><span class="crayon-h">	</span><span class="crayon-p"># compile model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-50"><span class="crayon-h">	</span><span class="crayon-v">opt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SGD</span><span class="crayon-sy">(</span><span class="crayon-v">learning_rate</span><span class="crayon-o">=</span><span class="crayon-cn">0.01</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">momentum</span><span class="crayon-o">=</span><span class="crayon-cn">0.9</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-51"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">opt</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'categorical_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-52"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-53">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-54"><span class="crayon-p"># evaluate a model using k-fold cross-validation</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-55"><span class="crayon-e">def </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">dataX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-56"><span class="crayon-h">	</span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">histories</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-57"><span class="crayon-h">	</span><span class="crayon-p"># prepare cross validation</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-58"><span class="crayon-h">	</span><span class="crayon-v">kfold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KFold</span><span class="crayon-sy">(</span><span class="crayon-v">n_folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-59"><span class="crayon-h">	</span><span class="crayon-p"># enumerate splits</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-60"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">train_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">test_ix </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">kfold</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">dataX</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-61"><span class="crayon-h">		</span><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-62"><span class="crayon-h">		</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-63"><span class="crayon-h">		</span><span class="crayon-p"># select rows for train and test</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-64"><span class="crayon-h">		</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataX</span><span class="crayon-sy">[</span><span class="crayon-v">train_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-sy">[</span><span class="crayon-v">train_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataX</span><span class="crayon-sy">[</span><span class="crayon-v">test_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-sy">[</span><span class="crayon-v">test_ix</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-65"><span class="crayon-h">		</span><span class="crayon-p"># fit model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-66"><span class="crayon-h">		</span><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation_data</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-67"><span class="crayon-h">		</span><span class="crayon-p"># evaluate model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-68"><span class="crayon-h">		</span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-69"><span class="crayon-h">		</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt; %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">acc *</span><span class="crayon-h"> </span><span class="crayon-cn">100.0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-70"><span class="crayon-h">		</span><span class="crayon-p"># stores scores</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-71"><span class="crayon-h">		</span><span class="crayon-v">scores</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">acc</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-72"><span class="crayon-h">		</span><span class="crayon-v">histories</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-73"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">histories</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-74">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-75"><span class="crayon-p"># plot diagnostic learning curves</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-76"><span class="crayon-e">def </span><span class="crayon-e">summarize_diagnostics</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-77"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-78"><span class="crayon-h">		</span><span class="crayon-p"># plot loss</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-79"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-80"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Cross Entropy Loss'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-81"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'loss'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'blue'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'train'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-82"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'val_loss'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'orange'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'test'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-83"><span class="crayon-h">		</span><span class="crayon-p"># plot accuracy</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-84"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-85"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Classification Accuracy'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-86"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'blue'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'train'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-87"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'val_accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'orange'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'test'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-88"><span class="crayon-h">	</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-89">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-90"><span class="crayon-p"># summarize model performance</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-91"><span class="crayon-e">def </span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-92"><span class="crayon-h">	</span><span class="crayon-p"># print summary</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-93"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Accuracy: mean=%.3f std=%.3f, n=%d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-94"><span class="crayon-h">	</span><span class="crayon-p"># box and whisker plots of results</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-95"><span class="crayon-h">	</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">boxplot</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-96"><span class="crayon-h">	</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-97">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-98"><span class="crayon-p"># run the test harness for evaluating a model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-99"><span class="crayon-e">def </span><span class="crayon-e">run_test_harness</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-100"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-101"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-102"><span class="crayon-h">	</span><span class="crayon-p"># prepare pixel data</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-103"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">prep_pixels</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-104"><span class="crayon-h">	</span><span class="crayon-p"># evaluate model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-105"><span class="crayon-h">	</span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">histories</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-106"><span class="crayon-h">	</span><span class="crayon-p"># learning curves</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-107"><span class="crayon-h">	</span><span class="crayon-e">summarize_diagnostics</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-108"><span class="crayon-h">	</span><span class="crayon-p"># summarize estimated performance</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-109"><span class="crayon-h">	</span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-110">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-111"><span class="crayon-p"># entry point, run the test harness</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9f2546329976-112"><span class="crayon-e">run_test_harness</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Running the example reports model performance for each fold of the cross-validation process.</p>
<p><strong>Note</strong>: Your <a href="https://machinelearningmastery.com/different-results-each-time-in-machine-learning/">results may vary</a> given the stochastic nature of the algorithm or evaluation procedure, or differences in numerical precision. Consider running the example a few times and compare the average outcome.</p>

<p>The per-fold scores may suggest some improvement over the baseline.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2da9fe681070993" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&gt; 99.058
&gt; 99.042
&gt; 98.883
&gt; 99.192
&gt; 99.133</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9fe681070993-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9fe681070993-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9fe681070993-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2da9fe681070993-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2da9fe681070993-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9fe681070993-1">&gt; 99.058</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9fe681070993-2">&gt; 99.042</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9fe681070993-3">&gt; 98.883</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2da9fe681070993-4">&gt; 99.192</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2da9fe681070993-5">&gt; 99.133</div></div></td>
					</tr>
				</table>
			</div>
		</div><p>A plot of the learning curves is created, in this case showing that the models still have a good fit on the problem, with no clear signs of overfitting. The plots may even suggest that further training epochs could be helpful.</p>
<div id="attachment_9975" style="width: 1290px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-9975" class="size-full wp-image-9975" src="https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Deeper-Model-During-k-Fold-Cross-Validation2.png" alt="Loss and Accuracy Learning Curves for the Deeper Model During k-Fold Cross-Validation" width="1280" height="960" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Deeper-Model-During-k-Fold-Cross-Validation2.png 1280w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Deeper-Model-During-k-Fold-Cross-Validation2-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Deeper-Model-During-k-Fold-Cross-Validation2-1024x768.png 1024w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Deeper-Model-During-k-Fold-Cross-Validation2-768x576.png 768w" sizes="auto, (max-width: 1280px) 100vw, 1280px" /><p id="caption-attachment-9975" class="wp-caption-text">Loss and Accuracy Learning Curves for the Deeper Model During k-Fold Cross-Validation</p></div>
<p>Next, the estimated performance of the model is presented, showing a small improvement in performance as compared to the baseline from 98.677 to 99.062, with a small drop in the standard deviation as well.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2daa24527110565" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Accuracy: mean=99.062 std=0.104, n=5</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa24527110565-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa24527110565-1">Accuracy: mean=99.062 std=0.104, n=5</div></div></td>
					</tr>
				</table>
			</div>
		</div><p><div id="attachment_9976" style="width: 1290px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-9976" class="size-full wp-image-9976" src="https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-Deeper-Model-Evaluated-Using-k-Fold-Cross-Validation2.png" alt="Box and Whisker Plot of Accuracy Scores for the Deeper Model Evaluated Using k-Fold Cross-Validation" width="1280" height="960" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-Deeper-Model-Evaluated-Using-k-Fold-Cross-Validation2.png 1280w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-Deeper-Model-Evaluated-Using-k-Fold-Cross-Validation2-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-Deeper-Model-Evaluated-Using-k-Fold-Cross-Validation2-1024x768.png 1024w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-Deeper-Model-Evaluated-Using-k-Fold-Cross-Validation2-768x576.png 768w" sizes="auto, (max-width: 1280px) 100vw, 1280px" /><p id="caption-attachment-9976" class="wp-caption-text">Box and Whisker Plot of Accuracy Scores for the Deeper Model Evaluated Using k-Fold Cross-Validation</p></div></p>
<h2>How to Finalize the Model and Make Predictions</h2>
<p>The process of model improvement may continue for as long as we have ideas and the time and resources to test them out.</p>
<p>At some point, a final model configuration must be chosen and adopted. In this case, we will choose the deeper model as our final model.</p>
<p>First, we will finalize our model, but fitting a model on the entire training dataset and saving the model to file for later use. We will then load the model and evaluate its performance on the hold out test dataset to get an idea of how well the chosen model actually performs in practice. Finally, we will use the saved model to make a prediction on a single image.</p>
<h3>Save Final Model</h3>
<p>A final model is typically fit on all available data, such as the combination of all train and test dataset.</p>
<p>In this tutorial, we are intentionally holding back a test dataset so that we can estimate the performance of the final model, which can be a good idea in practice. As such, we will fit our model on the training dataset only.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2daa28952271251" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# fit model
model.fit(trainX, trainY, epochs=10, batch_size=32, verbose=0)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa28952271251-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa28952271251-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa28952271251-1"><span class="crayon-p"># fit model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa28952271251-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Once fit, we can save the final model to an H5 file by calling the <em>save()</em> function on the model and pass in the chosen filename.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2daa2c564408447" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# save model
model.save('final_model.h5')</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2c564408447-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2c564408447-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2c564408447-1"><span class="crayon-p"># save model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2c564408447-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">save</span><span class="crayon-sy">(</span><span class="crayon-s">'final_model.h5'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Note, saving and loading a Keras model requires that the <a href="https://www.h5py.org/">h5py library</a> is installed on your workstation.</p>
<p>The complete example of fitting the final deep model on the training dataset and saving it to file is listed below.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2daa2f352672258" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# save the final model to file
from tensorflow.keras.datasets import mnist
from tensorflow.keras.utils import to_categorical
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Conv2D
from tensorflow.keras.layers import MaxPooling2D
from tensorflow.keras.layers import Dense
from tensorflow.keras.layers import Flatten
from tensorflow.keras.optimizers import SGD

# load train and test dataset
def load_dataset():
	# load dataset
	(trainX, trainY), (testX, testY) = mnist.load_data()
	# reshape dataset to have a single channel
	trainX = trainX.reshape((trainX.shape[0], 28, 28, 1))
	testX = testX.reshape((testX.shape[0], 28, 28, 1))
	# one hot encode target values
	trainY = to_categorical(trainY)
	testY = to_categorical(testY)
	return trainX, trainY, testX, testY

# scale pixels
def prep_pixels(train, test):
	# convert from integers to floats
	train_norm = train.astype('float32')
	test_norm = test.astype('float32')
	# normalize to range 0-1
	train_norm = train_norm / 255.0
	test_norm = test_norm / 255.0
	# return normalized images
	return train_norm, test_norm

# define cnn model
def define_model():
	model = Sequential()
	model.add(Conv2D(32, (3, 3), activation='relu', kernel_initializer='he_uniform', input_shape=(28, 28, 1)))
	model.add(MaxPooling2D((2, 2)))
	model.add(Conv2D(64, (3, 3), activation='relu', kernel_initializer='he_uniform'))
	model.add(Conv2D(64, (3, 3), activation='relu', kernel_initializer='he_uniform'))
	model.add(MaxPooling2D((2, 2)))
	model.add(Flatten())
	model.add(Dense(100, activation='relu', kernel_initializer='he_uniform'))
	model.add(Dense(10, activation='softmax'))
	# compile model
	opt = SGD(learning_rate=0.01, momentum=0.9)
	model.compile(optimizer=opt, loss='categorical_crossentropy', metrics=['accuracy'])
	return model

# run the test harness for evaluating a model
def run_test_harness():
	# load dataset
	trainX, trainY, testX, testY = load_dataset()
	# prepare pixel data
	trainX, testX = prep_pixels(trainX, testX)
	# define model
	model = define_model()
	# fit model
	model.fit(trainX, trainY, epochs=10, batch_size=32, verbose=0)
	# save model
	model.save('final_model.h5')

# entry point, run the test harness
run_test_harness()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-60">60</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-61">61</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-62">62</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-63">63</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa2f352672258-64">64</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-1"><span class="crayon-p"># save the final model to file</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-2"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">mnist</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-3"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-e">to_categorical</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-4"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-5"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Conv2D</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-6"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">MaxPooling2D</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-7"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-8"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Flatten</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-9"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">optimizers </span><span class="crayon-e">import </span><span class="crayon-i">SGD</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-11"><span class="crayon-p"># load train and test dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-12"><span class="crayon-e">def </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-13"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-14"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mnist</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-15"><span class="crayon-h">	</span><span class="crayon-p"># reshape dataset to have a single channel</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-16"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-17"><span class="crayon-h">	</span><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-18"><span class="crayon-h">	</span><span class="crayon-p"># one hot encode target values</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-19"><span class="crayon-h">	</span><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-20"><span class="crayon-h">	</span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">testY</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-21"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">testY</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-22">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-23"><span class="crayon-p"># scale pixels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-24"><span class="crayon-e">def </span><span class="crayon-e">prep_pixels</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-25"><span class="crayon-h">	</span><span class="crayon-p"># convert from integers to floats</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-26"><span class="crayon-h">	</span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-27"><span class="crayon-h">	</span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-28"><span class="crayon-h">	</span><span class="crayon-p"># normalize to range 0-1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-29"><span class="crayon-h">	</span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-30"><span class="crayon-h">	</span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-31"><span class="crayon-h">	</span><span class="crayon-p"># return normalized images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-32"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">train_norm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">_</span>norm</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-34"><span class="crayon-p"># define cnn model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-35"><span class="crayon-e">def </span><span class="crayon-e">define_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-36"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-37"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-38"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-39"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-40"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-41"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-42"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-43"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-44"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'softmax'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-45"><span class="crayon-h">	</span><span class="crayon-p"># compile model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-46"><span class="crayon-h">	</span><span class="crayon-v">opt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SGD</span><span class="crayon-sy">(</span><span class="crayon-v">learning_rate</span><span class="crayon-o">=</span><span class="crayon-cn">0.01</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">momentum</span><span class="crayon-o">=</span><span class="crayon-cn">0.9</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-47"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">opt</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'categorical_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-48"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-49">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-50"><span class="crayon-p"># run the test harness for evaluating a model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-51"><span class="crayon-e">def </span><span class="crayon-e">run_test_harness</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-52"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-53"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-54"><span class="crayon-h">	</span><span class="crayon-p"># prepare pixel data</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-55"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">prep_pixels</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-56"><span class="crayon-h">	</span><span class="crayon-p"># define model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-57"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-58"><span class="crayon-h">	</span><span class="crayon-p"># fit model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-59"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-60"><span class="crayon-h">	</span><span class="crayon-p"># save model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-61"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">save</span><span class="crayon-sy">(</span><span class="crayon-s">'final_model.h5'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-62">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-63"><span class="crayon-p"># entry point, run the test harness</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa2f352672258-64"><span class="crayon-e">run_test_harness</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>After running this example, you will now have a 1.2-megabyte file with the name &#8216;<em>final_model.h5</em>&#8216; in your current working directory.</p>
<h3>Evaluate Final Model</h3>
<p>We can now load the final model and evaluate it on the hold out test dataset.</p>
<p>This is something we might do if we were interested in presenting the performance of the chosen model to project stakeholders.</p>
<p>The model can be loaded via the <em>load_model()</em> function.</p>
<p>The complete example of loading the saved model and evaluating it on the test dataset is listed below.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2daa33183629427" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# evaluate the deep model on the test dataset
from tensorflow.keras.datasets import mnist
from tensorflow.keras.models import load_model
from tensorflow.keras.utils import to_categorical

# load train and test dataset
def load_dataset():
	# load dataset
	(trainX, trainY), (testX, testY) = mnist.load_data()
	# reshape dataset to have a single channel
	trainX = trainX.reshape((trainX.shape[0], 28, 28, 1))
	testX = testX.reshape((testX.shape[0], 28, 28, 1))
	# one hot encode target values
	trainY = to_categorical(trainY)
	testY = to_categorical(testY)
	return trainX, trainY, testX, testY

# scale pixels
def prep_pixels(train, test):
	# convert from integers to floats
	train_norm = train.astype('float32')
	test_norm = test.astype('float32')
	# normalize to range 0-1
	train_norm = train_norm / 255.0
	test_norm = test_norm / 255.0
	# return normalized images
	return train_norm, test_norm

# run the test harness for evaluating a model
def run_test_harness():
	# load dataset
	trainX, trainY, testX, testY = load_dataset()
	# prepare pixel data
	trainX, testX = prep_pixels(trainX, testX)
	# load model
	model = load_model('final_model.h5')
	# evaluate model on test dataset
	_, acc = model.evaluate(testX, testY, verbose=0)
	print('&gt; %.3f' % (acc * 100.0))

# entry point, run the test harness
run_test_harness()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa33183629427-42">42</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-1"><span class="crayon-p"># evaluate the deep model on the test dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-2"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">mnist</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-3"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">load_model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-4"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-v">to</span><span class="crayon-sy">_</span>categorical</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-6"><span class="crayon-p"># load train and test dataset</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-7"><span class="crayon-e">def </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-8"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-9"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mnist</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-10"><span class="crayon-h">	</span><span class="crayon-p"># reshape dataset to have a single channel</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-11"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-12"><span class="crayon-h">	</span><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-13"><span class="crayon-h">	</span><span class="crayon-p"># one hot encode target values</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-14"><span class="crayon-h">	</span><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-15"><span class="crayon-h">	</span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">testY</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-16"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">testY</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-18"><span class="crayon-p"># scale pixels</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-19"><span class="crayon-e">def </span><span class="crayon-e">prep_pixels</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-20"><span class="crayon-h">	</span><span class="crayon-p"># convert from integers to floats</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-21"><span class="crayon-h">	</span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-22"><span class="crayon-h">	</span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-23"><span class="crayon-h">	</span><span class="crayon-p"># normalize to range 0-1</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-24"><span class="crayon-h">	</span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-25"><span class="crayon-h">	</span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-26"><span class="crayon-h">	</span><span class="crayon-p"># return normalized images</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-27"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">train_norm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">_</span>norm</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-28">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-29"><span class="crayon-p"># run the test harness for evaluating a model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-30"><span class="crayon-e">def </span><span class="crayon-e">run_test_harness</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-31"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-32"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-33"><span class="crayon-h">	</span><span class="crayon-p"># prepare pixel data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-34"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">prep_pixels</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-35"><span class="crayon-h">	</span><span class="crayon-p"># load model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-36"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_model</span><span class="crayon-sy">(</span><span class="crayon-s">'final_model.h5'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-37"><span class="crayon-h">	</span><span class="crayon-p"># evaluate model on test dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-38"><span class="crayon-h">	</span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-39"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt; %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">acc *</span><span class="crayon-h"> </span><span class="crayon-cn">100.0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-40">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-41"><span class="crayon-p"># entry point, run the test harness</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa33183629427-42"><span class="crayon-e">run_test_harness</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Running the example loads the saved model and evaluates the model on the hold out test dataset.</p>
<p><strong>Note</strong>: Your <a href="https://machinelearningmastery.com/different-results-each-time-in-machine-learning/">results may vary</a> given the stochastic nature of the algorithm or evaluation procedure, or differences in numerical precision. Consider running the example a few times and compare the average outcome.</p>

<p>The classification accuracy for the model on the test dataset is calculated and printed. In this case, we can see that the model achieved an accuracy of 99.090%, or just less than 1%, which is not bad at all and reasonably close to the estimated 99.753% with a standard deviation of about half a percent (e.g. 99% of scores).</p>
		<div id="urvanov-syntax-highlighter-6808fcc2daa3c035665360" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&gt; 99.090</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa3c035665360-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa3c035665360-1">&gt; 99.090</div></div></td>
					</tr>
				</table>
			</div>
		</div><p></p>
<h3>Make Prediction</h3>
<p>We can use our saved model to make a prediction on new images.</p>
<p>The model assumes that new images are grayscale, that they have been aligned so that one image contains one centered handwritten digit, and that the size of the image is square with the size 28&#215;28 pixels.</p>
<p>Below is an image extracted from the MNIST test dataset. You can save it in your current working directory with the filename &#8216;<em>sample_image.png</em>&#8216;.</p>
<div id="attachment_7562" style="width: 310px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-7562" class="wp-image-7562 size-medium" src="https://machinelearningmastery.com/wp-content/uploads/2019/02/sample_image-300x298.png" alt="Sample Handwritten Digit" width="300" height="298" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/02/sample_image-300x298.png 300w, https://machinelearningmastery.com/wp-content/uploads/2019/02/sample_image-150x150.png 150w, https://machinelearningmastery.com/wp-content/uploads/2019/02/sample_image-768x763.png 768w, https://machinelearningmastery.com/wp-content/uploads/2019/02/sample_image-1024x1017.png 1024w, https://machinelearningmastery.com/wp-content/uploads/2019/02/sample_image.png 1490w" sizes="auto, (max-width: 300px) 100vw, 300px" /><p id="caption-attachment-7562" class="wp-caption-text">Sample Handwritten Digit</p></div>
<ul>
<li><a href="https://machinelearningmastery.com/wp-content/uploads/2019/02/sample_image.png">Download the sample image (sample_image.png)</a></li>
</ul>
<p>We will pretend this is an entirely new and unseen image, prepared in the required way, and see how we might use our saved model to predict the integer that the image represents (e.g. we expect &#8220;<em>7</em>&#8220;).</p>
<p>First, we can load the image, force it to be in grayscale format, and force the size to be 28&#215;28 pixels. The loaded image can then be resized to have a single channel and represent a single sample in a dataset. The <em>load_image()</em> function implements this and will return the loaded image ready for classification.</p>
<p>Importantly, the pixel values are prepared in the same way as the pixel values were prepared for the training dataset when fitting the final model, in this case, normalized.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2daa46649448845" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# load and prepare the image
def load_image(filename):
	# load the image
	img = load_img(filename, grayscale=True, target_size=(28, 28))
	# convert to array
	img = img_to_array(img)
	# reshape into a single sample with 1 channel
	img = img.reshape(1, 28, 28, 1)
	# prepare pixel data
	img = img.astype('float32')
	img = img / 255.0
	return img</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa46649448845-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa46649448845-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa46649448845-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa46649448845-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa46649448845-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa46649448845-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa46649448845-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa46649448845-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa46649448845-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa46649448845-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa46649448845-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa46649448845-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa46649448845-1"><span class="crayon-p"># load and prepare the image</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa46649448845-2"><span class="crayon-e">def </span><span class="crayon-e">load_image</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa46649448845-3"><span class="crayon-h">	</span><span class="crayon-p"># load the image</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa46649448845-4"><span class="crayon-h">	</span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_img</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">grayscale</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">target_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa46649448845-5"><span class="crayon-h">	</span><span class="crayon-p"># convert to array</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa46649448845-6"><span class="crayon-h">	</span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">img_to_array</span><span class="crayon-sy">(</span><span class="crayon-v">img</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa46649448845-7"><span class="crayon-h">	</span><span class="crayon-p"># reshape into a single sample with 1 channel</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa46649448845-8"><span class="crayon-h">	</span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">img</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa46649448845-9"><span class="crayon-h">	</span><span class="crayon-p"># prepare pixel data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa46649448845-10"><span class="crayon-h">	</span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">img</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa46649448845-11"><span class="crayon-h">	</span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa46649448845-12"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">img</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Next, we can load the model as in the previous section and call the <em>predict()</em> function to get the predicted score, and then use <em>argmax()</em> to obtain the digit that the image represents.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2daa49334425427" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# predict the class
predict_value = model.predict(img)
digit = argmax(predict_value)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa49334425427-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa49334425427-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa49334425427-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa49334425427-1"><span class="crayon-p"># predict the class</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa49334425427-2"><span class="crayon-v">predict_value</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">img</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa49334425427-3"><span class="crayon-v">digit</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">argmax</span><span class="crayon-sy">(</span><span class="crayon-v">predict_value</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>The complete example is listed below.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2daa4d392979426" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# make a prediction for a new image.
from numpy import argmax
from keras.preprocessing.image import load_img
from keras.preprocessing.image import img_to_array
from keras.models import load_model

# load and prepare the image
def load_image(filename):
	# load the image
	img = load_img(filename, grayscale=True, target_size=(28, 28))
	# convert to array
	img = img_to_array(img)
	# reshape into a single sample with 1 channel
	img = img.reshape(1, 28, 28, 1)
	# prepare pixel data
	img = img.astype('float32')
	img = img / 255.0
	return img

# load an image and predict the class
def run_example():
	# load the image
	img = load_image('sample_image.png')
	# load model
	model = load_model('final_model.h5')
	# predict the class
	predict_value = model.predict(img)
	digit = argmax(predict_value)
	print(digit)

# entry point, run the example
run_example()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2daa4d392979426-32">32</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-1"><span class="crayon-p"># make a prediction for a new image.</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">argmax</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">image </span><span class="crayon-e">import </span><span class="crayon-e">load_img</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">image </span><span class="crayon-e">import </span><span class="crayon-e">img_to_array</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-v">load</span><span class="crayon-sy">_</span>model</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-7"><span class="crayon-p"># load and prepare the image</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-8"><span class="crayon-e">def </span><span class="crayon-e">load_image</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-9"><span class="crayon-h">	</span><span class="crayon-p"># load the image</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-10"><span class="crayon-h">	</span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_img</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">grayscale</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">target_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-11"><span class="crayon-h">	</span><span class="crayon-p"># convert to array</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-12"><span class="crayon-h">	</span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">img_to_array</span><span class="crayon-sy">(</span><span class="crayon-v">img</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-13"><span class="crayon-h">	</span><span class="crayon-p"># reshape into a single sample with 1 channel</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-14"><span class="crayon-h">	</span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">img</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-15"><span class="crayon-h">	</span><span class="crayon-p"># prepare pixel data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-16"><span class="crayon-h">	</span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">img</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-17"><span class="crayon-h">	</span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-18"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">img</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-20"><span class="crayon-p"># load an image and predict the class</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-21"><span class="crayon-e">def </span><span class="crayon-e">run_example</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-22"><span class="crayon-h">	</span><span class="crayon-p"># load the image</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-23"><span class="crayon-h">	</span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_image</span><span class="crayon-sy">(</span><span class="crayon-s">'sample_image.png'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-24"><span class="crayon-h">	</span><span class="crayon-p"># load model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-25"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_model</span><span class="crayon-sy">(</span><span class="crayon-s">'final_model.h5'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-26"><span class="crayon-h">	</span><span class="crayon-p"># predict the class</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-27"><span class="crayon-h">	</span><span class="crayon-v">predict_value</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">img</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-28"><span class="crayon-h">	</span><span class="crayon-v">digit</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">argmax</span><span class="crayon-sy">(</span><span class="crayon-v">predict_value</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-29"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">digit</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-30">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-31"><span class="crayon-p"># entry point, run the example</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2daa4d392979426-32"><span class="crayon-e">run_example</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Running the example first loads and prepares the image, loads the model, and then correctly predicts that the loaded image represents the digit &#8216;<em>7</em>&#8216;.</p>
		<div id="urvanov-syntax-highlighter-6808fcc2daa50651620854" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
7</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2daa50651620854-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2daa50651620854-1">7</div></div></td>
					</tr>
				</table>
			</div>
		</div><p></p>
<h2>Extensions</h2>
<p>This section lists some ideas for extending the tutorial that you may wish to explore.</p>
<ul>
<li><strong>Tune Pixel Scaling</strong>. Explore how alternate pixel scaling methods impact model performance as compared to the baseline model, including centering and standardization.</li>
<li><strong>Tune the Learning Rate</strong>. Explore how different learning rates impact the model performance as compared to the baseline model, such as 0.001 and 0.0001.</li>
<li><strong>Tune Model Depth</strong>. Explore how adding more layers to the model impact the model performance as compared to the baseline model, such as another block of convolutional and pooling layers or another dense layer in the classifier part of the model.</li>
</ul>
<p>If you explore any of these extensions, I&#8217;d love to know.<br />
Post your findings in the comments below.</p>
<h2>Further Reading</h2>
<p>This section provides more resources on the topic if you are looking to go deeper.</p>
<h3>APIs</h3>
<ul>
<li><a href="https://keras.io/datasets/">Keras Datasets API</a></li>
<li><a href="https://github.com/keras-team/keras/tree/master/keras/datasets">Keras Datasets Code</a></li>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html">sklearn.model_selection.KFold API</a></li>
</ul>
<h3>Articles</h3>
<ul>
<li><a href="https://en.wikipedia.org/wiki/MNIST_database">MNIST database, Wikipedia.</a></li>
<li><a href="http://rodrigob.github.io/are_we_there_yet/build/classification_datasets_results.html">Classification datasets results, What is the class of this image?</a></li>
</ul>
<h2>Summary</h2>
<p>In this tutorial, you discovered how to develop a convolutional neural network for handwritten digit classification from scratch.</p>
<p>Specifically, you learned:</p>
<ul>
<li>How to develop a test harness to develop a robust evaluation of a model and establish a baseline of performance for a classification task.</li>
<li>How to explore extensions to a baseline model to improve learning and model capacity.</li>
<li>How to develop a finalized model, evaluate the performance of the final model, and use it to make predictions on new images.</li>
</ul>
<p>Do you have any questions?<br />
Ask your questions in the comments below and I will do my best to answer.</p>
<div class="widget_text awac-wrapper" id="custom_html-65"><div class="widget_text awac widget custom_html-65"><div class="textwidget custom-html-widget"><div style="text-align: center;">
<div class="woo-sc-hr"></div>
<h2>Develop Deep Learning Models for Vision Today!</h2>
<a href="/deep-learning-for-computer-vision/"><img decoding="async" style="border: 0;" src="/wp-content/uploads/2022/11/DL4CV-220.png" alt="Deep Learning for Computer Vision" align="left" /></a>
<h4>Develop Your Own Vision Models in Minutes</h4>
<p>...with just a few lines of python code</p>

<p>Discover how in my new Ebook:<br>
<a href="/deep-learning-for-computer-vision/" rel="nofollow">Deep Learning for Computer Vision</a></p>

<p>It provides <strong>self-study tutorials</strong> on topics like:<br>
	<em>classification</em>, <em>object detection (yolo and rcnn)</em>, <em>face recognition (vggface and facenet)</em>, <em>data preparation</em> and much more...</p>

<h4>Finally Bring Deep Learning to your Vision Projects</h4>
	<p>Skip the Academics. Just Results.</p>

<p><a href="/deep-learning-for-computer-vision/" class="woo-sc-button  red" ><span class="woo-">See What's Inside</span></a></p>

<div class="woo-sc-hr"></div>
</div></div></div></div></p><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-7553 post  simplesocialbuttons-inline-no-animation">
		<button class="ssb_fbshare-icon"  rel="nofollow"  target="_blank"  aria-label="Facebook Share" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/" onClick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="_1pbq" color="#ffffff"><path fill="#ffffff" fill-rule="evenodd" class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path></svg></span>
						<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_tweet-icon"  rel="nofollow"  target="_blank"  aria-label="Twitter Share" data-href="https://twitter.com/intent/tweet?text=How+to+Develop+a+CNN+for+MNIST+Handwritten+Digit+Classification&url=https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/" onClick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
						<span class="icon"><svg viewBox="0 0 16 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.9 0H0L5.782 7.7098L0.315 14H2.17L6.6416 8.8557L10.5 14H15.4L9.3744 5.9654L14.56 0H12.705L8.5148 4.8202L4.9 0ZM11.2 12.6L2.8 1.4H4.2L12.6 12.6H11.2Z" fill="#fff"/></svg></span><i class="simplesocialtxt">Post </i></button>
<button class="ssb_linkedin-icon"  rel="nofollow"  target="_blank"  aria-label="LinkedIn Share" data-href="https://www.linkedin.com/sharing/share-offsite/?url=https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/" onClick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" >
						<span class="icon"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="14.1px" viewBox="-301.4 387.5 15 14.1" enable-background="new -301.4 387.5 15 14.1" xml:space="preserve"> <g id="XMLID_398_"> <path id="XMLID_399_" fill="#FFFFFF" d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z"/> <path id="XMLID_400_" fill="#FFFFFF" d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z"/> <path id="XMLID_401_" fill="#FFFFFF" d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z"/> </g> </svg> </span>
						<span class="simplesocialtxt">Share</span> </button>
</div>
<div class="crp_related     crp-grid"><h3>More On This Topic</h3><ul><li><a href="https://machinelearningmastery.com/how-to-develop-a-generative-adversarial-network-for-an-mnist-handwritten-digits-from-scratch-in-keras/"     class="crp_link post-8099"><figure><img width="200" height="150" src="https://machinelearningmastery.com/wp-content/uploads/2019/04/Plot-of-100-GAN-Generated-MNIST-Figures-After-100-Epochs.png" class="crp_featured crp_thumb crp_thumbnail" alt="Plot of 100 GAN Generated MNIST Figures After 100 Epochs" style="" title="How to Develop a GAN for Generating MNIST Handwritten Digits" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/04/Plot-of-100-GAN-Generated-MNIST-Figures-After-100-Epochs.png 640w, https://machinelearningmastery.com/wp-content/uploads/2019/04/Plot-of-100-GAN-Generated-MNIST-Figures-After-100-Epochs-300x225.png 300w" sizes="(max-width: 200px) 100vw, 200px" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/04/Plot-of-100-GAN-Generated-MNIST-Figures-After-100-Epochs.png 640w, https://machinelearningmastery.com/wp-content/uploads/2019/04/Plot-of-100-GAN-Generated-MNIST-Figures-After-100-Epochs-300x225.png 300w" /></figure><span class="crp_title">How to Develop a GAN for Generating MNIST Handwritten Digits</span></a></li><li><a href="https://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/"     class="crp_link post-2585"><figure><img width="200" height="151" src="https://machinelearningmastery.com/wp-content/uploads/2016/05/Examples-from-the-MNIST-dataset.png" class="crp_featured crp_thumb crp_thumbnail" alt="Examples from the MNIST dataset" style="" title="Handwritten Digit Recognition Using Convolutional Neural Networks in Python with Keras" srcset="https://machinelearningmastery.com/wp-content/uploads/2016/05/Examples-from-the-MNIST-dataset.png 812w, https://machinelearningmastery.com/wp-content/uploads/2016/05/Examples-from-the-MNIST-dataset-300x226.png 300w, https://machinelearningmastery.com/wp-content/uploads/2016/05/Examples-from-the-MNIST-dataset-768x579.png 768w" sizes="(max-width: 200px) 100vw, 200px" srcset="https://machinelearningmastery.com/wp-content/uploads/2016/05/Examples-from-the-MNIST-dataset.png 812w, https://machinelearningmastery.com/wp-content/uploads/2016/05/Examples-from-the-MNIST-dataset-300x226.png 300w, https://machinelearningmastery.com/wp-content/uploads/2016/05/Examples-from-the-MNIST-dataset-768x579.png 768w" /></figure><span class="crp_title">Handwritten Digit Recognition Using Convolutional&hellip;</span></a></li><li><a href="https://machinelearningmastery.com/handwritten-digit-recognition-with-lenet5-model-in-pytorch/"     class="crp_link post-14702"><figure><img width="150" height="150" src="https://machinelearningmastery.com/wp-content/uploads/2023/02/johnny-wong-la0WP7U3-AM-unsplash-150x150.jpg" class="crp_featured crp_thumb crp_thumbnail" alt="johnny-wong-la0WP7U3-AM-unsplash" style="" title="Handwritten Digit Recognition with LeNet5 Model in PyTorch" /></figure><span class="crp_title">Handwritten Digit Recognition with LeNet5 Model in PyTorch</span></a></li><li><a href="https://machinelearningmastery.com/how-to-develop-a-cnn-from-scratch-for-fashion-mnist-clothing-classification/"     class="crp_link post-7565"><figure><img width="200" height="150" src="https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Baseline-Model-on-the-Fashion-MNIST-Dataset-During-k-Fold-Cross-Validation.png" class="crp_featured crp_thumb crp_thumbnail" alt="Loss-and-Accuracy-Learning-Curves-for-the-Baseline-Model-on-the-Fashion-MNIST-Dataset-During-k-Fold-Cross-Validation" style="" title="Deep Learning CNN for Fashion-MNIST Clothing Classification" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Baseline-Model-on-the-Fashion-MNIST-Dataset-During-k-Fold-Cross-Validation.png 1280w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Baseline-Model-on-the-Fashion-MNIST-Dataset-During-k-Fold-Cross-Validation-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Baseline-Model-on-the-Fashion-MNIST-Dataset-During-k-Fold-Cross-Validation-768x576.png 768w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Baseline-Model-on-the-Fashion-MNIST-Dataset-During-k-Fold-Cross-Validation-1024x768.png 1024w" sizes="(max-width: 200px) 100vw, 200px" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Baseline-Model-on-the-Fashion-MNIST-Dataset-During-k-Fold-Cross-Validation.png 1280w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Baseline-Model-on-the-Fashion-MNIST-Dataset-During-k-Fold-Cross-Validation-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Baseline-Model-on-the-Fashion-MNIST-Dataset-During-k-Fold-Cross-Validation-768x576.png 768w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Baseline-Model-on-the-Fashion-MNIST-Dataset-During-k-Fold-Cross-Validation-1024x768.png 1024w" /></figure><span class="crp_title">Deep Learning CNN for Fashion-MNIST Clothing Classification</span></a></li><li><a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/"     class="crp_link post-4586"><figure><img width="200" height="121" src="https://machinelearningmastery.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text.png" class="crp_featured crp_thumb crp_thumbnail" alt="Plot of the Multichannel Convolutional Neural Network For Text" style="" title="How to Develop a Multichannel CNN Model for Text Classification" srcset="https://machinelearningmastery.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text.png 1579w, https://machinelearningmastery.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text-300x182.png 300w, https://machinelearningmastery.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text-768x466.png 768w, https://machinelearningmastery.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text-1024x622.png 1024w" sizes="(max-width: 200px) 100vw, 200px" srcset="https://machinelearningmastery.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text.png 1579w, https://machinelearningmastery.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text-300x182.png 300w, https://machinelearningmastery.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text-768x466.png 768w, https://machinelearningmastery.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text-1024x622.png 1024w" /></figure><span class="crp_title">How to Develop a Multichannel CNN Model for Text&hellip;</span></a></li><li><a href="https://machinelearningmastery.com/how-to-develop-a-cnn-from-scratch-for-cifar-10-photo-classification/"     class="crp_link post-7576"><figure><img width="200" height="150" src="https://machinelearningmastery.com/wp-content/uploads/2019/02/Line-Plots-of-Learning-Curves-for-Baseline-Model-With-Increasing-Dropout-Data-Augmentation-and-Batch-Normalization-on-the-CIFAR-10-Dataset.png" class="crp_featured crp_thumb crp_thumbnail" alt="Line Plots of Learning Curves for Baseline Model With Increasing Dropout, Data Augmentation, and Batch Normalization on the CIFAR-10 Dataset" style="" title="How to Develop a CNN From Scratch for CIFAR-10 Photo Classification" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/02/Line-Plots-of-Learning-Curves-for-Baseline-Model-With-Increasing-Dropout-Data-Augmentation-and-Batch-Normalization-on-the-CIFAR-10-Dataset.png 640w, https://machinelearningmastery.com/wp-content/uploads/2019/02/Line-Plots-of-Learning-Curves-for-Baseline-Model-With-Increasing-Dropout-Data-Augmentation-and-Batch-Normalization-on-the-CIFAR-10-Dataset-300x225.png 300w" sizes="(max-width: 200px) 100vw, 200px" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/02/Line-Plots-of-Learning-Curves-for-Baseline-Model-With-Increasing-Dropout-Data-Augmentation-and-Batch-Normalization-on-the-CIFAR-10-Dataset.png 640w, https://machinelearningmastery.com/wp-content/uploads/2019/02/Line-Plots-of-Learning-Curves-for-Baseline-Model-With-Increasing-Dropout-Data-Augmentation-and-Batch-Normalization-on-the-CIFAR-10-Dataset-300x225.png 300w" /></figure><span class="crp_title">How to Develop a CNN From Scratch for CIFAR-10 Photo&hellip;</span></a></li></ul><div class="crp_clear"></div></div>	</section><!-- /.entry -->
	<div class="fix"></div>
	<aside id="post-author">
	<div class="profile-image"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=160&#038;d=mm&#038;r=g 2x' class='avatar avatar-80 photo' height='80' width='80' loading='lazy' decoding='async'/></div>
	<div class="profile-content">
		<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
			<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">&rarr;</span>			</a>
		</div><!--#profile-link-->
			</div>
	<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
	        <div class="post-entries">
	            <div class="nav-prev fl"><a href="https://machinelearningmastery.com/how-to-visualize-filters-and-feature-maps-in-convolutional-neural-networks/" rel="prev"><i class="fa fa-angle-left"></i> How to Visualize Filters and Feature Maps in Convolutional Neural Networks</a></div>
	            <div class="nav-next fr"><a href="https://machinelearningmastery.com/how-to-develop-a-cnn-from-scratch-for-fashion-mnist-clothing-classification/" rel="next">Deep Learning CNN for Fashion-MNIST Clothing Classification <i class="fa fa-angle-right"></i></a></div>
	            <div class="fix"></div>
	        </div>

		<div id="comments">		 	<h3 id="comments-title">193 Responses to <em>How to Develop a CNN for MNIST Handwritten Digit Classification</em></h3>
		 	<ol class="commentlist">
				
		<li id="comment-484707" class="comment even thread-even depth-1">

	      	<div id="li-comment-484707" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d9b9d24558e7a09413c73a8bde4cd99196c5dcaae4aeae836f86b12fe1162a66?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d9b9d24558e7a09413c73a8bde4cd99196c5dcaae4aeae836f86b12fe1162a66?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">SHAHEEN ALHIRMIZY</span>
	                <span class="date">May 10, 2019 at 4:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-484707" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason Thank You Very Much For your wonderful Tutorial Please can you build for us A model  for Edge detection from scratch using real images.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-484707" data-commentid="484707" data-postid="7553" data-belowelement="comment-484707" data-respondelement="respond" data-replyto="Reply to SHAHEEN ALHIRMIZY" aria-label="Reply to SHAHEEN ALHIRMIZY">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-484803" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-484803" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">May 11, 2019 at 6:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-484803" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great suggestion, thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-484803" data-commentid="484803" data-postid="7553" data-belowelement="comment-484803" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-484709" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-484709" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d9b9d24558e7a09413c73a8bde4cd99196c5dcaae4aeae836f86b12fe1162a66?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d9b9d24558e7a09413c73a8bde4cd99196c5dcaae4aeae836f86b12fe1162a66?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">SHAHEEN ALHIRMIZY</span>
	                <span class="date">May 10, 2019 at 4:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-484709" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have two questions :</p>
<p>first suppose I have images sizes equal to 7611 x  7811 how to deal with this big size images in CNN models.</p>
<p>second question about if our images different sizes not same size.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-484709" data-commentid="484709" data-postid="7553" data-belowelement="comment-484709" data-respondelement="respond" data-replyto="Reply to SHAHEEN ALHIRMIZY" aria-label="Reply to SHAHEEN ALHIRMIZY">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-484804" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-484804" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">May 11, 2019 at 6:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-484804" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I recommend reducing the size of your images first, before modeling, e.g. less than 1000 pixels, even less than 500 pixels if you can.</p>
<p>I then recommend normalizing images to the same size.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-484804" data-commentid="484804" data-postid="7553" data-belowelement="comment-484804" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-503450" class="comment even depth-3">

	      	<div id="li-comment-503450" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/53aa49feb18b6f35fa67d999bcebda15a36df69c065d00204e114fff19402105?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/53aa49feb18b6f35fa67d999bcebda15a36df69c065d00204e114fff19402105?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">vinay</span>
	                <span class="date">September 30, 2019 at 11:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-503450" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>to reduce the size of the images, which approach is better. Using machine learning or normal image compression methods.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-503450" data-commentid="503450" data-postid="7553" data-belowelement="comment-503450" data-respondelement="respond" data-replyto="Reply to vinay" aria-label="Reply to vinay">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-503465" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-503465" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">September 30, 2019 at 2:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-503465" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Use image compression algorithms.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-503465" data-commentid="503465" data-postid="7553" data-belowelement="comment-503465" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-484882" class="comment even thread-even depth-1">

	      	<div id="li-comment-484882" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d9b9d24558e7a09413c73a8bde4cd99196c5dcaae4aeae836f86b12fe1162a66?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d9b9d24558e7a09413c73a8bde4cd99196c5dcaae4aeae836f86b12fe1162a66?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">SHAHEEN ALHIRMIZY</span>
	                <span class="date">May 11, 2019 at 4:13 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-484882" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>when we reducing the size of images that means losing many fine details from these images</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-484882" data-commentid="484882" data-postid="7553" data-belowelement="comment-484882" data-respondelement="respond" data-replyto="Reply to SHAHEEN ALHIRMIZY" aria-label="Reply to SHAHEEN ALHIRMIZY">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-484967" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-484967" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">May 12, 2019 at 6:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-484967" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Often it does.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-484967" data-commentid="484967" data-postid="7553" data-belowelement="comment-484967" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-505377" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-505377" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/6a96e99bfd8f11a51397d6843509e87601eceea74d5a0e2b321aaf507232aff0?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6a96e99bfd8f11a51397d6843509e87601eceea74d5a0e2b321aaf507232aff0?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Taranpreetkaur</span>
	                <span class="date">October 12, 2019 at 10:57 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-505377" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>How u make this project please help us &#8230; We can&#8217;t understand how we make this project &#8230; Taranpreetkaur</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-505377" data-commentid="505377" data-postid="7553" data-belowelement="comment-505377" data-respondelement="respond" data-replyto="Reply to Taranpreetkaur" aria-label="Reply to Taranpreetkaur">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-505449" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-505449" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">October 13, 2019 at 8:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-505449" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What problem are you having exactly?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-505449" data-commentid="505449" data-postid="7553" data-belowelement="comment-505449" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-506362" class="comment even thread-even depth-1">

	      	<div id="li-comment-506362" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9d74551f651476c5c4214ce435e035118bd45d343b3767fa97f7c3cec806b3de?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9d74551f651476c5c4214ce435e035118bd45d343b3767fa97f7c3cec806b3de?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ajoy</span>
	                <span class="date">October 20, 2019 at 4:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-506362" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Original error was: No module named _multiarray_umath, keras .imageprocessing<br />
Importing the numpy c-extensions failed.</p>
<p>Any ideas please</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-506362" data-commentid="506362" data-postid="7553" data-belowelement="comment-506362" data-respondelement="respond" data-replyto="Reply to Ajoy" aria-label="Reply to Ajoy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-506395" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-506395" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">October 20, 2019 at 6:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-506395" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry to hear that.</p>
<p>Perhaps try checking that your version of Keras and TensorFlow are up to date?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-506395" data-commentid="506395" data-postid="7553" data-belowelement="comment-506395" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-506470" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-506470" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9d74551f651476c5c4214ce435e035118bd45d343b3767fa97f7c3cec806b3de?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9d74551f651476c5c4214ce435e035118bd45d343b3767fa97f7c3cec806b3de?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ajoy</span>
	                <span class="date">October 20, 2019 at 7:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-506470" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry dont worry, I somehow got to resolve it. I think I reinstalled stuff.<br />
I have another problem though. How do I add data for learning if in case the data predicted the wrong valiue pelase. I think I need the advise for both how to add as well as how to add the data in the mnist data format. Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-506470" data-commentid="506470" data-postid="7553" data-belowelement="comment-506470" data-respondelement="respond" data-replyto="Reply to Ajoy" aria-label="Reply to Ajoy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-506571" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-506571" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">October 21, 2019 at 6:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-506571" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Happy to hear that.</p>
<p>Perhaps you can refit your model as you get access to new data?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-506571" data-commentid="506571" data-postid="7553" data-belowelement="comment-506571" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-506475" class="comment even thread-even depth-1">

	      	<div id="li-comment-506475" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9d74551f651476c5c4214ce435e035118bd45d343b3767fa97f7c3cec806b3de?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9d74551f651476c5c4214ce435e035118bd45d343b3767fa97f7c3cec806b3de?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ajoy</span>
	                <span class="date">October 20, 2019 at 7:51 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-506475" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason you know what, for &#8220;17&#8221; it returned &#8220;7&#8221;. Thats actually good, but if you could please tip me as to how can I turn this into &#8220;Awesome.&#8221; Can I divide the pixel data into 2 dividions based on whitespace or what would be the best way please to recognize &#8220;17&#8221;. Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-506475" data-commentid="506475" data-postid="7553" data-belowelement="comment-506475" data-respondelement="respond" data-replyto="Reply to Ajoy" aria-label="Reply to Ajoy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-506572" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-506572" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">October 21, 2019 at 6:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-506572" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I believe the model supports one character at a time, try splitting multiple characters up into single character input.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-506572" data-commentid="506572" data-postid="7553" data-belowelement="comment-506572" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-512501" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-512501" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/7891949f4b8a6444f050b3d84ac871a2b7a49f5b8d617223bd26007091ca0ba2?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7891949f4b8a6444f050b3d84ac871a2b7a49f5b8d617223bd26007091ca0ba2?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jubayed</span>
	                <span class="date">November 26, 2019 at 10:13 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-512501" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great!! I enjoyed very well.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-512501" data-commentid="512501" data-postid="7553" data-belowelement="comment-512501" data-respondelement="respond" data-replyto="Reply to Jubayed" aria-label="Reply to Jubayed">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-512558" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-512558" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">November 27, 2019 at 6:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-512558" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-512558" data-commentid="512558" data-postid="7553" data-belowelement="comment-512558" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-512535" class="comment even thread-even depth-1">

	      	<div id="li-comment-512535" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/79b90ecefc271494275b68a45e546796b09500a0b37476f479e399e922fe4db1?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/79b90ecefc271494275b68a45e546796b09500a0b37476f479e399e922fe4db1?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Victor Johns</span>
	                <span class="date">November 27, 2019 at 3:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-512535" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason,<br />
Thanks much for this tutorial. I had a question on the structure of the CNN. In this (and other descriptions of this problem for the MNIST digit data set) a common structure seems to be that the number of CNN filters is 32. Where each filter is a 5&#215;5 of stride 1. However (and I apologize if this is explained somewhere) I cannot seem to find why 32 filters are chosen. i.e. Why not 16 or 64 ( or 14 or 28). Is it possible to explain why this is so. </p>
<p>Regards<br />
Victor</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-512535" data-commentid="512535" data-postid="7553" data-belowelement="comment-512535" data-respondelement="respond" data-replyto="Reply to Victor Johns" aria-label="Reply to Victor Johns">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-512571" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-512571" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">November 27, 2019 at 6:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-512571" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It is arbitrary.</p>
<p>Try different numbers of filters and compare the results.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-512571" data-commentid="512571" data-postid="7553" data-belowelement="comment-512571" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-514552" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-514552" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a748bbba11e56b313b6e2abfcc5e511008b84b9331633257a312bc4d35381e96?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a748bbba11e56b313b6e2abfcc5e511008b84b9331633257a312bc4d35381e96?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Samuel</span>
	                <span class="date">December 11, 2019 at 8:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-514552" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason,<br />
Thank you for the detailed explanation of this. I wanted to run your code and follow along to see how it worked. When I tried to run the complete example for the baseline cnn model for mnist, I get the following error:</p>
<p>KeyError                                  Traceback (most recent call last)<br />
 in<br />
    107<br />
    108 # entry point, run the test harness<br />
&#8211;&gt; 109 run_test_harness()</p>
<p> in run_test_harness()<br />
    102         scores, histories = evaluate_model(model, trainX, trainY)<br />
    103         # learning curves<br />
&#8211;&gt; 104         summarize_diagnostics(histories)<br />
    105         # summarize estimated performance<br />
    106         summarize_performance(scores)</p>
<p> in summarize_diagnostics(histories)<br />
     79                 pyplot.subplot(212)<br />
     80                 pyplot.title(&#8216;Classification Accuracy&#8217;)<br />
&#8212;&gt; 81                 pyplot.plot(histories[i].history[&#8216;acc&#8217;], color=&#8217;blue&#8217;, label=&#8217;train&#8217;)<br />
     82                 pyplot.plot(histories[i].history[&#8216;val_acc&#8217;], color=&#8217;orange&#8217;, label=&#8217;test&#8217;)<br />
     83         pyplot.show()</p>
<p>KeyError: &#8216;acc&#8217;</p>
<p>Any ideas what it means?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-514552" data-commentid="514552" data-postid="7553" data-belowelement="comment-514552" data-respondelement="respond" data-replyto="Reply to Samuel" aria-label="Reply to Samuel">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-514569" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-514569" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">December 11, 2019 at 1:41 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-514569" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, the API has changed. </p>
<p>I have updated the example. </p>
<p>Thanks for letting me know!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-514569" data-commentid="514569" data-postid="7553" data-belowelement="comment-514569" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-514639" class="comment even thread-even depth-1">

	      	<div id="li-comment-514639" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/bacee26ff932213a9154a657cb1f6ee03e2626500f9616ac5558646c1d6803e8?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/bacee26ff932213a9154a657cb1f6ee03e2626500f9616ac5558646c1d6803e8?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Xenon</span>
	                <span class="date">December 12, 2019 at 5:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-514639" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>please how can i Train a simple convolutional network for number recognition (MNIST). Thanks. that&#8217;s what i want to see.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-514639" data-commentid="514639" data-postid="7553" data-belowelement="comment-514639" data-respondelement="respond" data-replyto="Reply to Xenon" aria-label="Reply to Xenon">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-514675" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-514675" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">December 12, 2019 at 6:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-514675" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>See the above tutorial for an example.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-514675" data-commentid="514675" data-postid="7553" data-belowelement="comment-514675" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-516125" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-516125" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/74af0a942f348afec386fc17d994175b1246801baf766982d25d6686779758b9?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/74af0a942f348afec386fc17d994175b1246801baf766982d25d6686779758b9?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vivek</span>
	                <span class="date">December 23, 2019 at 10:30 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-516125" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I want to create a image exactly same as mnist using mspaint for example and test it using the mnist evaluation model using predict_classes API.</p>
<p>Is it possible without using python API.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-516125" data-commentid="516125" data-postid="7553" data-belowelement="comment-516125" data-respondelement="respond" data-replyto="Reply to Vivek" aria-label="Reply to Vivek">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-516165" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-516165" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">December 24, 2019 at 6:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-516165" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don&#8217;t see why not.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-516165" data-commentid="516165" data-postid="7553" data-belowelement="comment-516165" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-516428" class="comment even thread-even depth-1">

	      	<div id="li-comment-516428" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d1d640e403781cc48b55ea7d2b260495a7d1352387eb45dea3b588d714bb68f6?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d1d640e403781cc48b55ea7d2b260495a7d1352387eb45dea3b588d714bb68f6?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alexander Soare</span>
	                <span class="date">December 27, 2019 at 8:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-516428" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br />
Thanks for the excellent tutorial! I have two questions about K-fold cross-validation. In your &#8220;gentle introduction&#8221; article you say that the model is discarded each time we switch the hold out set. So here are my questions</p>
<p>1) Here it looks like you don&#8217;t discard the model between iterations of the k-fold cross validation. Why?</p>
<p>2) The model&#8217;s accuracy gets better each time you do an iteration. Why is taking a simple average fair then? To take it to the extreme: What if you only trained on 1 epoch? Then you&#8217;d get 94% on your first fold, then 98.5% on your second fold. And so on, yielding a much poorer average and a huge standard deviation. On the back of this question, I&#8217;d also ask why the standard deviation is a fair representation of the model under these circumstances.</p>
<p>Thanks again for the great material!<br />
Alex</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-516428" data-commentid="516428" data-postid="7553" data-belowelement="comment-516428" data-respondelement="respond" data-replyto="Reply to Alexander Soare" aria-label="Reply to Alexander Soare">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-516482" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-516482" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">December 28, 2019 at 7:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-516482" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome.</p>
<p>That looks like an error. I will update the tutorial.</p>
<p>Thanks for point it out!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-516482" data-commentid="516482" data-postid="7553" data-belowelement="comment-516482" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-516554" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-516554" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d1d640e403781cc48b55ea7d2b260495a7d1352387eb45dea3b588d714bb68f6?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d1d640e403781cc48b55ea7d2b260495a7d1352387eb45dea3b588d714bb68f6?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alexander Soare</span>
	                <span class="date">December 29, 2019 at 5:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-516554" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for picking up my previous question Jason. I have another. You say at some point that there are no clear signs of overfitting. But it looks like the orange lines for the validation accuracy are staying relatively low compared to the blue lines for the testing accuracy. Is this not an indicator of overfitting? Or am I misinterpreting the charts?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-516554" data-commentid="516554" data-postid="7553" data-belowelement="comment-516554" data-respondelement="respond" data-replyto="Reply to Alexander Soare" aria-label="Reply to Alexander Soare">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-516571" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-516571" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">December 29, 2019 at 6:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-516571" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Excellent question Alexander.</p>
<p>They are close enough that I would not classify it as overfitting, instead it is a good fit:<br />
<a href="https://machinelearningmastery.com/learning-curves-for-diagnosing-machine-learning-model-performance/" rel="ugc">https://machinelearningmastery.com/learning-curves-for-diagnosing-machine-learning-model-performance/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-516571" data-commentid="516571" data-postid="7553" data-belowelement="comment-516571" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-516986" class="comment even thread-even depth-1">

	      	<div id="li-comment-516986" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/44bfbfd04d284be2486b16be1b019e2a8ea043d9723b24111e686916d380c090?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/44bfbfd04d284be2486b16be1b019e2a8ea043d9723b24111e686916d380c090?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anja</span>
	                <span class="date">January 3, 2020 at 3:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-516986" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>When I execute the final code I get following error: &#8220;AttributeError: module &#8216;tensorflow&#8217; has no attribute &#8216;get_default_graph&#8221;. I have installed Tensorflow 2.0, will downgrading it to the previous version solve this problem?</p>
<p>Thank you for your time and this amazing post!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-516986" data-commentid="516986" data-postid="7553" data-belowelement="comment-516986" data-respondelement="respond" data-replyto="Reply to Anja" aria-label="Reply to Anja">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-517043" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-517043" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">January 4, 2020 at 8:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-517043" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Confirm you have Keras 2.3 and Tensorflow 2.0 installed.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-517043" data-commentid="517043" data-postid="7553" data-belowelement="comment-517043" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-517227" class="comment even depth-3">

	      	<div id="li-comment-517227" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/44bfbfd04d284be2486b16be1b019e2a8ea043d9723b24111e686916d380c090?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/44bfbfd04d284be2486b16be1b019e2a8ea043d9723b24111e686916d380c090?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anja</span>
	                <span class="date">January 6, 2020 at 12:51 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-517227" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>I have Tensorflow 2.0 and Keras 2.2.4. I tried updating Keras to 2.3 but can not find the way on Windows 10. I tried also switching to Linux on VB but I have a hard time with permissions there. Do you have any advice for me, I would be really grateful?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-517227" data-commentid="517227" data-postid="7553" data-belowelement="comment-517227" data-respondelement="respond" data-replyto="Reply to Anja" aria-label="Reply to Anja">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-517231" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-517231" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">January 6, 2020 at 1:31 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-517231" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can try:</p>
<p></p>
		<div id="urvanov-syntax-highlighter-6808fcc2e2ea5343181056" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
pip install keras</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2e2ea5343181056-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2e2ea5343181056-1"><span class="crayon-e">pip </span><span class="crayon-e">install </span><span class="crayon-v">keras</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p></p>
<p>Or, if you are on anaconda:</p>
<p></p>
		<div id="urvanov-syntax-highlighter-6808fcc2e2eac596002870" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
conda install -c conda-forge keras</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2e2eac596002870-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2e2eac596002870-1"><span class="crayon-e">conda </span><span class="crayon-v">install</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-v">conda</span><span class="crayon-o">-</span><span class="crayon-e">forge </span><span class="crayon-v">keras</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-517231" data-commentid="517231" data-postid="7553" data-belowelement="comment-517231" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-520248" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-520248" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/c42e3a20603af246ffaa3f572726953095950a8f1544a23d9203aad3cbd2d11b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c42e3a20603af246ffaa3f572726953095950a8f1544a23d9203aad3cbd2d11b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dmytro</span>
	                <span class="date">February 4, 2020 at 7:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-520248" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,<br />
Thank you for the tutorial and all the answers!</p>
<p>I have my own set of images, each class in a separate folder. What should I do to upload the dataset instead of writing</p>
<p># load dataset<br />
(trainX, trainY), (testX, testY) = mnist.load_data()</p>
<p>It would be great if you can give some advice!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-520248" data-commentid="520248" data-postid="7553" data-belowelement="comment-520248" data-respondelement="respond" data-replyto="Reply to Dmytro" aria-label="Reply to Dmytro">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-520271" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-520271" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">February 4, 2020 at 8:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-520271" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Here is an example:<br />
<a href="https://machinelearningmastery.com/how-to-load-large-datasets-from-directories-for-deep-learning-with-keras/" rel="ugc">https://machinelearningmastery.com/how-to-load-large-datasets-from-directories-for-deep-learning-with-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-520271" data-commentid="520271" data-postid="7553" data-belowelement="comment-520271" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-520432" class="comment even thread-even depth-1">

	      	<div id="li-comment-520432" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/c42e3a20603af246ffaa3f572726953095950a8f1544a23d9203aad3cbd2d11b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c42e3a20603af246ffaa3f572726953095950a8f1544a23d9203aad3cbd2d11b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dmytro</span>
	                <span class="date">February 5, 2020 at 4:00 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-520432" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-520432" data-commentid="520432" data-postid="7553" data-belowelement="comment-520432" data-respondelement="respond" data-replyto="Reply to Dmytro" aria-label="Reply to Dmytro">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-520493" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-520493" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">February 6, 2020 at 8:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-520493" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-520493" data-commentid="520493" data-postid="7553" data-belowelement="comment-520493" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-525583" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-525583" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/ce49afd7fa0f8e99902dfa4f37d2503c9d14a4f4a38a92800b91db3376033bfe?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ce49afd7fa0f8e99902dfa4f37d2503c9d14a4f4a38a92800b91db3376033bfe?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">SARVANI CH</span>
	                <span class="date">March 14, 2020 at 9:11 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-525583" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br />
Thanks for the article!!!<br />
Do you have any plans to implement &#8220;Information bottleneck theory&#8221; i.e, finding mainly the mutual information among various layers in an architecture?<br />
Does it seem simpler or a harder one for you??</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-525583" data-commentid="525583" data-postid="7553" data-belowelement="comment-525583" data-respondelement="respond" data-replyto="Reply to SARVANI CH" aria-label="Reply to SARVANI CH">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-525620" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-525620" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">March 15, 2020 at 6:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-525620" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have not heard of it sorry, do you have a link?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-525620" data-commentid="525620" data-postid="7553" data-belowelement="comment-525620" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-526177" class="comment even thread-even depth-1">

	      	<div id="li-comment-526177" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/94b67df9cdae341c63f432da3cd2328a5c5588d94b0b104324b6cb53337311d1?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/94b67df9cdae341c63f432da3cd2328a5c5588d94b0b104324b6cb53337311d1?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">SWETHA</span>
	                <span class="date">March 20, 2020 at 1:05 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-526177" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>def load_image(filename):<br />
	# load the image<br />
	img = load_img(filename, grayscale=True, target_size=(28, 28))<br />
	# convert to array<br />
	img = img_to_array(img)<br />
	# reshape into a single sample with 1 channel<br />
	img = img.reshape(1, 28, 28, 1)<br />
	# prepare pixel data<br />
	img = img.astype(&#8216;float32&#8217;)<br />
	img = img / 255.0<br />
	return img</p>
<p>what does the &#8216;filename&#8217; mean in the above code?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-526177" data-commentid="526177" data-postid="7553" data-belowelement="comment-526177" data-respondelement="respond" data-replyto="Reply to SWETHA" aria-label="Reply to SWETHA">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-526187" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-526187" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">March 20, 2020 at 1:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-526187" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It&#8217;s an argument to the function &#8211; the name of the file you want to load.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-526187" data-commentid="526187" data-postid="7553" data-belowelement="comment-526187" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-526196" class="comment even depth-3">

	      	<div id="li-comment-526196" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/94b67df9cdae341c63f432da3cd2328a5c5588d94b0b104324b6cb53337311d1?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/94b67df9cdae341c63f432da3cd2328a5c5588d94b0b104324b6cb53337311d1?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">SWETHA</span>
	                <span class="date">March 20, 2020 at 2:17 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-526196" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Did you mean the saved model&#8217;s filename?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-526196" data-commentid="526196" data-postid="7553" data-belowelement="comment-526196" data-respondelement="respond" data-replyto="Reply to SWETHA" aria-label="Reply to SWETHA">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-526276" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-526276" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">March 21, 2020 at 8:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-526276" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, the function loads an image as it&#8217;s name suggests.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-526276" data-commentid="526276" data-postid="7553" data-belowelement="comment-526276" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-526191" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-526191" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/94b67df9cdae341c63f432da3cd2328a5c5588d94b0b104324b6cb53337311d1?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/94b67df9cdae341c63f432da3cd2328a5c5588d94b0b104324b6cb53337311d1?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">SWETHA</span>
	                <span class="date">March 20, 2020 at 1:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-526191" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-526191" data-commentid="526191" data-postid="7553" data-belowelement="comment-526191" data-respondelement="respond" data-replyto="Reply to SWETHA" aria-label="Reply to SWETHA">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-526272" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-526272" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">March 21, 2020 at 8:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-526272" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-526272" data-commentid="526272" data-postid="7553" data-belowelement="comment-526272" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-526913" class="comment even thread-even depth-1">

	      	<div id="li-comment-526913" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5b3d86ecc67b06bccc9df31ed099448a0683f33d90d15a4f49a6be00efe2bd98?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5b3d86ecc67b06bccc9df31ed099448a0683f33d90d15a4f49a6be00efe2bd98?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Elbhednam</span>
	                <span class="date">March 26, 2020 at 6:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-526913" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What is the purpose of reshaping the data to a single color channel? Is it necessary for the 2D convolution step in the model definition? I ask because other digit classification examples I&#8217;ve looked at go straight to flattening the train/test data but those didn&#8217;t have a 2D convolution layer.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-526913" data-commentid="526913" data-postid="7553" data-belowelement="comment-526913" data-respondelement="respond" data-replyto="Reply to Elbhednam" aria-label="Reply to Elbhednam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-526944" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-526944" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">March 26, 2020 at 8:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-526944" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The CNN layer expects data to have a 3d shape including a channels dimension:<br />
<a href="https://machinelearningmastery.com/convolutional-layers-for-deep-learning-neural-networks/" rel="ugc">https://machinelearningmastery.com/convolutional-layers-for-deep-learning-neural-networks/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-526944" data-commentid="526944" data-postid="7553" data-belowelement="comment-526944" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-529516" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-529516" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/097a13b8c964bacf36e0935ebe5f9925e0d4bb4562e9c11bfcc3fd1da6e161b4?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/097a13b8c964bacf36e0935ebe5f9925e0d4bb4562e9c11bfcc3fd1da6e161b4?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://www.taterkins.com/" class="url" rel="ugc external nofollow">Edward</a></span>
	                <span class="date">April 13, 2020 at 5:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-529516" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If one wanted to create a new MNIST how would they set the data up? In these examples we get to use curated datasets from a dispensary but that does not explain how to set up your data to run the model.<br />
For example what if I wanted to create my own MNIST to determine if the picture is a poker card, how would I go about setting the pictures and telling the machine what that picture is?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-529516" data-commentid="529516" data-postid="7553" data-belowelement="comment-529516" data-respondelement="respond" data-replyto="Reply to Edward" aria-label="Reply to Edward">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-529541" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-529541" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">April 13, 2020 at 6:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-529541" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question, see this:<br />
<a href="https://machinelearningmastery.com/how-to-load-large-datasets-from-directories-for-deep-learning-with-keras/" rel="ugc">https://machinelearningmastery.com/how-to-load-large-datasets-from-directories-for-deep-learning-with-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-529541" data-commentid="529541" data-postid="7553" data-belowelement="comment-529541" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-529826" class="comment even thread-even depth-1">

	      	<div id="li-comment-529826" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/e0a81a1de8db6f58c4ffedd3b25262d036e6127ce28981f2f6df2692de0e506e?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e0a81a1de8db6f58c4ffedd3b25262d036e6127ce28981f2f6df2692de0e506e?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Amit Baghel</span>
	                <span class="date">April 15, 2020 at 3:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-529826" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi Jason Brownlee,<br />
  i want to make model handwriting alphbet  so please suggest which dataset is good</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-529826" data-commentid="529826" data-postid="7553" data-belowelement="comment-529826" data-respondelement="respond" data-replyto="Reply to Amit Baghel" aria-label="Reply to Amit Baghel">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-529903" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-529903" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">April 16, 2020 at 5:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-529903" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps this will help:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/where-can-i-get-a-dataset-on-___" rel="ugc">https://machinelearningmastery.com/faq/single-faq/where-can-i-get-a-dataset-on-___</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-529903" data-commentid="529903" data-postid="7553" data-belowelement="comment-529903" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-530170" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-530170" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/4f0af7a6870868dfc104cad790d1df8272224b7b9657d5e52e9d5103bc565218?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/4f0af7a6870868dfc104cad790d1df8272224b7b9657d5e52e9d5103bc565218?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nawal</span>
	                <span class="date">April 17, 2020 at 6:03 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-530170" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason, Thank you so much for sharing your knowledge. I just started learning python, tensorflow and machine learning. I understood all the maths and processes but was having difficulty in coding. Your example worked first time. Brilliant.<br />
Do you have a simpler example of CNN with just 4 hidden layers as follows:<br />
1. Input layer of 784 nodes<br />
2. First convolution later : 5x5x32<br />
3. First max pooling layer<br />
4. Second convolution layer 5x5x64<br />
5. Second max pooling layer<br />
6. Out put layer of 10 nodes</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-530170" data-commentid="530170" data-postid="7553" data-belowelement="comment-530170" data-respondelement="respond" data-replyto="Reply to Nawal" aria-label="Reply to Nawal">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-530259" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-530259" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">April 18, 2020 at 5:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-530259" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>
<p>You can adapt the above example to this directly if you like.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-530259" data-commentid="530259" data-postid="7553" data-belowelement="comment-530259" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-533129" class="comment even thread-even depth-1">

	      	<div id="li-comment-533129" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/519fe55187b6d52bb3811867dbe2d575a86b40d7a1a4f752a2fcae5bb1841d49?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/519fe55187b6d52bb3811867dbe2d575a86b40d7a1a4f752a2fcae5bb1841d49?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Joyce</span>
	                <span class="date">May 4, 2020 at 6:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-533129" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason. Can I ask why did you reshape the data? The image from the MNIST are already grey scale which are 1 channel. I am not quite understand why you need to do this step. Also what does the trainx.shape[0]/testX.shape[0] do here?</p>
<p># reshape dataset to have a single channel<br />
trainX = trainX.reshape((trainX.shape[0], 28, 28, 1))<br />
testX = testX.reshape((testX.shape[0], 28, 28, 1))</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-533129" data-commentid="533129" data-postid="7553" data-belowelement="comment-533129" data-respondelement="respond" data-replyto="Reply to Joyce" aria-label="Reply to Joyce">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-533146" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-533146" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">May 4, 2020 at 6:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-533146" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Inputs to CNNs must have the channel defined explicitly, which is not the case by default for grayscale images.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-533146" data-commentid="533146" data-postid="7553" data-belowelement="comment-533146" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-533147" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-533147" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d6a8b66a64ef3aa7983eb8b04984710355d358795b18fb1a05f2489a7fefb2a0?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d6a8b66a64ef3aa7983eb8b04984710355d358795b18fb1a05f2489a7fefb2a0?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Amy</span>
	                <span class="date">May 4, 2020 at 6:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-533147" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can I ask why the hot encode is 10 binary vectors? Why choose 10?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-533147" data-commentid="533147" data-postid="7553" data-belowelement="comment-533147" data-respondelement="respond" data-replyto="Reply to Amy" aria-label="Reply to Amy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-533148" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-533148" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">May 4, 2020 at 6:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-533148" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Because there are 10 classes.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-533148" data-commentid="533148" data-postid="7553" data-belowelement="comment-533148" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-533713" class="comment even thread-even depth-1">

	      	<div id="li-comment-533713" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5ca94e9c2f5c8e27cc6f6d51cf3c96f106c39a0924ad329157e19b00b43b994f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5ca94e9c2f5c8e27cc6f6d51cf3c96f106c39a0924ad329157e19b00b43b994f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ruslaniv</span>
	                <span class="date">May 7, 2020 at 9:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-533713" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason! Thank you so much, this is a great tutorial!<br />
Just one question, i&#8217;m somewhat confused.<br />
Are training our model twice? Once with k-fold validation and then right before saving it, with model.fit?<br />
====<br />
model = define_model()<br />
model.fit(trainX, trainY, epochs=10, batch_size=32, verbose=0)<br />
model.save(&#8216;final_model.h5&#8217;)<br />
====</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-533713" data-commentid="533713" data-postid="7553" data-belowelement="comment-533713" data-respondelement="respond" data-replyto="Reply to Ruslaniv" aria-label="Reply to Ruslaniv">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-533783" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-533783" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">May 8, 2020 at 6:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-533783" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Cross-validation will train k models and is used to estimate the performance when making predictions on new data. These models are discarded.</p>
<p>Once we choose a final model config, we fit a model on all data and use it to start making predictions.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-533783" data-commentid="533783" data-postid="7553" data-belowelement="comment-533783" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-534290" class="comment even depth-3">

	      	<div id="li-comment-534290" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5ca94e9c2f5c8e27cc6f6d51cf3c96f106c39a0924ad329157e19b00b43b994f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5ca94e9c2f5c8e27cc6f6d51cf3c96f106c39a0924ad329157e19b00b43b994f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ruslaniv</span>
	                <span class="date">May 11, 2020 at 8:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-534290" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great, that&#8217;s what I thought! Thank you again for this amazing tutorial.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-534290" data-commentid="534290" data-postid="7553" data-belowelement="comment-534290" data-respondelement="respond" data-replyto="Reply to Ruslaniv" aria-label="Reply to Ruslaniv">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-534353" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-534353" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">May 12, 2020 at 6:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-534353" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-534353" data-commentid="534353" data-postid="7553" data-belowelement="comment-534353" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-596292" class="comment even depth-3">

	      	<div id="li-comment-596292" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/202ca33f0b9d45caea149a45208ce4878d317a9b524cb92bb84832d5944fead5?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/202ca33f0b9d45caea149a45208ce4878d317a9b524cb92bb84832d5944fead5?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Thenerd</span>
	                <span class="date">February 5, 2021 at 3:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-596292" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In the k fold cross validation a new model is defined for each k iteration. So does that mean a new model is trained each time? But then what is the use of training new models in each iteration? </p>
<p>By model config you mean an optimal define_model? And once an optimal model is fixed we train on the entire training set? I am not able to relate how will K iterations in the K-fold reflect our understanding of what model  configuration is the best.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-596292" data-commentid="596292" data-postid="7553" data-belowelement="comment-596292" data-respondelement="respond" data-replyto="Reply to Thenerd" aria-label="Reply to Thenerd">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-596326" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-596326" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">February 5, 2021 at 5:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-596326" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, a new model is trained each iteration, evaluated, and discarded.</p>
<p>The purpose is to estimate the performance of the model configuration when making predictions on unseen data for your prediction problem.</p>
<p>Once we have this estimate, we can choose to use the configuration (compared to other configurations). A final model can be fit on all data and we can start making predictions for real on new data where we don&#8217;t know the label.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-596326" data-commentid="596326" data-postid="7553" data-belowelement="comment-596326" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-596919" class="comment even depth-5">

	      	<div id="li-comment-596919" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/202ca33f0b9d45caea149a45208ce4878d317a9b524cb92bb84832d5944fead5?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/202ca33f0b9d45caea149a45208ce4878d317a9b524cb92bb84832d5944fead5?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Thenerd</span>
	                <span class="date">February 10, 2021 at 7:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-596919" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thankyou very much. I had another question. I was trying to run the final model on the unseen test data. however for each run the results vary ofcourse. therefore i decided to run this over 10 runs and average the test results, something like monte carlo simulation. but again in that case where would model = define_model() be places? would that be placed inside the for loop for average or just be defined once before running these 10 iterations, considering this average results is on the test data. since in kfold you discard it.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-596938" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-596938" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">February 10, 2021 at 8:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-596938" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome.</p>
<p>Yes, you can reduce variance in prediction by fitting multiple final models and averaging their predictions:<br />
<a href="https://machinelearningmastery.com/how-to-reduce-model-variance/" rel="ugc">https://machinelearningmastery.com/how-to-reduce-model-variance/</a></p>
<p>This has a code example:<br />
<a href="https://machinelearningmastery.com/model-averaging-ensemble-for-deep-learning-neural-networks/" rel="ugc">https://machinelearningmastery.com/model-averaging-ensemble-for-deep-learning-neural-networks/</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-534281" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-534281" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/3a58bacc6086cab69c0ca2e9f832a3365d268b7ce3698e932e90640f815da0fd?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3a58bacc6086cab69c0ca2e9f832a3365d268b7ce3698e932e90640f815da0fd?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gohel vivek</span>
	                <span class="date">May 11, 2020 at 6:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-534281" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If i am writing this all by making a class name -mnist_classification then </p>
<p>AttributeError: &#8216;mnist_classification&#8217; object has no attribute &#8216;astype&#8217;</p>
<p>this .astype error is coming please sir can you help me to figure this out</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-534281" data-commentid="534281" data-postid="7553" data-belowelement="comment-534281" data-respondelement="respond" data-replyto="Reply to Gohel vivek" aria-label="Reply to Gohel vivek">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-534345" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-534345" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">May 12, 2020 at 6:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-534345" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry to hear that, this will help:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-534345" data-commentid="534345" data-postid="7553" data-belowelement="comment-534345" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-537674" class="comment even thread-even depth-1">

	      	<div id="li-comment-537674" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/48543517491671bcb40dff8dcb19c2714d0a39aafb3e902294cee591eb5397ce?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/48543517491671bcb40dff8dcb19c2714d0a39aafb3e902294cee591eb5397ce?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ramya</span>
	                <span class="date">June 2, 2020 at 7:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-537674" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for this tutorial. It&#8217;s very helpful.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-537674" data-commentid="537674" data-postid="7553" data-belowelement="comment-537674" data-respondelement="respond" data-replyto="Reply to Ramya" aria-label="Reply to Ramya">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-537681" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-537681" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">June 2, 2020 at 7:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-537681" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome, I&#8217;m happy to hear that.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-537681" data-commentid="537681" data-postid="7553" data-belowelement="comment-537681" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-540430" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-540430" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/f0c0138b9276c8c3fb46b6e97b68ca4779f18afcf9f057142d14cce7577ad5f9?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f0c0138b9276c8c3fb46b6e97b68ca4779f18afcf9f057142d14cce7577ad5f9?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Milind Naidu</span>
	                <span class="date">June 21, 2020 at 11:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-540430" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, i am trying to build a CNN fo the same problem. My output layer has 10 neurons. When i try to fit my model after One-Hot_encoding of y_train and y_test, i get an error that the labels and the logits don&#8217;t match.   However, without the one-hot encoding the model fits perfectly. Can you please explain?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-540430" data-commentid="540430" data-postid="7553" data-belowelement="comment-540430" data-respondelement="respond" data-replyto="Reply to Milind Naidu" aria-label="Reply to Milind Naidu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-540468" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-540468" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">June 22, 2020 at 6:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-540468" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps you can use the above tutorial as a starting point and adapt it for your project?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-540468" data-commentid="540468" data-postid="7553" data-belowelement="comment-540468" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-545053" class="comment even thread-even depth-1">

	      	<div id="li-comment-545053" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/1f513cac03fc063b141bbf8a48e95c4842776f720adc8a0edacaca9e525433f1?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1f513cac03fc063b141bbf8a48e95c4842776f720adc8a0edacaca9e525433f1?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">William</span>
	                <span class="date">July 19, 2020 at 8:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-545053" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is the best article about MNIST, but I have a question &#8220;Is it necessary to use a GPU with high performance in order to running these codes?&#8221;</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-545053" data-commentid="545053" data-postid="7553" data-belowelement="comment-545053" data-respondelement="respond" data-replyto="Reply to William" aria-label="Reply to William">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-545099" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-545099" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">July 20, 2020 at 6:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-545099" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks!</p>
<p>No, you can run on CPU, it might just take more minutes to run.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-545099" data-commentid="545099" data-postid="7553" data-belowelement="comment-545099" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-546665" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-546665" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/ac852af256fb3fe3be2f25d75f9779cfc32dd5e3ca79aefc44efc08a4a000668?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ac852af256fb3fe3be2f25d75f9779cfc32dd5e3ca79aefc44efc08a4a000668?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sandhya</span>
	                <span class="date">July 31, 2020 at 3:58 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-546665" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason<br />
 Thanks for this amazing tutorial. It will definitely help a lot of budding researchers.<br />
I have a question<br />
Can you please help if instead of single character i have to work on complete self taken handwritten word image (20 different classes,total around 20000 images).  How to do it?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-546665" data-commentid="546665" data-postid="7553" data-belowelement="comment-546665" data-respondelement="respond" data-replyto="Reply to Sandhya" aria-label="Reply to Sandhya">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-546722" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-546722" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">August 1, 2020 at 6:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-546722" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps the letters in each word images can first be segmented, then classified.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-546722" data-commentid="546722" data-postid="7553" data-belowelement="comment-546722" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-546822" class="comment even depth-3">

	      	<div id="li-comment-546822" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/ac852af256fb3fe3be2f25d75f9779cfc32dd5e3ca79aefc44efc08a4a000668?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ac852af256fb3fe3be2f25d75f9779cfc32dd5e3ca79aefc44efc08a4a000668?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sandhya</span>
	                <span class="date">August 1, 2020 at 5:39 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-546822" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>thanks for the reply but i want to do it using segmentation free approach</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-546822" data-commentid="546822" data-postid="7553" data-belowelement="comment-546822" data-respondelement="respond" data-replyto="Reply to Sandhya" aria-label="Reply to Sandhya">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-546940" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-546940" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">August 2, 2020 at 5:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-546940" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps use a CNN to read the images and an LSTM to interpret the image features and output one letter at a time.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-546940" data-commentid="546940" data-postid="7553" data-belowelement="comment-546940" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-689141" class="comment even depth-5">

	      	<div id="li-comment-689141" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/33cad6b2058439d28e316a760205ddb5fe3f8cde44090e8b7adb3641b90499a7?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/33cad6b2058439d28e316a760205ddb5fe3f8cde44090e8b7adb3641b90499a7?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Prasad Bapardekar</span>
	                <span class="date">March 16, 2023 at 3:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-689141" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps use a CNN to read the images and an LSTM to interpret the image features and output one letter at a time.</p>
<p>Can you please share more detail how to do it.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-689147" class="comment byuser comment-author-jamespcarmichael odd alt depth-5">

	      	<div id="li-comment-689147" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">James Carmichael</span>
	                <span class="date">March 16, 2023 at 7:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-689147" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Prasad&#8230;You may want to consider a CNN-LSTM model for your purpose:</p>
<p><a href="https://machinelearningmastery.com/cnn-long-short-term-memory-networks/" rel="ugc">https://machinelearningmastery.com/cnn-long-short-term-memory-networks/</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-546666" class="comment even thread-even depth-1">

	      	<div id="li-comment-546666" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/ac852af256fb3fe3be2f25d75f9779cfc32dd5e3ca79aefc44efc08a4a000668?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ac852af256fb3fe3be2f25d75f9779cfc32dd5e3ca79aefc44efc08a4a000668?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sandhya</span>
	                <span class="date">July 31, 2020 at 4:14 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-546666" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi Jason<br />
Thanks for this amazing tutorial.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-546666" data-commentid="546666" data-postid="7553" data-belowelement="comment-546666" data-respondelement="respond" data-replyto="Reply to Sandhya" aria-label="Reply to Sandhya">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-546723" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-546723" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">August 1, 2020 at 6:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-546723" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-546723" data-commentid="546723" data-postid="7553" data-belowelement="comment-546723" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-568433" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-568433" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/3a09092ccbea71b632d47cfc2192082e75271263ae2f016ac2b4e76273bba768?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3a09092ccbea71b632d47cfc2192082e75271263ae2f016ac2b4e76273bba768?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://no" class="url" rel="ugc external nofollow">zulfiqar ali</a></span>
	                <span class="date">October 18, 2020 at 9:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-568433" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, Jason Brownlee for this excellent tutorial. I am your huge fan and I regularly following your all machine learning and deep earning models.I got a lot of knowledge from this site but After completion of machine learning tutorials there always raise a question in my mind that how can we apply these models in Mobile APPs(Andriod, iOS, etc) so that we get more fun and knowledge by this models. Are you suggest to me any link to have such kind of projects such as weather prediction app . Thanks again.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-568433" data-commentid="568433" data-postid="7553" data-belowelement="comment-568433" data-respondelement="respond" data-replyto="Reply to zulfiqar ali" aria-label="Reply to zulfiqar ali">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-568481" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-568481" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">October 18, 2020 at 1:25 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-568481" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>
<p>Sorry, I don&#8217;t know about using models on mobile.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-568481" data-commentid="568481" data-postid="7553" data-belowelement="comment-568481" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-641739" class="comment even depth-2">

	      	<div id="li-comment-641739" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/50f1fb16266f011d7f63ad9506c99991963fb3e4eeecc32c39c1fd45de9761cd?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/50f1fb16266f011d7f63ad9506c99991963fb3e4eeecc32c39c1fd45de9761cd?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Patrick Wood</span>
	                <span class="date">November 28, 2021 at 5:17 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-641739" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I know this is a year late, but see this for a mobile app based on tensorflow and keras: <a href="https://medium.com/@timanglade/how-hbos-silicon-valley-built-not-hotdog-with-mobile-tensorflow-keras-react-native-ef03260747f3" rel="nofollow ugc">https://medium.com/@timanglade/how-hbos-silicon-valley-built-not-hotdog-with-mobile-tensorflow-keras-react-native-ef03260747f3</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-641739" data-commentid="641739" data-postid="7553" data-belowelement="comment-641739" data-respondelement="respond" data-replyto="Reply to Patrick Wood" aria-label="Reply to Patrick Wood">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-570102" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-570102" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a94f1142d71720dc947b5e1024dec34e9413d4113361f890c7e22572287b1b28?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a94f1142d71720dc947b5e1024dec34e9413d4113361f890c7e22572287b1b28?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Zunaira Shafqat</span>
	                <span class="date">October 23, 2020 at 4:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-570102" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the tutorial Jason Brownlee.<br />
Can I use same model but pass my own dataset (of humans) to it &amp; use it for detecting fall or not fall by making small changes?<br />
Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-570102" data-commentid="570102" data-postid="7553" data-belowelement="comment-570102" data-respondelement="respond" data-replyto="Reply to Zunaira Shafqat" aria-label="Reply to Zunaira Shafqat">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-570128" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-570128" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">October 23, 2020 at 6:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-570128" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-570128" data-commentid="570128" data-postid="7553" data-belowelement="comment-570128" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-574728" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-574728" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/07bbca7b2e601a22c38ab18b0145969128b0bfb75ae5381e8ba583f3f9baf0b8?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/07bbca7b2e601a22c38ab18b0145969128b0bfb75ae5381e8ba583f3f9baf0b8?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Preethi</span>
	                <span class="date">November 12, 2020 at 3:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-574728" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi do you have any projects done based on Wireless and Mobile Network except human activity recognition using smart phone</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-574728" data-commentid="574728" data-postid="7553" data-belowelement="comment-574728" data-respondelement="respond" data-replyto="Reply to Preethi" aria-label="Reply to Preethi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-574875" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-574875" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">November 13, 2020 at 6:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-574875" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don&#8217;t think so. Perhaps try the blog search.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-574875" data-commentid="574875" data-postid="7553" data-belowelement="comment-574875" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-575017" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-575017" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/7751c2031b5370eb3fa599722bba19574f906f4913d279fb2bd9d08c8bf33602?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7751c2031b5370eb3fa599722bba19574f906f4913d279fb2bd9d08c8bf33602?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Archna</span>
	                <span class="date">November 13, 2020 at 7:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-575017" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the detailed explanation !!<br />
Can you pls do a tutorial on colorization without using pretratined model</p>
<p>Thanks in advance</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-575017" data-commentid="575017" data-postid="7553" data-belowelement="comment-575017" data-respondelement="respond" data-replyto="Reply to Archna" aria-label="Reply to Archna">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-575118" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-575118" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">November 14, 2020 at 6:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-575118" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great suggestion, thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-575118" data-commentid="575118" data-postid="7553" data-belowelement="comment-575118" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-578189" class="comment odd alt depth-3">

	      	<div id="li-comment-578189" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/7751c2031b5370eb3fa599722bba19574f906f4913d279fb2bd9d08c8bf33602?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7751c2031b5370eb3fa599722bba19574f906f4913d279fb2bd9d08c8bf33602?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Archna</span>
	                <span class="date">November 24, 2020 at 6:31 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-578189" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Waiting for the same 🙂</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-578189" data-commentid="578189" data-postid="7553" data-belowelement="comment-578189" data-respondelement="respond" data-replyto="Reply to Archna" aria-label="Reply to Archna">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-581421" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-581421" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/bf54f07a62b4064f010457f8096ed675b0717584ecddccaaec78e5368e4e44af?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/bf54f07a62b4064f010457f8096ed675b0717584ecddccaaec78e5368e4e44af?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ebdulmomen</span>
	                <span class="date">December 7, 2020 at 8:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-581421" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hey jason that was a very good tutorial, i did not understand how in the predict_classes we got 7? the model had a softmax activation function as the last layer which will be a probability distribution of 10 float numbers, what i can&#8217;t grasp is how did we get back 7?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-581421" data-commentid="581421" data-postid="7553" data-belowelement="comment-581421" data-respondelement="respond" data-replyto="Reply to Ebdulmomen" aria-label="Reply to Ebdulmomen">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-581422" class="comment odd alt depth-2">

	      	<div id="li-comment-581422" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/bf54f07a62b4064f010457f8096ed675b0717584ecddccaaec78e5368e4e44af?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/bf54f07a62b4064f010457f8096ed675b0717584ecddccaaec78e5368e4e44af?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ebdulmomen</span>
	                <span class="date">December 7, 2020 at 8:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-581422" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>what i mean is how this 10 probabilities turned into 1 predicted number?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-581422" data-commentid="581422" data-postid="7553" data-belowelement="comment-581422" data-respondelement="respond" data-replyto="Reply to Ebdulmomen" aria-label="Reply to Ebdulmomen">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-581423" class="comment even depth-3">

	      	<div id="li-comment-581423" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/bf54f07a62b4064f010457f8096ed675b0717584ecddccaaec78e5368e4e44af?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/bf54f07a62b4064f010457f8096ed675b0717584ecddccaaec78e5368e4e44af?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ebdulmomen</span>
	                <span class="date">December 7, 2020 at 9:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-581423" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>and how does it know it is 7, didn&#8217;t we hot encode the Y values?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-581423" data-commentid="581423" data-postid="7553" data-belowelement="comment-581423" data-respondelement="respond" data-replyto="Reply to Ebdulmomen" aria-label="Reply to Ebdulmomen">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-581447" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3">

	      	<div id="li-comment-581447" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">December 7, 2020 at 1:35 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-581447" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Via argmax:<br />
<a href="https://machinelearningmastery.com/argmax-in-machine-learning/" rel="ugc">https://machinelearningmastery.com/argmax-in-machine-learning/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-581447" data-commentid="581447" data-postid="7553" data-belowelement="comment-581447" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-581446" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-581446" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">December 7, 2020 at 1:35 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-581446" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>
<p>The predict_classes() performs an argmax on the predicted probabilities for you.</p>
<p>If you are new to argmax, see this:<br />
<a href="https://machinelearningmastery.com/argmax-in-machine-learning/" rel="ugc">https://machinelearningmastery.com/argmax-in-machine-learning/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-581446" data-commentid="581446" data-postid="7553" data-belowelement="comment-581446" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-581472" class="comment odd alt depth-3">

	      	<div id="li-comment-581472" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/bf54f07a62b4064f010457f8096ed675b0717584ecddccaaec78e5368e4e44af?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/bf54f07a62b4064f010457f8096ed675b0717584ecddccaaec78e5368e4e44af?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ebdulmomen</span>
	                <span class="date">December 7, 2020 at 6:41 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-581472" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>thank you jason, everything is clear, really appreciate it!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-581472" data-commentid="581472" data-postid="7553" data-belowelement="comment-581472" data-respondelement="respond" data-replyto="Reply to Ebdulmomen" aria-label="Reply to Ebdulmomen">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-581585" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-581585" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">December 8, 2020 at 7:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-581585" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I&#8217;m happy to hear that.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-581585" data-commentid="581585" data-postid="7553" data-belowelement="comment-581585" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-583565" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-583565" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5fb6d783f84f52f652da3b5815024c1b489f4a3723e8701abc7e663fa161c953?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5fb6d783f84f52f652da3b5815024c1b489f4a3723e8701abc7e663fa161c953?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Naveen</span>
	                <span class="date">December 13, 2020 at 2:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-583565" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey is this code not compatible for Tensorflow 2? I am getting the following error.<br />
E tensorflow/stream_executor/cuda/cuda_driver.cc:314] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-583565" data-commentid="583565" data-postid="7553" data-belowelement="comment-583565" data-respondelement="respond" data-replyto="Reply to Naveen" aria-label="Reply to Naveen">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-583598" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-583598" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">December 13, 2020 at 6:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-583598" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you can learn more here:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/do-you-support-tensorflow-2" rel="ugc">https://machinelearningmastery.com/faq/single-faq/do-you-support-tensorflow-2</a></p>
<p>That error looks like a problem with your development environment.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-583598" data-commentid="583598" data-postid="7553" data-belowelement="comment-583598" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-587839" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-587839" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d5b9f6ed97273f3b581e510e8a26cee87cfca8a98677c26a30eb7c05b605ed53?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d5b9f6ed97273f3b581e510e8a26cee87cfca8a98677c26a30eb7c05b605ed53?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Yash</span>
	                <span class="date">December 23, 2020 at 9:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-587839" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello!<br />
Thanks for the wonderful article helped me a lot with my project!<br />
I have a question though, I am trying to take an image from my phone and then use that image to predict the number but it doesn&#8217;t work with that. What should I do to that image?<br />
I resized it to 28&#215;28 using online tools and even tried the grayscale version of the image to predict.<br />
Any suggestion or lead will be appreciated!<br />
Thanks in advance!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-587839" data-commentid="587839" data-postid="7553" data-belowelement="comment-587839" data-respondelement="respond" data-replyto="Reply to Yash" aria-label="Reply to Yash">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-587897" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-587897" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">December 23, 2020 at 1:27 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-587897" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You will have to prepare the image in an identical manner to the images in the training set. e.g. white foreground, black background, grayscale and same image size.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-587897" data-commentid="587897" data-postid="7553" data-belowelement="comment-587897" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-590154" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-590154" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/e075f8837e81e6fe90d2dcf9b82f9325f5d4f38c2da8f8cec602a25490b1605a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e075f8837e81e6fe90d2dcf9b82f9325f5d4f38c2da8f8cec602a25490b1605a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://acehl.org/" class="url" rel="ugc external nofollow">JG</a></span>
	                <span class="date">December 31, 2020 at 7:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-590154" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Great tutorial as always!</p>
<p>I implemented your tutorial with two variants. </p>
<p>I load the images from  digits dataset of sklearn library (it uses less images number only 1,797 and with much lower resolution 8 x 8 bits vs MNIST 70,000 and 28,28 pixels resolution. On the contrary it is much faster this dataset because it use less data features.<br />
And also I apply for this multi-class problem  other library classifier models from Sklearn such as SVC(), logisticRegression(), ExtraTreesClassifier(), XGBClassifier(), RandomForestClassifier(), etc.</p>
<p>My main results are:</p>
<p>&#8211; I got 98.4% accuracy and 1.1 of sigma for the simple CNN baseline model  (not other deep layers, not other BatchNormalization()) and I got 98.8% from SVC&#8230;but only suing the 8&#215;8 pixels resolution which is a great new!.</p>
<p>But when I reduce the final image to be predicted to 8 x 8 pixels, in order to apply my trained model, whereI got such a great score  I poorly predict the 7 digit as 9 digit.<br />
My guess is when I load_image of 7 and I clip it to such smaller size of 8&#215;8 pixels, I lost important images features in the process of cutting back the image&#8230;.where the the MNIST 28&#215;28 pixels still retain key digit features of the image, what do you think?</p>
<p>thank you Jason</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-590154" data-commentid="590154" data-postid="7553" data-belowelement="comment-590154" data-respondelement="respond" data-replyto="Reply to JG" aria-label="Reply to JG">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-590173" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-590173" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">December 31, 2020 at 9:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-590173" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>
<p>Very nice experiments!</p>
<p>Yes, the larger images perhaps provide more context on challenging cases in the dataset.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-590173" data-commentid="590173" data-postid="7553" data-belowelement="comment-590173" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-594411" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-594411" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8f0fe7c421b0b9f5e9431c333ba3ba5e472ae9544a7e72667c8e3343849f44fe?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8f0fe7c421b0b9f5e9431c333ba3ba5e472ae9544a7e72667c8e3343849f44fe?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://www.hannesholst.com" class="url" rel="ugc external nofollow">Hannes</a></span>
	                <span class="date">January 26, 2021 at 1:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-594411" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>You have always very interesting articles.<br />
I was able to train a CNN based on the Char74K-dataset. I&#8217;m happy of that because the model-file is only 42MB and the time to predict a number is fast.</p>
<p>I did use a kNN-model before (on the same dataset) that had a file size of 680MB!</p>
<p>Thanks,<br />
Hannes</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-594411" data-commentid="594411" data-postid="7553" data-belowelement="comment-594411" data-respondelement="respond" data-replyto="Reply to Hannes" aria-label="Reply to Hannes">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-594480" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-594480" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">January 26, 2021 at 5:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-594480" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>
<p>Well done!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-594480" data-commentid="594480" data-postid="7553" data-belowelement="comment-594480" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-596400" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-596400" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9d3ce892338bf0d7c2cd41e54c47519739ff6ea32c7a9d03e807347b627ee698?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9d3ce892338bf0d7c2cd41e54c47519739ff6ea32c7a9d03e807347b627ee698?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mukesh</span>
	                <span class="date">February 5, 2021 at 8:42 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-596400" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Great article!!</p>
<p>i just have one doubt, in the evaluate method why are we creating a new model for every fold?</p>
<p>Thanks,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-596400" data-commentid="596400" data-postid="7553" data-belowelement="comment-596400" data-respondelement="respond" data-replyto="Reply to Mukesh" aria-label="Reply to Mukesh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-596453" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-596453" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">February 6, 2021 at 5:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-596453" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is how k-fold cross-validation works, we have a new training set and fit a new model for each fold, then average the performance of all models to get an estimate of model performance when used on unseen data.</p>
<p>You can learn more here:<br />
<a href="https://machinelearningmastery.com/k-fold-cross-validation/" rel="ugc">https://machinelearningmastery.com/k-fold-cross-validation/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-596453" data-commentid="596453" data-postid="7553" data-belowelement="comment-596453" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-596502" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-596502" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8c2d3d500af846f3e6be01b0e4dc5cb822101b358374442567a214980a28e8f0?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8c2d3d500af846f3e6be01b0e4dc5cb822101b358374442567a214980a28e8f0?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dmitry</span>
	                <span class="date">February 6, 2021 at 6:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-596502" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for this amazing tutorial!</p>
<p>I have some experience in MLP but not with CNN. Is there a reason try to use CNN if each sample of my data have shape 16&#215;1 (row) with values between 0,01 to 0,99 and the model shoud perform classification for 15 classes. If I reshape samples from 16&#215;1 to 4&#215;4 then which filter size and a modest number of filters shoud I use? Or better dont reshape and try model with Conv1D layers? Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-596502" data-commentid="596502" data-postid="7553" data-belowelement="comment-596502" data-respondelement="respond" data-replyto="Reply to Dmitry" aria-label="Reply to Dmitry">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-596533" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-596533" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">February 7, 2021 at 5:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-596533" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>CNN can be effective if there is a spatial relationship between the inputs in an image or a sequence.</p>
<p>If you have tabular data (e.g. not a images and not sequences), then a CNN does not make sense.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-596533" data-commentid="596533" data-postid="7553" data-belowelement="comment-596533" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-597913" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-597913" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/04cd15128e05b3ab5bfa1702365b09753a83ed36335fcbfc9c575d3910b5c3c3?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/04cd15128e05b3ab5bfa1702365b09753a83ed36335fcbfc9c575d3910b5c3c3?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ahmed Shafeek</span>
	                <span class="date">February 18, 2021 at 2:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-597913" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thank you very much for your amazing tutorial. I am running your code using pycharm and I have a GPU with the right CUDA but your code is only running on my CPU.</p>
<p>Is there something that I am missing here?</p>
<p>thank you. 🙂</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-597913" data-commentid="597913" data-postid="7553" data-belowelement="comment-597913" data-respondelement="respond" data-replyto="Reply to Ahmed Shafeek" aria-label="Reply to Ahmed Shafeek">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-597921" class="comment even depth-2">

	      	<div id="li-comment-597921" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/04cd15128e05b3ab5bfa1702365b09753a83ed36335fcbfc9c575d3910b5c3c3?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/04cd15128e05b3ab5bfa1702365b09753a83ed36335fcbfc9c575d3910b5c3c3?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ahmed Shafeek</span>
	                <span class="date">February 18, 2021 at 4:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-597921" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry Jason, it turned out I had a problem in the CuDNN installation and i did a work around to fix it and it worked. 🙂</p>
<p>Thanks again for this great tutorial. 🙂</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-597921" data-commentid="597921" data-postid="7553" data-belowelement="comment-597921" data-respondelement="respond" data-replyto="Reply to Ahmed Shafeek" aria-label="Reply to Ahmed Shafeek">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-597992" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3">

	      	<div id="li-comment-597992" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">February 19, 2021 at 5:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-597992" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No problem! </p>
<p>Happy to hear you fixed the issue.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-597992" data-commentid="597992" data-postid="7553" data-belowelement="comment-597992" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-597990" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-597990" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">February 19, 2021 at 5:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-597990" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The code is agnostic to hardware &#8211; runs on both.</p>
<p>If it is running on your CPU, then you need to change the configuration of your tensorflow library. I don&#8217;t have tutorials on this topic, sorry.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-597990" data-commentid="597990" data-postid="7553" data-belowelement="comment-597990" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-598567" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-598567" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/149d52bf46bf47738ebfb7a118defb3ea6e68578af938f452e974450222f75d9?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/149d52bf46bf47738ebfb7a118defb3ea6e68578af938f452e974450222f75d9?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Karl</span>
	                <span class="date">February 24, 2021 at 1:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-598567" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>Thank you very much for this tutorial, helped a lot! I developed my own CNN, which seems to perform pretty well according to the mean accuracy. However, the cross-entropy loss of the validation set is below the loss of the training set. Is this a sign of underfitting? And if so, should I change the model if I would like to apply the model to unseen data?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-598567" data-commentid="598567" data-postid="7553" data-belowelement="comment-598567" data-respondelement="respond" data-replyto="Reply to Karl" aria-label="Reply to Karl">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-598599" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-598599" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">February 24, 2021 at 5:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-598599" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome.</p>
<p>Well done!</p>
<p>If performance is poor, a learning curve can help diagnose issues, this can help you interpret the learning curve:<br />
<a href="https://machinelearningmastery.com/learning-curves-for-diagnosing-machine-learning-model-performance/" rel="ugc">https://machinelearningmastery.com/learning-curves-for-diagnosing-machine-learning-model-performance/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-598599" data-commentid="598599" data-postid="7553" data-belowelement="comment-598599" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-598569" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-598569" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/b9a46379d82033f578a34fb9e00550830dbb857a79dbb940e3f95854c2b8cc39?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b9a46379d82033f578a34fb9e00550830dbb857a79dbb940e3f95854c2b8cc39?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Noah</span>
	                <span class="date">February 24, 2021 at 1:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-598569" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thank you very much for this tutorial, helped a lot! I developed my own CNN, which seems to perform pretty well according to the mean accuracy. However, the cross-entropy loss of the validation set is below the loss of the training set. Is this a sign of underfitting? And if so, should I change the model if I would like to apply the model to unseen data?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-598569" data-commentid="598569" data-postid="7553" data-belowelement="comment-598569" data-respondelement="respond" data-replyto="Reply to Noah" aria-label="Reply to Noah">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-598601" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-598601" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">February 24, 2021 at 5:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-598601" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome.</p>
<p>Perhaps focus on the out of sample performance of the model first and optimize that.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-598601" data-commentid="598601" data-postid="7553" data-belowelement="comment-598601" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-599413" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-599413" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/eda414571dea72531ed8af65571a5bba2a1ad514870a072f4b6350561af2ac77?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/eda414571dea72531ed8af65571a5bba2a1ad514870a072f4b6350561af2ac77?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Geo</span>
	                <span class="date">March 2, 2021 at 12:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-599413" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Previously I was grateful for the tutorial you provided, I learned a lot from here. What if I want to display the probability value of the prediction result? (for example 50.67% something like that)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-599413" data-commentid="599413" data-postid="7553" data-belowelement="comment-599413" data-respondelement="respond" data-replyto="Reply to Geo" aria-label="Reply to Geo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-599461" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-599461" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">March 2, 2021 at 5:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-599461" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks!</p>
<p>You can call model.predict() then multiply the result by 100 to get a percentage.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-599461" data-commentid="599461" data-postid="7553" data-belowelement="comment-599461" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-599529" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-599529" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/ae82368c047a880a11c67f84c69b8aa3959beec1bb04f108c9c12f8e228a05ed?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ae82368c047a880a11c67f84c69b8aa3959beec1bb04f108c9c12f8e228a05ed?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">William</span>
	                <span class="date">March 2, 2021 at 3:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-599529" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for the tutorial!</p>
<p>I created an image with same characteristics as sample_image.png (1490&#215;1480, black background, white foreground), opened it in Paint, typed a &#8220;6&#8221; (without the quotes, of course), increased the font size to 1000 (so it would occupy most of the canvas), then saved it.  However, the code doesn&#8217;t seem to recognize it.  It seems to think it&#8217;s a &#8220;1&#8221;, &#8220;8&#8221;, or other numbers.</p>
<p>Any suggestions on why?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-599529" data-commentid="599529" data-postid="7553" data-belowelement="comment-599529" data-respondelement="respond" data-replyto="Reply to William" aria-label="Reply to William">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-599625" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-599625" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">March 3, 2021 at 5:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-599625" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps there was some important difference in the image itself or it&#8217;s preparation (e.g. pixel scaling) that differed from the training dataset?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-599625" data-commentid="599625" data-postid="7553" data-belowelement="comment-599625" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-603051" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-603051" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/128106f41a3e52c597dcce96cc5e484b9b529215bf5566f8846c14b47f4b6e9a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/128106f41a3e52c597dcce96cc5e484b9b529215bf5566f8846c14b47f4b6e9a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Venkat</span>
	                <span class="date">April 1, 2021 at 10:07 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-603051" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason &#8211; fantastic article!! Just wondering why you had to do evaluate to get the accuracy, while it is already being returned by the fit call? I just checked the histories and they have exactly the same stuff returned by the evaluate call. Was there any other reason for the evaluate call?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-603051" data-commentid="603051" data-postid="7553" data-belowelement="comment-603051" data-respondelement="respond" data-replyto="Reply to Venkat" aria-label="Reply to Venkat">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-603104" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-603104" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">April 2, 2021 at 5:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-603104" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks!</p>
<p>No, accuracy on a hold out dataset is not calculated when calling fit. We must make predictions on new data manually or use the evaluate function.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-603104" data-commentid="603104" data-postid="7553" data-belowelement="comment-603104" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-604974" class="comment odd alt depth-3">

	      	<div id="li-comment-604974" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/128106f41a3e52c597dcce96cc5e484b9b529215bf5566f8846c14b47f4b6e9a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/128106f41a3e52c597dcce96cc5e484b9b529215bf5566f8846c14b47f4b6e9a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Venkat</span>
	                <span class="date">April 15, 2021 at 4:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-604974" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the reply!! I was seeing the same data is passed (testX, testY) for both fit and evaluate calls for validation. As a result, the return object from fit call already has the data to be returned by the evaluate call. Am I making sense?</p>
<p># fit model<br />
history = model.fit(trainX, trainY, epochs=10, batch_size=32, validation_data=(testX, testY), verbose=0)<br />
# evaluate model<br />
_, acc = model.evaluate(testX, testY, verbose=0)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-604974" data-commentid="604974" data-postid="7553" data-belowelement="comment-604974" data-respondelement="respond" data-replyto="Reply to Venkat" aria-label="Reply to Venkat">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-605003" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-605003" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">April 15, 2021 at 5:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-605003" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Generally it is not a good idea to use test data as validation, I do to keep the examples simple.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-605003" data-commentid="605003" data-postid="7553" data-belowelement="comment-605003" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-603436" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-603436" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a73c607f15a504692614e4d13d08cc5a4cf49bd9033a5834b40dd8a7c833a7a3?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a73c607f15a504692614e4d13d08cc5a4cf49bd9033a5834b40dd8a7c833a7a3?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Berke</span>
	                <span class="date">April 4, 2021 at 9:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-603436" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, thanks for this great tutorial!</p>
<p>I don&#8217;t get why we don&#8217;t use the models that we created during the k-fold. I was expecting something like we combine this k models results into one single model and save it. If we don&#8217;t do that how&#8217;s that useful?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-603436" data-commentid="603436" data-postid="7553" data-belowelement="comment-603436" data-respondelement="respond" data-replyto="Reply to Berke" aria-label="Reply to Berke">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-603478" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-603478" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">April 5, 2021 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-603478" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Models created during k-fold cross-validation are discarded. They are only used to estimate the performance of the model/pipeline on unseen examples.</p>
<p>Once we choose a configuration, we can fit a final model on all data and use it to make predictions on new examples:<br />
<a href="https://machinelearningmastery.com/train-final-machine-learning-model/" rel="ugc">https://machinelearningmastery.com/train-final-machine-learning-model/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-603478" data-commentid="603478" data-postid="7553" data-belowelement="comment-603478" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-605099" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-605099" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/c6435aa97c6e1e6d6307975e2a08c73cdff5f2048e90170a2d350b31afeb4713?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c6435aa97c6e1e6d6307975e2a08c73cdff5f2048e90170a2d350b31afeb4713?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vishwa</span>
	                <span class="date">April 15, 2021 at 9:38 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-605099" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks a lot Jason  !!! This tutorial was very very helpful and it solved half of my project problems !!! Thanks a lot again !..</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-605099" data-commentid="605099" data-postid="7553" data-belowelement="comment-605099" data-respondelement="respond" data-replyto="Reply to Vishwa" aria-label="Reply to Vishwa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-605169" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-605169" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">April 16, 2021 at 5:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-605169" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-605169" data-commentid="605169" data-postid="7553" data-belowelement="comment-605169" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-612667" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-612667" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/35551b3932260bcaa5f61dcb4f4568d0bcc29edd4cdbf040ec5ba7844b59bc40?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/35551b3932260bcaa5f61dcb4f4568d0bcc29edd4cdbf040ec5ba7844b59bc40?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">ismail</span>
	                <span class="date">June 9, 2021 at 8:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-612667" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for the great tutorial. Is it possible to use it with a webcam for recognition task?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-612667" data-commentid="612667" data-postid="7553" data-belowelement="comment-612667" data-respondelement="respond" data-replyto="Reply to ismail" aria-label="Reply to ismail">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-612731" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-612731" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">June 10, 2021 at 5:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-612731" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try it and see.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-612731" data-commentid="612731" data-postid="7553" data-belowelement="comment-612731" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-612968" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-612968" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/10569c37dfc23ad8275fd452a93501448945eedb8e2960384f26944e32fc7f00?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/10569c37dfc23ad8275fd452a93501448945eedb8e2960384f26944e32fc7f00?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Taylor Rayne</span>
	                <span class="date">June 12, 2021 at 12:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-612968" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello! Thank you Jason for this amazing resource. I am currently working on a rented computer from school &#8211; do you think I could do implement this code in CoLabs?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-612968" data-commentid="612968" data-postid="7553" data-belowelement="comment-612968" data-respondelement="respond" data-replyto="Reply to Taylor Rayne" aria-label="Reply to Taylor Rayne">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-613019" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-613019" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">June 13, 2021 at 5:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-613019" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome.</p>
<p>Good question, see this:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/do-code-examples-run-on-google-colab" rel="ugc">https://machinelearningmastery.com/faq/single-faq/do-code-examples-run-on-google-colab</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-613019" data-commentid="613019" data-postid="7553" data-belowelement="comment-613019" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-613234" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-613234" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8cf833c4eec4ccfdb8c0a8d88f155a20b1719f59682a2e017592030c82212a85?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8cf833c4eec4ccfdb8c0a8d88f155a20b1719f59682a2e017592030c82212a85?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Manal</span>
	                <span class="date">June 15, 2021 at 4:14 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-613234" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br />
Thank you very much<br />
If possible, advise on the implementation HMM.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-613234" data-commentid="613234" data-postid="7553" data-belowelement="comment-613234" data-respondelement="respond" data-replyto="Reply to Manal" aria-label="Reply to Manal">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-613298" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-613298" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">June 16, 2021 at 6:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-613298" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the suggestion, perhaps in the future.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-613298" data-commentid="613298" data-postid="7553" data-belowelement="comment-613298" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-613257" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-613257" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/348728378d986d39a8130644964c54068252bcbefcc802a20726d071d23432c8?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/348728378d986d39a8130644964c54068252bcbefcc802a20726d071d23432c8?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">amberbir</span>
	                <span class="date">June 15, 2021 at 11:11 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-613257" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>i am developing a model of handwritten character recognition but the accuracy is very low i think it is not only because i have a small datatset, there is something i am not understanding can u help me on the improvement</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-613257" data-commentid="613257" data-postid="7553" data-belowelement="comment-613257" data-respondelement="respond" data-replyto="Reply to amberbir" aria-label="Reply to amberbir">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-613307" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-613307" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">June 16, 2021 at 6:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-613307" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try some of these suggestions:<br />
<a href="https://machinelearningmastery.com/improve-deep-learning-performance/" rel="ugc">https://machinelearningmastery.com/improve-deep-learning-performance/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-613307" data-commentid="613307" data-postid="7553" data-belowelement="comment-613307" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-615857" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-615857" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8b53d868ecc8fd990ebc76c79adb385637715c990d397306987b509fe2ebeeaf?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8b53d868ecc8fd990ebc76c79adb385637715c990d397306987b509fe2ebeeaf?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shri</span>
	                <span class="date">July 8, 2021 at 11:15 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-615857" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can I use this code for any character dataset ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-615857" data-commentid="615857" data-postid="7553" data-belowelement="comment-615857" data-respondelement="respond" data-replyto="Reply to Shri" aria-label="Reply to Shri">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-615892" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-615892" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">July 9, 2021 at 5:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-615892" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try it and see.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-615892" data-commentid="615892" data-postid="7553" data-belowelement="comment-615892" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-620862" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-620862" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/afb4f4bf0ea37d0a01a8a3f1b70f29e2f16e18f1bdf8b9a3502e8d60aca8aab6?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/afb4f4bf0ea37d0a01a8a3f1b70f29e2f16e18f1bdf8b9a3502e8d60aca8aab6?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://jhss.scholasticahq.com" class="url" rel="ugc external nofollow">Shireesh Apte</a></span>
	                <span class="date">August 8, 2021 at 8:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-620862" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Could you provide a peer review for a manuscript that has been submitted to the Journal  of High School Science (<a href="http://jhss.scholasticahq.com" rel="nofollow ugc">http://jhss.scholasticahq.com</a>) ? The title of the manuscript is : Implementing a Quantum Convolutional Neural Network for Efficient Image Recognition. Abstract: Machine learning has many real-world applications ranging from modeling the universe to computational chemistry. As probability is the bedrock for machine learning, it is essential to optimize both hardware and software to obtain the best results. Classical computers are generally used for machine learning programs. However, learning from high-dimensional data often demands excessive compute time and power, and it may not achieve the highest accuracy. The Quantum Computing environment can be utilized to create a more accurate model than that created via classical computing. To test this quantum advantage, we implemented a Quantum Convolutional Neural Network (QCNN), which parallels the structure of the classical Convolution Neural Network (CNN) in the quantum domain. Due to the lack of quantum computers with many qubits, physicists, namely John Preskill, have introduced the Noisy Intermediate Scale Quantum (NISQ) concept, which constitutes a hybrid interface between classical and quantum computers. In the context of QCNN, the data processing and the cost function optimization would be performed on the classical computer, while the probabilities generated by the Variational Quantum Circuits (VQC) would be evaluated on the quantum computer. The QCNN consists of a classical-to-quantum data encoder, a cluster state quantum circuit to entangle qubit states, a series of Variational Quantum Circuits using Quantum Convolutional and Pooling Layers for efficient feature extraction, a quantum-to-classical data decoder, which would lead to the output. Both the CNN and the QCNN extract features from data like 2D images, and performances can be compared using metrics like accuracy and time.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-620862" data-commentid="620862" data-postid="7553" data-belowelement="comment-620862" data-respondelement="respond" data-replyto="Reply to Shireesh Apte" aria-label="Reply to Shireesh Apte">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-620962" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-620962" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5f1c8e7a708d04b1bd173e9120107d3fd43d8fad5be7c94796b877515b6d0357?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com" class="url" rel="ugc">Jason Brownlee</a></span>
	                <span class="date">August 9, 2021 at 5:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-620962" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry I cannot peer review your manuscript.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-620962" data-commentid="620962" data-postid="7553" data-belowelement="comment-620962" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-626421" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-626421" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/17453fa014e0e592f86328c69b3b8bb1e9386ac7a78c1b40d2d0fb6b14061560?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/17453fa014e0e592f86328c69b3b8bb1e9386ac7a78c1b40d2d0fb6b14061560?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">nbe</span>
	                <span class="date">September 11, 2021 at 6:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-626421" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>what if we are asked to design a project to identify digit classification from MNIST using classification algorithm should we use the above oen</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-626421" data-commentid="626421" data-postid="7553" data-belowelement="comment-626421" data-respondelement="respond" data-replyto="Reply to nbe" aria-label="Reply to nbe">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-626695" class="comment byuser comment-author-adriantam even depth-2">

	      	<div id="li-comment-626695" class="comment-container">

					                <div class="avatar"><img src="https://machinelearningmastery.com/wp-content/uploads/2024/04/adrian-e1713809353338-150x150.jpeg" width="40" height="40" srcset="https://machinelearningmastery.com/wp-content/uploads/2024/04/adrian-e1713809353338-150x150.jpeg 2x" alt="Adrian Tam" class="avatar avatar-40 wp-user-avatar wp-user-avatar-40 alignnone photo" /></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adrian Tam</span>
	                <span class="date">September 14, 2021 at 1:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-626695" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-626695" data-commentid="626695" data-postid="7553" data-belowelement="comment-626695" data-respondelement="respond" data-replyto="Reply to Adrian Tam" aria-label="Reply to Adrian Tam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-637837" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-637837" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/e965524ca3b0e28bdc74bce186ab07d1de8aed24c3fe62ab7dcc206011d0ee89?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e965524ca3b0e28bdc74bce186ab07d1de8aed24c3fe62ab7dcc206011d0ee89?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abhi</span>
	                <span class="date">November 12, 2021 at 11:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-637837" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Wonderful tutorial!!</p>
<p>When i implemented the code i got this error &#8221; AttributeError: &#8216;Sequential&#8217; object has no attribute &#8216;predict_classes&#8217; &#8221;<br />
Any suggestions to rectify this error please?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-637837" data-commentid="637837" data-postid="7553" data-belowelement="comment-637837" data-respondelement="respond" data-replyto="Reply to Abhi" aria-label="Reply to Abhi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-638396" class="comment byuser comment-author-adriantam even depth-2">

	      	<div id="li-comment-638396" class="comment-container">

					                <div class="avatar"><img src="https://machinelearningmastery.com/wp-content/uploads/2024/04/adrian-e1713809353338-150x150.jpeg" width="40" height="40" srcset="https://machinelearningmastery.com/wp-content/uploads/2024/04/adrian-e1713809353338-150x150.jpeg 2x" alt="Adrian Tam" class="avatar avatar-40 wp-user-avatar wp-user-avatar-40 alignnone photo" /></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adrian Tam</span>
	                <span class="date">November 14, 2021 at 2:27 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-638396" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p></p>
		<div id="urvanov-syntax-highlighter-6808fcc2e2829280469511" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from numpy import argmax

pred_value = model.predict(img)
digit = argmax(pred_value)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2e2829280469511-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2e2829280469511-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6808fcc2e2829280469511-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6808fcc2e2829280469511-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2e2829280469511-1"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">argmax</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2e2829280469511-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6808fcc2e2829280469511-3"><span class="crayon-v">pred_value</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">img</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6808fcc2e2829280469511-4"><span class="crayon-v">digit</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">argmax</span><span class="crayon-sy">(</span><span class="crayon-v">pred_value</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-638396" data-commentid="638396" data-postid="7553" data-belowelement="comment-638396" data-respondelement="respond" data-replyto="Reply to Adrian Tam" aria-label="Reply to Adrian Tam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-638994" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-638994" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8a4e64448d9f53a246129fa1797b89234a77c10ca180961b5457ae3a55eb4f4a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8a4e64448d9f53a246129fa1797b89234a77c10ca180961b5457ae3a55eb4f4a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Annya Karn</span>
	                <span class="date">November 17, 2021 at 12:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-638994" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I used this model as an example and when I fed it a handwritten number, it continuously gave wrong predictions. Can you please tell me what could possibly be the problem?<br />
It reads accurately when I used printed numbers with black background.<br />
I did however  change the cnn model a little bit to make it Multiple Pooling model.<br />
I can share the code as well, if you like.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-638994" data-commentid="638994" data-postid="7553" data-belowelement="comment-638994" data-respondelement="respond" data-replyto="Reply to Annya Karn" aria-label="Reply to Annya Karn">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-639063" class="comment byuser comment-author-adriantam even depth-2">

	      	<div id="li-comment-639063" class="comment-container">

					                <div class="avatar"><img src="https://machinelearningmastery.com/wp-content/uploads/2024/04/adrian-e1713809353338-150x150.jpeg" width="40" height="40" srcset="https://machinelearningmastery.com/wp-content/uploads/2024/04/adrian-e1713809353338-150x150.jpeg 2x" alt="Adrian Tam" class="avatar avatar-40 wp-user-avatar wp-user-avatar-40 alignnone photo" /></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adrian Tam</span>
	                <span class="date">November 17, 2021 at 6:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-639063" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can&#8217;t tell because I didn&#8217;t see your handwriting. But this MNIST dataset is a 28&#215;28 pixel grayscale with white on black. Try to mimick this set up and it should be much better. If your image is more complex (e.g., you scan it, then the background is not a single color, or the alphabet is more complicated with more strokes than digits) then you will need a larger network to recognize it.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-639063" data-commentid="639063" data-postid="7553" data-belowelement="comment-639063" data-respondelement="respond" data-replyto="Reply to Adrian Tam" aria-label="Reply to Adrian Tam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-640530" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-640530" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/47c10721230d23057bce9fcc9fdbd4a5d5710b9822001f147ee22ca2bed6fd58?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/47c10721230d23057bce9fcc9fdbd4a5d5710b9822001f147ee22ca2bed6fd58?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Louca</span>
	                <span class="date">November 23, 2021 at 12:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-640530" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You mention in other answers that the inputs have to be reshaped because the convolutional layers expect an input with a dimension for channels. Do you know if this is unique to keras?</p>
<p>I am trying to classify 56&#215;56 grayscale images (0-&gt;255), and so far I have normalized them to [-1,1]. However, they are still 2D as a 56&#215;56 matrix. I am using pytorch. Do you know if I would also need to reshape them to add the single channel?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-640530" data-commentid="640530" data-postid="7553" data-belowelement="comment-640530" data-respondelement="respond" data-replyto="Reply to Louca" aria-label="Reply to Louca">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-640581" class="comment byuser comment-author-adriantam even depth-2">

	      	<div id="li-comment-640581" class="comment-container">

					                <div class="avatar"><img src="https://machinelearningmastery.com/wp-content/uploads/2024/04/adrian-e1713809353338-150x150.jpeg" width="40" height="40" srcset="https://machinelearningmastery.com/wp-content/uploads/2024/04/adrian-e1713809353338-150x150.jpeg 2x" alt="Adrian Tam" class="avatar avatar-40 wp-user-avatar wp-user-avatar-40 alignnone photo" /></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adrian Tam</span>
	                <span class="date">November 23, 2021 at 1:40 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-640581" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Depends on the way you construct the model, it may or may not necessary.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-640581" data-commentid="640581" data-postid="7553" data-belowelement="comment-640581" data-respondelement="respond" data-replyto="Reply to Adrian Tam" aria-label="Reply to Adrian Tam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-641814" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-641814" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/50f1fb16266f011d7f63ad9506c99991963fb3e4eeecc32c39c1fd45de9761cd?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/50f1fb16266f011d7f63ad9506c99991963fb3e4eeecc32c39c1fd45de9761cd?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Patrick Wood</span>
	                <span class="date">November 29, 2021 at 5:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-641814" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Why are there two copies of the 64-filter conv2D in the &#8220;Increase Model Depth&#8221; section:</p>
<p>model.add(Conv2D(64, (3, 3), activation=&#8217;relu&#8217;, kernel_initializer=&#8217;he_uniform&#8217;))</p>
<p>I tried this model with both one and two of these layers and got the same results.</p>
<p>As a side note, I did increase the number of epochs to 15 and saw a slight improvement to both the accuracy mean and std deviation.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-641814" data-commentid="641814" data-postid="7553" data-belowelement="comment-641814" data-respondelement="respond" data-replyto="Reply to Patrick Wood" aria-label="Reply to Patrick Wood">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-641846" class="comment byuser comment-author-adriantam even depth-2">

	      	<div id="li-comment-641846" class="comment-container">

					                <div class="avatar"><img src="https://machinelearningmastery.com/wp-content/uploads/2024/04/adrian-e1713809353338-150x150.jpeg" width="40" height="40" srcset="https://machinelearningmastery.com/wp-content/uploads/2024/04/adrian-e1713809353338-150x150.jpeg 2x" alt="Adrian Tam" class="avatar avatar-40 wp-user-avatar wp-user-avatar-40 alignnone photo" /></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adrian Tam</span>
	                <span class="date">November 29, 2021 at 8:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-641846" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If you see no difference for more layers, try to stay with the fewer layers one because it save time and memory.<br />
Increasing epochs can help train better, but you may also run into overfitting. So you need to check with validation set to confirm about the &#8220;improvement&#8221;.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-641846" data-commentid="641846" data-postid="7553" data-belowelement="comment-641846" data-respondelement="respond" data-replyto="Reply to Adrian Tam" aria-label="Reply to Adrian Tam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-641986" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-641986" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/50f1fb16266f011d7f63ad9506c99991963fb3e4eeecc32c39c1fd45de9761cd?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/50f1fb16266f011d7f63ad9506c99991963fb3e4eeecc32c39c1fd45de9761cd?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Patrick Wood</span>
	                <span class="date">November 30, 2021 at 5:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-641986" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I tried up to 25 epochs and looked at the loss with verbose=1 in the model.fit call.  The loss bottoms out at around 20 epochs and then bounces around after that.</p>
<p>Here&#8217;s one run from epoch 10 through 25.  The model got 99.260% on the test set:</p>
<p>Epoch 10/25<br />
1875/1875 [==============================] &#8211; 6s 3ms/step &#8211; loss: 0.0079 &#8211; accuracy: 0.9972<br />
Epoch 11/25<br />
1875/1875 [==============================] &#8211; 6s 3ms/step &#8211; loss: 0.0061 &#8211; accuracy: 0.9980<br />
Epoch 12/25<br />
1875/1875 [==============================] &#8211; 6s 3ms/step &#8211; loss: 0.0060 &#8211; accuracy: 0.9980<br />
Epoch 13/25<br />
1875/1875 [==============================] &#8211; 6s 3ms/step &#8211; loss: 0.0058 &#8211; accuracy: 0.9978<br />
Epoch 14/25<br />
1875/1875 [==============================] &#8211; 6s 3ms/step &#8211; loss: 0.0045 &#8211; accuracy: 0.9984<br />
Epoch 15/25<br />
1875/1875 [==============================] &#8211; 6s 3ms/step &#8211; loss: 0.0042 &#8211; accuracy: 0.9987<br />
Epoch 16/25<br />
1875/1875 [==============================] &#8211; 6s 3ms/step &#8211; loss: 0.0035 &#8211; accuracy: 0.9988<br />
Epoch 17/25<br />
1875/1875 [==============================] &#8211; 6s 3ms/step &#8211; loss: 0.0031 &#8211; accuracy: 0.9991<br />
Epoch 18/25<br />
1875/1875 [==============================] &#8211; 6s 3ms/step &#8211; loss: 0.0024 &#8211; accuracy: 0.9992<br />
Epoch 19/25<br />
1875/1875 [==============================] &#8211; 6s 3ms/step &#8211; loss: 0.0026 &#8211; accuracy: 0.9993<br />
Epoch 20/25<br />
1875/1875 [==============================] &#8211; 6s 3ms/step &#8211; loss: 0.0020 &#8211; accuracy: 0.9994<br />
Epoch 21/25<br />
1875/1875 [==============================] &#8211; 6s 3ms/step &#8211; loss: 0.0020 &#8211; accuracy: 0.9994<br />
Epoch 22/25<br />
1875/1875 [==============================] &#8211; 7s 3ms/step &#8211; loss: 0.0027 &#8211; accuracy: 0.9991<br />
Epoch 23/25<br />
1875/1875 [==============================] &#8211; 6s 3ms/step &#8211; loss: 0.0032 &#8211; accuracy: 0.9989<br />
Epoch 24/25<br />
1875/1875 [==============================] &#8211; 6s 3ms/step &#8211; loss: 0.0022 &#8211; accuracy: 0.9993<br />
Epoch 25/25<br />
1875/1875 [==============================] &#8211; 6s 3ms/step &#8211; loss: 0.0020 &#8211; accuracy: 0.9993<br />
&gt; 99.260</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-641986" data-commentid="641986" data-postid="7553" data-belowelement="comment-641986" data-respondelement="respond" data-replyto="Reply to Patrick Wood" aria-label="Reply to Patrick Wood">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-642339" class="comment byuser comment-author-adriantam even depth-2">

	      	<div id="li-comment-642339" class="comment-container">

					                <div class="avatar"><img src="https://machinelearningmastery.com/wp-content/uploads/2024/04/adrian-e1713809353338-150x150.jpeg" width="40" height="40" srcset="https://machinelearningmastery.com/wp-content/uploads/2024/04/adrian-e1713809353338-150x150.jpeg 2x" alt="Adrian Tam" class="avatar avatar-40 wp-user-avatar wp-user-avatar-40 alignnone photo" /></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adrian Tam</span>
	                <span class="date">December 2, 2021 at 1:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-642339" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not bad a result here!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-642339" data-commentid="642339" data-postid="7553" data-belowelement="comment-642339" data-respondelement="respond" data-replyto="Reply to Adrian Tam" aria-label="Reply to Adrian Tam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-642367" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-642367" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/50f1fb16266f011d7f63ad9506c99991963fb3e4eeecc32c39c1fd45de9761cd?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/50f1fb16266f011d7f63ad9506c99991963fb3e4eeecc32c39c1fd45de9761cd?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Patrick Wood</span>
	                <span class="date">December 2, 2021 at 3:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-642367" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>These guys: <a href="https://arxiv.org/pdf/2008.10400v2.pdf" rel="nofollow ugc">https://arxiv.org/pdf/2008.10400v2.pdf</a> are getting 99.91% accuracy using a combination of fairly simple techniques: deeper model depth, increased convolution kernel size, data augmentation, batch normalization between all conv2D layers, disabling edge padding in the convolution output to reduce the map sizes between conv2D layers instead of max pooling (which I found quite elegant), and voting between multiple models.  They do a good job of analyzing each technique and comparing the results to other common CNNs.</p>
<p>They&#8217;re currently at the top of the rankings here: <a href="https://paperswithcode.com/sota/image-classification-on-mnist" rel="nofollow ugc">https://paperswithcode.com/sota/image-classification-on-mnist</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-642367" data-commentid="642367" data-postid="7553" data-belowelement="comment-642367" data-respondelement="respond" data-replyto="Reply to Patrick Wood" aria-label="Reply to Patrick Wood">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-642372" class="comment byuser comment-author-adriantam even depth-2">

	      	<div id="li-comment-642372" class="comment-container">

					                <div class="avatar"><img src="https://machinelearningmastery.com/wp-content/uploads/2024/04/adrian-e1713809353338-150x150.jpeg" width="40" height="40" srcset="https://machinelearningmastery.com/wp-content/uploads/2024/04/adrian-e1713809353338-150x150.jpeg 2x" alt="Adrian Tam" class="avatar avatar-40 wp-user-avatar wp-user-avatar-40 alignnone photo" /></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adrian Tam</span>
	                <span class="date">December 2, 2021 at 3:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-642372" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for sharing.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-642372" data-commentid="642372" data-postid="7553" data-belowelement="comment-642372" data-respondelement="respond" data-replyto="Reply to Adrian Tam" aria-label="Reply to Adrian Tam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-642752" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-642752" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/50f1fb16266f011d7f63ad9506c99991963fb3e4eeecc32c39c1fd45de9761cd?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/50f1fb16266f011d7f63ad9506c99991963fb3e4eeecc32c39c1fd45de9761cd?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Patrick Wood</span>
	                <span class="date">December 4, 2021 at 4:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-642752" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>So during training, the model accuracy against the training data goes over 99.9%, but the final accuracy on the test data is 99.26%.  Are these results close enough that I can assume the model isn&#8217;t over trained?  What&#8217;s a reasonable difference when both values are over 99%?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-642752" data-commentid="642752" data-postid="7553" data-belowelement="comment-642752" data-respondelement="respond" data-replyto="Reply to Patrick Wood" aria-label="Reply to Patrick Wood">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-643401" class="comment byuser comment-author-adriantam even depth-2">

	      	<div id="li-comment-643401" class="comment-container">

					                <div class="avatar"><img src="https://machinelearningmastery.com/wp-content/uploads/2024/04/adrian-e1713809353338-150x150.jpeg" width="40" height="40" srcset="https://machinelearningmastery.com/wp-content/uploads/2024/04/adrian-e1713809353338-150x150.jpeg 2x" alt="Adrian Tam" class="avatar avatar-40 wp-user-avatar wp-user-avatar-40 alignnone photo" /></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adrian Tam</span>
	                <span class="date">December 8, 2021 at 7:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-643401" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can&#8217;t give you any general guidance on what is reasonable or not. But at >99% accuracy, I would assume it is good enough for this purpose.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-643401" data-commentid="643401" data-postid="7553" data-belowelement="comment-643401" data-respondelement="respond" data-replyto="Reply to Adrian Tam" aria-label="Reply to Adrian Tam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-646164" class="comment byuser comment-author-jamespcarmichael odd alt depth-2">

	      	<div id="li-comment-646164" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">James Carmichael</span>
	                <span class="date">December 22, 2021 at 9:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-646164" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Patrick&#8230;The following resource will provide you insight into how to avoid overfitting in deep neural networks.</p>
<p><a href="https://machinelearningmastery.com/introduction-to-regularization-to-reduce-overfitting-and-improve-generalization-error/" rel="ugc">https://machinelearningmastery.com/introduction-to-regularization-to-reduce-overfitting-and-improve-generalization-error/</a></p>
<p>Regards,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-646164" data-commentid="646164" data-postid="7553" data-belowelement="comment-646164" data-respondelement="respond" data-replyto="Reply to James Carmichael" aria-label="Reply to James Carmichael">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-649058" class="comment even thread-even depth-1">

	      	<div id="li-comment-649058" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/18b117c1ec1f57fc43e047657425ccdf2222c7410a017c00245db975240b0908?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/18b117c1ec1f57fc43e047657425ccdf2222c7410a017c00245db975240b0908?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Andrew Odion</span>
	                <span class="date">January 1, 2022 at 11:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-649058" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-649058" data-commentid="649058" data-postid="7553" data-belowelement="comment-649058" data-respondelement="respond" data-replyto="Reply to Andrew Odion" aria-label="Reply to Andrew Odion">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-649137" class="comment byuser comment-author-jamespcarmichael odd alt depth-2">

	      	<div id="li-comment-649137" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">James Carmichael</span>
	                <span class="date">January 2, 2022 at 8:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-649137" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You are very welcome Andrew!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-649137" data-commentid="649137" data-postid="7553" data-belowelement="comment-649137" data-respondelement="respond" data-replyto="Reply to James Carmichael" aria-label="Reply to James Carmichael">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-649373" class="comment byuser comment-author-jamespcarmichael even depth-2">

	      	<div id="li-comment-649373" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">James Carmichael</span>
	                <span class="date">January 3, 2022 at 8:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-649373" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You are very welcome, Andrew!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-649373" data-commentid="649373" data-postid="7553" data-belowelement="comment-649373" data-respondelement="respond" data-replyto="Reply to James Carmichael" aria-label="Reply to James Carmichael">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-650008" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-650008" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9425ec4ee201207765c5866850b507428b649b8d3eb89d631cdc215a2841b2a3?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9425ec4ee201207765c5866850b507428b649b8d3eb89d631cdc215a2841b2a3?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gilad</span>
	                <span class="date">January 8, 2022 at 5:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-650008" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,<br />
I don&#8217;t know if you will ever see it but if you reply I will thank you, I wanted to try by myself this code because I was hoping to learn more about neural networks.<br />
Unfortunately, I gave Python a picture I made in paint (the computer application) this image was resized to 28*28 and the picture is seen, I checked it.<br />
In the picture, I drew the number 2, and it said that it is four and I tried more unsuccessfully.<br />
I&#8217;d like to know where is the problem.</p>
<p>Anyway if you can reply to me in E-mail I will thank you in order to check wether the problem is in the picture or the code.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-650008" data-commentid="650008" data-postid="7553" data-belowelement="comment-650008" data-respondelement="respond" data-replyto="Reply to Gilad" aria-label="Reply to Gilad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-650046" class="comment byuser comment-author-jamespcarmichael even depth-2">

	      	<div id="li-comment-650046" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">James Carmichael</span>
	                <span class="date">January 8, 2022 at 10:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-650046" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Gilad&#8230;Have you checked the overall accuracy of your model?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-650046" data-commentid="650046" data-postid="7553" data-belowelement="comment-650046" data-respondelement="respond" data-replyto="Reply to James Carmichael" aria-label="Reply to James Carmichael">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-650217" class="comment odd alt depth-3">

	      	<div id="li-comment-650217" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9425ec4ee201207765c5866850b507428b649b8d3eb89d631cdc215a2841b2a3?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9425ec4ee201207765c5866850b507428b649b8d3eb89d631cdc215a2841b2a3?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gilad</span>
	                <span class="date">January 9, 2022 at 10:13 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-650217" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, the accuracy was 96 percent, this is the reason I find it awkward.<br />
I am not sure whether the problem is in the picture but I&#8217;d like to know where is the problem.<br />
Can I send you the picture that I used? maybe the problem is located there.<br />
Anyway, thanks for the help.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-650217" data-commentid="650217" data-postid="7553" data-belowelement="comment-650217" data-respondelement="respond" data-replyto="Reply to Gilad" aria-label="Reply to Gilad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-650220" class="comment even depth-4">

	      	<div id="li-comment-650220" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9425ec4ee201207765c5866850b507428b649b8d3eb89d631cdc215a2841b2a3?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9425ec4ee201207765c5866850b507428b649b8d3eb89d631cdc215a2841b2a3?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gilad</span>
	                <span class="date">January 9, 2022 at 10:29 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-650220" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>99.140 is my right accuracy, sorry for the earlier mistake.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-650220" data-commentid="650220" data-postid="7553" data-belowelement="comment-650220" data-respondelement="respond" data-replyto="Reply to Gilad" aria-label="Reply to Gilad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-650235" class="comment odd alt depth-5">

	      	<div id="li-comment-650235" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9425ec4ee201207765c5866850b507428b649b8d3eb89d631cdc215a2841b2a3?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9425ec4ee201207765c5866850b507428b649b8d3eb89d631cdc215a2841b2a3?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gilad</span>
	                <span class="date">January 10, 2022 at 2:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-650235" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>James thanks a lot it finally worked, my picture was not good.<br />
I drew the digits in black and the background was white, and this is not the way the computer was trained.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-650274" class="comment byuser comment-author-jamespcarmichael even depth-5">

	      	<div id="li-comment-650274" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">James Carmichael</span>
	                <span class="date">January 10, 2022 at 11:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-650274" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for the feedback Gilad!  Keep up the great work!</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-662023" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-662023" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/6566e6e9b79fb2990adfed0ec0eadb9ea658c874183b3f224bc97878941c821f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6566e6e9b79fb2990adfed0ec0eadb9ea658c874183b3f224bc97878941c821f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anbu</span>
	                <span class="date">March 29, 2022 at 5:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-662023" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This, according to me, is the best tutorial I have ever gone through. It helped me understand CNN in my very first attempt. Thank you, Dear James.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-662023" data-commentid="662023" data-postid="7553" data-belowelement="comment-662023" data-respondelement="respond" data-replyto="Reply to Anbu" aria-label="Reply to Anbu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-662078" class="comment byuser comment-author-jamespcarmichael even depth-2">

	      	<div id="li-comment-662078" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">James Carmichael</span>
	                <span class="date">March 30, 2022 at 3:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-662078" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for the feedback and support Anbu!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-662078" data-commentid="662078" data-postid="7553" data-belowelement="comment-662078" data-respondelement="respond" data-replyto="Reply to James Carmichael" aria-label="Reply to James Carmichael">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-667048" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-667048" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/29fd1567571d2219f29e74f99dd1c205e531a13d663bbe4d2910f541be1c4eba?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/29fd1567571d2219f29e74f99dd1c205e531a13d663bbe4d2910f541be1c4eba?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Viswa</span>
	                <span class="date">May 1, 2022 at 2:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-667048" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hello james,<br />
Great tutorial. I&#8217; getting &#8220;name &#8216;train&#8217; is not defined&#8221; as error while converting from integers to floats. can you please help me with that? Thank you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-667048" data-commentid="667048" data-postid="7553" data-belowelement="comment-667048" data-respondelement="respond" data-replyto="Reply to Viswa" aria-label="Reply to Viswa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-667206" class="comment byuser comment-author-jamespcarmichael even depth-2">

	      	<div id="li-comment-667206" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">James Carmichael</span>
	                <span class="date">May 2, 2022 at 9:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-667206" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Viswa&#8230;Thank you for the feedback!  Did you copy and paste the code or type it in?  There could be an issue related to copying and pasting the code.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-667206" data-commentid="667206" data-postid="7553" data-belowelement="comment-667206" data-respondelement="respond" data-replyto="Reply to James Carmichael" aria-label="Reply to James Carmichael">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-667366" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-667366" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/29fd1567571d2219f29e74f99dd1c205e531a13d663bbe4d2910f541be1c4eba?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/29fd1567571d2219f29e74f99dd1c205e531a13d663bbe4d2910f541be1c4eba?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Viswa</span>
	                <span class="date">May 3, 2022 at 1:06 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-667366" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Oh! I got it. Thank you so much for tutorial, I&#8217;ve learned a lot from you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-667366" data-commentid="667366" data-postid="7553" data-belowelement="comment-667366" data-respondelement="respond" data-replyto="Reply to Viswa" aria-label="Reply to Viswa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-667452" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-667452" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/29fd1567571d2219f29e74f99dd1c205e531a13d663bbe4d2910f541be1c4eba?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/29fd1567571d2219f29e74f99dd1c205e531a13d663bbe4d2910f541be1c4eba?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Viswa</span>
	                <span class="date">May 4, 2022 at 6:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-667452" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can you please elaborate on why a dense layer with specifically 100 nodes is used to develop a baseline model?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-667452" data-commentid="667452" data-postid="7553" data-belowelement="comment-667452" data-respondelement="respond" data-replyto="Reply to Viswa" aria-label="Reply to Viswa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-668132" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-668132" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/ba2d8f011fe84517cb6c751612fc57ca8d7d9d5312282fe7fa7bd36c904e09ff?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ba2d8f011fe84517cb6c751612fc57ca8d7d9d5312282fe7fa7bd36c904e09ff?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Carde</span>
	                <span class="date">May 9, 2022 at 6:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-668132" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>train_norm = train.astype(&#8216;float32&#8217;)</p>
<p>Hi Jason, from which library this method come from?<br />
Cause train is not defined in your code and I want to see how the method works.</p>
<p>train_norm = train.astype(&#8216;float32&#8217;)<br />
NameError: name &#8216;train&#8217; is not defined</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-668132" data-commentid="668132" data-postid="7553" data-belowelement="comment-668132" data-respondelement="respond" data-replyto="Reply to Carde" aria-label="Reply to Carde">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-668226" class="comment byuser comment-author-jamespcarmichael even depth-2">

	      	<div id="li-comment-668226" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">James Carmichael</span>
	                <span class="date">May 10, 2022 at 12:13 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-668226" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Carde&#8230;Please see the complete code listing near the end of the tutorial.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-668226" data-commentid="668226" data-postid="7553" data-belowelement="comment-668226" data-respondelement="respond" data-replyto="Reply to James Carmichael" aria-label="Reply to James Carmichael">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-668575" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-668575" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8166a7b3f57f6365700c8b1a89f141f37054ffe73e70ce29654783bf6bad6992?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8166a7b3f57f6365700c8b1a89f141f37054ffe73e70ce29654783bf6bad6992?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Suhas</span>
	                <span class="date">May 12, 2022 at 6:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-668575" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is it okay to add dropout() to the digit classification model, because I got the best accuracy when I use the dropout.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-668575" data-commentid="668575" data-postid="7553" data-belowelement="comment-668575" data-respondelement="respond" data-replyto="Reply to Suhas" aria-label="Reply to Suhas">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-668680" class="comment byuser comment-author-jamespcarmichael even depth-2">

	      	<div id="li-comment-668680" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">James Carmichael</span>
	                <span class="date">May 13, 2022 at 12:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-668680" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Suhas&#8230;Yes, that approach is a reasonable one and it is great to know you were able to improve your model accuracy!  Dropout is definitely beneficial to avoid overtraining.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-668680" data-commentid="668680" data-postid="7553" data-belowelement="comment-668680" data-respondelement="respond" data-replyto="Reply to James Carmichael" aria-label="Reply to James Carmichael">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-682790" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-682790" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/7a10358b5cf6b615df30601ed60d16253f2942f27d58cada97f6e18e2f7bb16e?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7a10358b5cf6b615df30601ed60d16253f2942f27d58cada97f6e18e2f7bb16e?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">abdool</span>
	                <span class="date">October 28, 2022 at 4:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-682790" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>where is the final code and the code testing result</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-682790" data-commentid="682790" data-postid="7553" data-belowelement="comment-682790" data-respondelement="respond" data-replyto="Reply to abdool" aria-label="Reply to abdool">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-682794" class="comment byuser comment-author-jamespcarmichael even depth-2">

	      	<div id="li-comment-682794" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">James Carmichael</span>
	                <span class="date">October 28, 2022 at 8:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-682794" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi abdool&#8230;The final code listing is provided in this post.  Is it not visible?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-682794" data-commentid="682794" data-postid="7553" data-belowelement="comment-682794" data-respondelement="respond" data-replyto="Reply to James Carmichael" aria-label="Reply to James Carmichael">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-684593" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-684593" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/6939464540afd11ae39559e47ef580144aabe9b70bf4f9ec94d157668b31bd33?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6939464540afd11ae39559e47ef580144aabe9b70bf4f9ec94d157668b31bd33?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ashbrocolli</span>
	                <span class="date">November 18, 2022 at 4:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-684593" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi, for the improved depth, how many hidden layers are involved?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-684593" data-commentid="684593" data-postid="7553" data-belowelement="comment-684593" data-respondelement="respond" data-replyto="Reply to Ashbrocolli" aria-label="Reply to Ashbrocolli">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-684600" class="comment byuser comment-author-jamespcarmichael even depth-2">

	      	<div id="li-comment-684600" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">James Carmichael</span>
	                <span class="date">November 18, 2022 at 6:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-684600" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Ashbrocolli&#8230;The layers can be found in the in section following the comment below:</p>
<p>&#8220;The complete code listing with this change is provided below.&#8221;</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-684600" data-commentid="684600" data-postid="7553" data-belowelement="comment-684600" data-respondelement="respond" data-replyto="Reply to James Carmichael" aria-label="Reply to James Carmichael">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-687509" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-687509" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/f4601a26501c394b032ccf1099d7328825a02a57069aca64d5ee17885d789fa2?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f4601a26501c394b032ccf1099d7328825a02a57069aca64d5ee17885d789fa2?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rabiaa CHARIJ</span>
	                <span class="date">November 30, 2022 at 8:03 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-687509" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello @James Carmichael, I wonder how the &#8220;to_categorical&#8221; works , I have seen documentation and it says if number of classes is not specified then this would be inferred as max(y) + 1 if y is a vector. So to my surprise ,I know that in the Mnist dataset the num classes is 10 but without specifiying this number as a parameter , the function returns a vector of shape (60 000,10) but how ? I would really like to know how this max(y)+1 would work on images and give the right num_classes that is 10.<br />
Thanks in advance for your answer.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-687509" data-commentid="687509" data-postid="7553" data-belowelement="comment-687509" data-respondelement="respond" data-replyto="Reply to Rabiaa CHARIJ" aria-label="Reply to Rabiaa CHARIJ">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-687519" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-687519" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/f4601a26501c394b032ccf1099d7328825a02a57069aca64d5ee17885d789fa2?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f4601a26501c394b032ccf1099d7328825a02a57069aca64d5ee17885d789fa2?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rabiaa CHARIJ</span>
	                <span class="date">November 30, 2022 at 8:29 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-687519" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry I figured it out, As &#8220;y&#8221; is a vector of labels from 0 to 9 so max(y)+1 would return 10 (num_classses),  which is obvious actually. I was Confused because I had an issue while printing &#8220;y&#8221; it didn&#8217;t show the expected values.<br />
Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-687519" data-commentid="687519" data-postid="7553" data-belowelement="comment-687519" data-respondelement="respond" data-replyto="Reply to Rabiaa CHARIJ" aria-label="Reply to Rabiaa CHARIJ">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-687626" class="comment byuser comment-author-jamespcarmichael odd alt depth-2">

	      	<div id="li-comment-687626" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">James Carmichael</span>
	                <span class="date">December 1, 2022 at 8:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-687626" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for the update Rabiaa!  Great work!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-687626" data-commentid="687626" data-postid="7553" data-belowelement="comment-687626" data-respondelement="respond" data-replyto="Reply to James Carmichael" aria-label="Reply to James Carmichael">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-710473" class="comment even thread-even depth-1">

	      	<div id="li-comment-710473" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/6d1316a9d53b4b2f47a100f280aafdb9f566b7170dd2080a83fbeb77a5769155?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6d1316a9d53b4b2f47a100f280aafdb9f566b7170dd2080a83fbeb77a5769155?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">CraneFrog</span>
	                <span class="date">March 1, 2024 at 9:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-710473" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Outdated tutorial. Would not recommend to beginners who are starting out. Over complicating things in modern age. Maybe at the time (5yrs ago!!!) this was fine but things can be done way more simpler and cleaner.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-710473" data-commentid="710473" data-postid="7553" data-belowelement="comment-710473" data-respondelement="respond" data-replyto="Reply to CraneFrog" aria-label="Reply to CraneFrog">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-710559" class="comment byuser comment-author-jamespcarmichael odd alt depth-2">

	      	<div id="li-comment-710559" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">James Carmichael</span>
	                <span class="date">March 2, 2024 at 1:09 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-710559" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for your feedback!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-710559" data-commentid="710559" data-postid="7553" data-belowelement="comment-710559" data-respondelement="respond" data-replyto="Reply to James Carmichael" aria-label="Reply to James Carmichael">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-722810" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-722810" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/fb23dee69887b5c6e07dd97da61807bd9e65212fb2e80c45a8ce2541dd4c8d82?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/fb23dee69887b5c6e07dd97da61807bd9e65212fb2e80c45a8ce2541dd4c8d82?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Zineb</span>
	                <span class="date">September 3, 2024 at 1:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-722810" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks a lot for this interesting work. </p>
<p>I plot the images after loading, reshaping, and normalization, still I obtain the same result, is it normal ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-722810" data-commentid="722810" data-postid="7553" data-belowelement="comment-722810" data-respondelement="respond" data-replyto="Reply to Zineb" aria-label="Reply to Zineb">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-725374" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-725374" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/ed049a28ac1471a1a4945b4940b8ec3d7466096a0bec226958721abd23daa911?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ed049a28ac1471a1a4945b4940b8ec3d7466096a0bec226958721abd23daa911?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Robert</span>
	                <span class="date">October 8, 2024 at 9:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-725374" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>For a paper that I am writing I have been asked to include an (approximate) number of operations for EMNIST Digit classification based on a CNN implementation (any reasonable architecture is ok). I am considering referring to your MNIST networks as I assume they would work fairly well also with EMNIST data.</p>
<p>Do you possibly have an estimate of the number of operations required for any of your networks?</p>
<p>Also, did you actually try using the EMNIST Digit dataset?</p>
<p>Thanks,<br />
Robert</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-725374" data-commentid="725374" data-postid="7553" data-belowelement="comment-725374" data-respondelement="respond" data-replyto="Reply to Robert" aria-label="Reply to Robert">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-725396" class="comment byuser comment-author-jamespcarmichael even depth-2">

	      	<div id="li-comment-725396" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">James Carmichael</span>
	                <span class="date">October 9, 2024 at 5:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-725396" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Robert&#8230;Please clarify what is meant by &#8220;number of operations&#8221;.  That will enable us to better guide you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-725396" data-commentid="725396" data-postid="7553" data-belowelement="comment-725396" data-respondelement="respond" data-replyto="Reply to James Carmichael" aria-label="Reply to James Carmichael">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-725815" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-725815" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/888ccda5ed5f12e2b149e14964ac986d4330f25bc804dfca0b8ec74885dc388e?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/888ccda5ed5f12e2b149e14964ac986d4330f25bc804dfca0b8ec74885dc388e?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Karim</span>
	                <span class="date">October 28, 2024 at 8:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-725815" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>its a long time that you posted the tutorial. But i have a problem. No matter which image i use, the output is &#8220;1&#8221; and i don&#8217;t know why. Can you help me?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-725815" data-commentid="725815" data-postid="7553" data-belowelement="comment-725815" data-respondelement="respond" data-replyto="Reply to Karim" aria-label="Reply to Karim">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-725863" class="comment byuser comment-author-jamespcarmichael even depth-2">

	      	<div id="li-comment-725863" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9489ebe21e231593130db8f6494ec78291a6c9dee89713b86d2001f54ee1698a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo' height='40' width='40' loading='lazy' decoding='async'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">James Carmichael</span>
	                <span class="date">October 29, 2024 at 7:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-725863" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Karim&#8230;It sounds like your model might be overfitting to a particular class or failing to learn properly. Here are a few areas to check:</p>
<p>1. **Data Preprocessing**: Ensure that your images are correctly preprocessed. For MNIST, images should be grayscale (1 channel) and sized at 28&#215;28 pixels, with pixel values normalized (often between 0 and 1 or standardized).</p>
<p>2. **Model Architecture**: If your model architecture is too simple, it might not be able to generalize well. Ensure you have enough layers (e.g., convolutional and dense layers) and units to capture the complexity of digit classification. Overly deep networks without regularization, however, might cause issues too.</p>
<p>3. **Loss Function and Activation**: Verify that you’re using the <code>softmax</code> activation in the final layer with categorical cross-entropy loss for multi-class classification.</p>
<p>4. **Model Training**: If your model is trained with too few epochs or without proper shuffling of the training data, it may not learn effectively. Conversely, overtraining on a limited subset could also make it biased towards a specific output. </p>
<p>5. **Evaluation**: If you’re printing predictions before model convergence or testing, the model could still be outputting random or biased results. Ensure you save and load a trained version of your model when making predictions.</p>
<p>Checking these should help you narrow down the issue. If the problem persists, feel free to share more details about the model structure and training loop for more specific guidance!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-725863" data-commentid="725863" data-postid="7553" data-belowelement="comment-725863" data-respondelement="respond" data-replyto="Reply to James Carmichael" aria-label="Reply to James Carmichael">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
			</ol>
		 	</div>	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#respond" style="display:none;">Click here to cancel reply.</a></small></h3><form action="https://machinelearningmastery.com/wp-comments-post.php" method="post" id="commentform" class="comment-form"><p class="comment-form-comment"><label class="hide" for="comment">Comment <span class="required">*</span></label> <textarea tabindex="4" id="comment" name="comment" cols="50" rows="10" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><input id="author" name="author" type="text" class="txt" tabindex="1" value="" size="30" aria-required='true' /><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input id="email" name="email" type="text" class="txt" tabindex="2" value="" size="30" aria-required='true' /><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit Comment" /> <input type='hidden' name='comment_post_ID' value='7553' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="18707d6677" /></p><p style="display: none !important;" class="akismet-fields-container" data-prefix="ak_"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_1" name="ak_js" value="32"/><script>document.getElementById( "ak_js_1" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>	</div><!-- #respond -->
	     
            </section><!-- /#main -->
                
            <aside id="sidebar">
<div id="woo_blogauthorinfo-2" class="widget widget_woo_blogauthorinfo"><span class="left"><img alt='' src='https://secure.gravatar.com/avatar/f35a3fae3b273cf95005f8b005808f43039fd77f2440fdf889ddeb4e135e062d?s=88&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f35a3fae3b273cf95005f8b005808f43039fd77f2440fdf889ddeb4e135e062d?s=176&#038;d=mm&#038;r=g 2x' class='avatar avatar-88 photo' height='88' width='88' loading='lazy' decoding='async'/></span>
<p><strong>Welcome!</strong><br>
I'm <em>Jason Brownlee</em> PhD <br>
and I <strong>help developers</strong> get results with <strong>machine learning</strong>.<br>
<a href="/about">Read more</a></p>
<div class="fix"></div>
</div><div id="custom_html-89" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><h4>Never miss a tutorial:</h4>
<br>
<div style="text-align: left;">
<a href="https://www.linkedin.com/company/machine-learning-mastery/"><img src="/wp-content/uploads/2019/12/small_icon_blue_linkedin3.png" alt="LinkedIn"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://twitter.com/TeachTheMachine"><img src="/wp-content/uploads/2019/12/small_icon_blue_twitter3.png" alt="Twitter"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://www.facebook.com/MachineLearningMastery/"><img src="/wp-content/uploads/2019/12/small_icon_blue_facebook3.png" alt="Facebook"></a>
&nbsp;&nbsp;&nbsp;
<a href="/newsletter/"><img src="/wp-content/uploads/2019/12/small_icon_blue_email3.png" alt="Email Newsletter"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://machinelearningmastery.com/rss-feed/"><img src="/wp-content/uploads/2019/12/small_icon_blue_rss3.png" alt="RSS Feed"></a>
</div></div></div><div id="custom_html-103" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><div id="right-sidebar" class="widget" style="height:260px;">
</div></div></div><div id="custom_html-28" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><h4>Picked for you:</h4>
<br>
<div class="display-posts-listing image-left"><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/how-to-train-an-object-detection-model-with-keras/"><img width="150" height="150" src="https://machinelearningmastery.com/wp-content/uploads/2019/03/Photograph-Showing-Object-Detection-Masks-Bounding-Boxes-and-Class-Labels-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Photograph Showing Object Detection Masks, Bounding Boxes, and Class Labels" decoding="async" loading="lazy" /></a> <a class="title" href="https://machinelearningmastery.com/how-to-train-an-object-detection-model-with-keras/">How to Train an Object Detection Model with Keras</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/"><img width="150" height="150" src="https://machinelearningmastery.com/wp-content/uploads/2019/03/Detected-Face-of-Jerry-Seinfeld-Correctly-Identified-by-the-SVM-Classifier-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Detected Face of Jerry Seinfeld, Correctly Identified by the SVM Classifier" decoding="async" loading="lazy" /></a> <a class="title" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/">How to Develop a Face Recognition System Using FaceNet in Keras</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-to-classify-photos-of-dogs-and-cats/"><img width="150" height="150" src="https://machinelearningmastery.com/wp-content/uploads/2019/03/Plot-of-the-First-Nine-Photos-of-Cats-in-the-Dogs-vs-Cats-Dataset-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Plot of the First Nine Photos of Cats in the Dogs vs Cats Dataset" decoding="async" loading="lazy" /></a> <a class="title" href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-to-classify-photos-of-dogs-and-cats/">How to Classify Photos of Dogs and Cats (with 97% accuracy)</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/how-to-perform-object-detection-with-yolov3-in-keras/"><img width="150" height="150" src="https://machinelearningmastery.com/wp-content/uploads/2019/03/Photograph-of-Three-Zebra-Each-Detected-with-the-YOLOv3-Model-and-Localized-with-Bounding-Boxes-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Photograph of Three Zebra Each Detected with the YOLOv3 Model and Localized with Bounding Boxes" decoding="async" loading="lazy" /></a> <a class="title" href="https://machinelearningmastery.com/how-to-perform-object-detection-with-yolov3-in-keras/">How to Perform Object Detection With YOLOv3 in Keras</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/how-to-get-started-with-deep-learning-for-computer-vision-7-day-mini-course/"><img width="150" height="150" src="https://machinelearningmastery.com/wp-content/uploads/2019/04/How-to-Get-Started-With-Deep-Learning-for-Computer-Vision-7-Day-Mini-Course-150x150.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="How to Get Started With Deep Learning for Computer Vision (7-Day Mini-Course)" decoding="async" loading="lazy" /></a> <a class="title" href="https://machinelearningmastery.com/how-to-get-started-with-deep-learning-for-computer-vision-7-day-mini-course/">How to Get Started With Deep Learning for Computer Vision (7-Day Mini-Course)</a></div></div></div></div><div id="custom_html-9" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><div style="text-align: center;">
	<p><h4>Loving the Tutorials?</h4></p>

<p>The <a href="/deep-learning-for-computer-vision/" rel="nofollow">Deep Learning for Computer Vision</a> EBook is where you'll find the <strong><i>Really Good</i></strong> stuff.</p>

<p>
<a href="/deep-learning-for-computer-vision/" class="woo-sc-button  red" ><span class="woo-">&gt;&gt; See What's Inside</span></a>
</p>

</div></div></div></aside><!-- /#sidebar -->

		</div><!-- /#main-sidebar-container -->         

		
    </div><!-- /#content -->
	
	<footer id="footer" class="col-full">

		
		<!-- <div id="copyright" class="col-left">
					</div> -->

		<!-- <div id="credit" class="col-right">
					</div> -->
		<link rel='stylesheet' id='kadence-blocks-image-css' href='https://machinelearningmastery.com/wp-content/plugins/kadence-blocks/dist/style-blocks-image.css?ver=3.5.3' type='text/css' media='all' />
<style id='kadence-blocks-advancedheading-inline-css' type='text/css'>
.wp-block-kadence-advancedheading mark{background:transparent;border-style:solid;border-width:0}.wp-block-kadence-advancedheading mark.kt-highlight{color:#f76a0c;}.kb-adv-heading-icon{display: inline-flex;justify-content: center;align-items: center;} .is-layout-constrained > .kb-advanced-heading-link {display: block;}
</style>
<style>.kb-row-layout-id18416_0b52ed-bc > .kt-row-column-wrap{align-content:start;}:where(.kb-row-layout-id18416_0b52ed-bc > .kt-row-column-wrap) > .wp-block-kadence-column{justify-content:start;}.kb-row-layout-id18416_0b52ed-bc > .kt-row-column-wrap{column-gap:var(--global-kb-gap-md, 2rem);row-gap:var(--global-kb-gap-md, 2rem);max-width:1250px;margin-left:auto;margin-right:auto;padding-top:0px;padding-bottom:0px;grid-template-columns:minmax(0, calc(75% - ((var(--global-kb-gap-md, 2rem) * 1 )/2)))minmax(0, calc(25% - ((var(--global-kb-gap-md, 2rem) * 1 )/2)));}.kb-row-layout-id18416_0b52ed-bc > .kt-row-layout-overlay{opacity:0.30;}@media all and (max-width: 1024px){.kb-row-layout-id18416_0b52ed-bc > .kt-row-column-wrap{grid-template-columns:repeat(2, minmax(0, 1fr));}}@media all and (max-width: 767px){.kb-row-layout-id18416_0b52ed-bc > .kt-row-column-wrap{grid-template-columns:minmax(0, 1fr);}.kb-row-layout-id18416_0b52ed-bc{border-bottom:1px solid #4e4e4f;}}</style><div class="kb-row-layout-wrap kb-row-layout-id18416_0b52ed-bc alignfull wp-block-kadence-rowlayout"><div class="kt-row-column-wrap kt-has-2-columns kt-row-layout-equal kt-tab-layout-inherit kt-mobile-layout-row kt-row-valign-top">
<style>.kadence-column18416_19a7d5-25 > .kt-inside-inner-col,.kadence-column18416_19a7d5-25 > .kt-inside-inner-col:before{border-top-left-radius:0px;border-top-right-radius:0px;border-bottom-right-radius:0px;border-bottom-left-radius:0px;}.kadence-column18416_19a7d5-25 > .kt-inside-inner-col{column-gap:var(--global-kb-gap-sm, 1rem);}.kadence-column18416_19a7d5-25 > .kt-inside-inner-col{flex-direction:column;}.kadence-column18416_19a7d5-25 > .kt-inside-inner-col > .aligncenter{width:100%;}.kadence-column18416_19a7d5-25 > .kt-inside-inner-col:before{opacity:0.3;}.kadence-column18416_19a7d5-25{position:relative;}@media all and (max-width: 1024px){.kadence-column18416_19a7d5-25 > .kt-inside-inner-col{flex-direction:column;}}@media all and (max-width: 767px){.kadence-column18416_19a7d5-25{text-align:center;}.kadence-column18416_19a7d5-25 > .kt-inside-inner-col{flex-direction:column;}}</style>
<div class="wp-block-kadence-column kadence-column18416_19a7d5-25 kb-section-dir-vertical inner-column-1"><div class="kt-inside-inner-col"><style>.wp-block-kadence-image.kb-image18416_475f9f-b2:not(.kb-specificity-added):not(.kb-extra-specificity-added) > figure{margin-top:0px;margin-right:30px;margin-bottom:0px;}.kb-image18416_475f9f-b2.kb-image-is-ratio-size, .kb-image18416_475f9f-b2 .kb-image-is-ratio-size{max-width:105px;width:100%;}.wp-block-kadence-column > .kt-inside-inner-col > .kb-image18416_475f9f-b2.kb-image-is-ratio-size, .wp-block-kadence-column > .kt-inside-inner-col > .kb-image18416_475f9f-b2 .kb-image-is-ratio-size{align-self:unset;}.kb-image18416_475f9f-b2 figure{max-width:105px;}.kb-image18416_475f9f-b2 .image-is-svg, .kb-image18416_475f9f-b2 .image-is-svg img{width:100%;}.kb-image18416_475f9f-b2 .kb-image-has-overlay:after{opacity:0.3;}</style>
<div class="wp-block-kadence-image kb-image18416_475f9f-b2"><figure class="alignleft size-full"><img src="https://machinelearningmastery.com/wp-content/uploads/2014/11/machine_learning_mastery_logo.png" alt="" class="kb-img wp-image-1864"/></figure></div>


<style>.wp-block-kadence-advancedheading.kt-adv-heading18416_791c5f-e9, .wp-block-kadence-advancedheading.kt-adv-heading18416_791c5f-e9[data-kb-block="kb-adv-heading18416_791c5f-e9"]{margin-bottom:15px;font-style:normal;}.wp-block-kadence-advancedheading.kt-adv-heading18416_791c5f-e9 mark.kt-highlight, .wp-block-kadence-advancedheading.kt-adv-heading18416_791c5f-e9[data-kb-block="kb-adv-heading18416_791c5f-e9"] mark.kt-highlight{font-style:normal;color:#f76a0c;-webkit-box-decoration-break:clone;box-decoration-break:clone;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;}@media all and (max-width: 767px){.wp-block-kadence-advancedheading.kt-adv-heading18416_791c5f-e9, .wp-block-kadence-advancedheading.kt-adv-heading18416_791c5f-e9[data-kb-block="kb-adv-heading18416_791c5f-e9"]{text-align:left!important;}}</style>
<p class="kt-adv-heading18416_791c5f-e9 wp-block-kadence-advancedheading" data-kb-block="kb-adv-heading18416_791c5f-e9">Machine Learning Mastery is part of Guiding Tech Media, a leading digital media publisher focused on helping people figure out technology. <a href="https://www.guidingtechmedia.com">Visit our corporate website</a> to learn more about our mission and team.</p>


<style>.kb-row-layout-id18416_fbdd08-d9 > .kt-row-column-wrap{align-content:start;}:where(.kb-row-layout-id18416_fbdd08-d9 > .kt-row-column-wrap) > .wp-block-kadence-column{justify-content:start;}.kb-row-layout-id18416_fbdd08-d9 > .kt-row-column-wrap{column-gap:var(--global-kb-gap-md, 2rem);row-gap:var(--global-kb-gap-md, 2rem);padding-top:var(--global-kb-spacing-sm, 1.5rem);padding-bottom:var(--global-kb-spacing-sm, 1.5rem);grid-template-columns:minmax(0, 1fr);}.kb-row-layout-id18416_fbdd08-d9 > .kt-row-layout-overlay{opacity:0.30;}@media all and (min-width: 1025px){.kb-row-layout-id18416_fbdd08-d9{display:none !important;}}@media all and (max-width: 1024px){.kb-row-layout-id18416_fbdd08-d9 > .kt-row-column-wrap{grid-template-columns:minmax(0, 1fr);}}@media all and (min-width: 768px) and (max-width: 1024px){.kb-row-layout-id18416_fbdd08-d9{display:none !important;}}@media all and (max-width: 767px){.kb-row-layout-id18416_fbdd08-d9 > .kt-row-column-wrap{padding-top:var(--global-kb-spacing-xs, 1rem);padding-right:0px;padding-bottom:0px;padding-left:0px;grid-template-columns:minmax(0, 1fr);}}</style><div class="kb-row-layout-wrap kb-row-layout-id18416_fbdd08-d9 alignnone kb-v-lg-hidden kb-v-md-hidden wp-block-kadence-rowlayout"><div class="kt-row-column-wrap kt-has-1-columns kt-row-layout-equal kt-tab-layout-inherit kt-mobile-layout-row kt-row-valign-top">
<style>.kadence-column18416_7de0ea-29 > .kt-inside-inner-col,.kadence-column18416_7de0ea-29 > .kt-inside-inner-col:before{border-top-left-radius:0px;border-top-right-radius:0px;border-bottom-right-radius:0px;border-bottom-left-radius:0px;}.kadence-column18416_7de0ea-29 > .kt-inside-inner-col{column-gap:var(--global-kb-gap-sm, 1rem);}.kadence-column18416_7de0ea-29 > .kt-inside-inner-col{flex-direction:column;}.kadence-column18416_7de0ea-29 > .kt-inside-inner-col > .aligncenter{width:100%;}.kadence-column18416_7de0ea-29 > .kt-inside-inner-col:before{opacity:0.3;}.kadence-column18416_7de0ea-29{position:relative;}@media all and (max-width: 1024px){.kadence-column18416_7de0ea-29 > .kt-inside-inner-col{flex-direction:column;}}@media all and (max-width: 767px){.kadence-column18416_7de0ea-29 > .kt-inside-inner-col{display:flex;flex-direction:column;align-items:center;}}</style>
<div class="wp-block-kadence-column kadence-column18416_7de0ea-29"><div class="kt-inside-inner-col">
<ul class="wp-block-social-links has-large-icon-size has-icon-color is-style-logos-only is-content-justification-left is-layout-flex wp-container-core-social-links-is-layout-fdcfc74e wp-block-social-links-is-layout-flex"><li style="color: #6aaaca; " class="wp-social-link wp-social-link-linkedin  wp-block-social-link"><a href="https://www.linkedin.com/company/machine-learning-mastery/" class="wp-block-social-link-anchor"><svg width="24" height="24" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path d="M19.7,3H4.3C3.582,3,3,3.582,3,4.3v15.4C3,20.418,3.582,21,4.3,21h15.4c0.718,0,1.3-0.582,1.3-1.3V4.3 C21,3.582,20.418,3,19.7,3z M8.339,18.338H5.667v-8.59h2.672V18.338z M7.004,8.574c-0.857,0-1.549-0.694-1.549-1.548 c0-0.855,0.691-1.548,1.549-1.548c0.854,0,1.547,0.694,1.547,1.548C8.551,7.881,7.858,8.574,7.004,8.574z M18.339,18.338h-2.669 v-4.177c0-0.996-0.017-2.278-1.387-2.278c-1.389,0-1.601,1.086-1.601,2.206v4.249h-2.667v-8.59h2.559v1.174h0.037 c0.356-0.675,1.227-1.387,2.526-1.387c2.703,0,3.203,1.779,3.203,4.092V18.338z"></path></svg><span class="wp-block-social-link-label screen-reader-text">LinkedIn</span></a></li>

<li style="color: #6aaaca; " class="wp-social-link wp-social-link-facebook  wp-block-social-link"><a href="https://www.facebook.com/MachineLearningMastery/" class="wp-block-social-link-anchor"><svg width="24" height="24" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path d="M12 2C6.5 2 2 6.5 2 12c0 5 3.7 9.1 8.4 9.9v-7H7.9V12h2.5V9.8c0-2.5 1.5-3.9 3.8-3.9 1.1 0 2.2.2 2.2.2v2.5h-1.3c-1.2 0-1.6.8-1.6 1.6V12h2.8l-.4 2.9h-2.3v7C18.3 21.1 22 17 22 12c0-5.5-4.5-10-10-10z"></path></svg><span class="wp-block-social-link-label screen-reader-text">Facebook</span></a></li>

<li style="color: #6aaaca; " class="wp-social-link wp-social-link-twitter  wp-block-social-link"><a href="https://twitter.com/TeachTheMachine" class="wp-block-social-link-anchor"><svg width="24" height="24" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path d="M22.23,5.924c-0.736,0.326-1.527,0.547-2.357,0.646c0.847-0.508,1.498-1.312,1.804-2.27 c-0.793,0.47-1.671,0.812-2.606,0.996C18.324,4.498,17.257,4,16.077,4c-2.266,0-4.103,1.837-4.103,4.103 c0,0.322,0.036,0.635,0.106,0.935C8.67,8.867,5.647,7.234,3.623,4.751C3.27,5.357,3.067,6.062,3.067,6.814 c0,1.424,0.724,2.679,1.825,3.415c-0.673-0.021-1.305-0.206-1.859-0.513c0,0.017,0,0.034,0,0.052c0,1.988,1.414,3.647,3.292,4.023 c-0.344,0.094-0.707,0.144-1.081,0.144c-0.264,0-0.521-0.026-0.772-0.074c0.522,1.63,2.038,2.816,3.833,2.85 c-1.404,1.1-3.174,1.756-5.096,1.756c-0.331,0-0.658-0.019-0.979-0.057c1.816,1.164,3.973,1.843,6.29,1.843 c7.547,0,11.675-6.252,11.675-11.675c0-0.178-0.004-0.355-0.012-0.531C20.985,7.47,21.68,6.747,22.23,5.924z"></path></svg><span class="wp-block-social-link-label screen-reader-text">Twitter</span></a></li>

<li style="color: #6aaaca; " class="wp-social-link wp-social-link-feed  wp-block-social-link"><a href="https://machinelearningmastery.com/feed/" class="wp-block-social-link-anchor"><svg width="24" height="24" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path d="M2,8.667V12c5.515,0,10,4.485,10,10h3.333C15.333,14.637,9.363,8.667,2,8.667z M2,2v3.333 c9.19,0,16.667,7.477,16.667,16.667H22C22,10.955,13.045,2,2,2z M4.5,17C3.118,17,2,18.12,2,19.5S3.118,22,4.5,22S7,20.88,7,19.5 S5.882,17,4.5,17z"></path></svg><span class="wp-block-social-link-label screen-reader-text">RSS Feed</span></a></li>

<li style="color: #6aaaca; " class="wp-social-link wp-social-link-mail  wp-block-social-link"><a href="https://machinelearningmastery.com/contact/" class="wp-block-social-link-anchor"><svg width="24" height="24" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path d="M19,5H5c-1.1,0-2,.9-2,2v10c0,1.1.9,2,2,2h14c1.1,0,2-.9,2-2V7c0-1.1-.9-2-2-2zm.5,12c0,.3-.2.5-.5.5H5c-.3,0-.5-.2-.5-.5V9.8l7.5,5.6,7.5-5.6V17zm0-9.1L12,13.6,4.5,7.9V7c0-.3.2-.5.5-.5h14c.3,0,.5.2.5.5v.9z"></path></svg><span class="wp-block-social-link-label screen-reader-text">Mail</span></a></li></ul>
</div></div>

</div></div>

<nav style="font-size:12px;text-transform:uppercase;" class="wp-block-navigation is-layout-flex wp-block-navigation-is-layout-flex" aria-label="Footer Menu"><ul style="font-size:12px;text-transform:uppercase;" class="wp-block-navigation__container  wp-block-navigation"><li style="font-size: 12px;" class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content"  href="https://machinelearningmastery.com/privacy/"><span class="wp-block-navigation-item__label">Privacy</span></a></li><li style="font-size: 12px;" class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content"  href="https://machinelearningmastery.com/disclaimer/"><span class="wp-block-navigation-item__label">Disclaimer</span></a></li><li style="font-size: 12px;" class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content"  href="https://machinelearningmastery.com/terms-of-service/"><span class="wp-block-navigation-item__label">Terms</span></a></li><li style="font-size: 12px;" class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content"  href="https://machinelearningmastery.com/contact/"><span class="wp-block-navigation-item__label">Contact</span></a></li><li style="font-size: 12px;" class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content"  href="https://machinelearningmastery.com/sitemap/"><span class="wp-block-navigation-item__label">Sitemap</span></a></li><li style="font-size: 12px;" class=" wp-block-navigation-item wp-block-navigation-link"><a class="wp-block-navigation-item__content"  href="https://www.kdnuggets.com/media-kit"><span class="wp-block-navigation-item__label">ADVERTISE WITH US</span></a></li></ul></nav>


<p class="copyright">© 2025 Guiding Tech Media All Rights Reserved</p>
</div></div>


<style>.kadence-column18416_c5ca3a-80 > .kt-inside-inner-col{display:flex;}.kadence-column18416_c5ca3a-80 > .kt-inside-inner-col,.kadence-column18416_c5ca3a-80 > .kt-inside-inner-col:before{border-top-left-radius:0px;border-top-right-radius:0px;border-bottom-right-radius:0px;border-bottom-left-radius:0px;}.kadence-column18416_c5ca3a-80 > .kt-inside-inner-col{column-gap:var(--global-kb-gap-sm, 1rem);}.kadence-column18416_c5ca3a-80 > .kt-inside-inner-col{flex-direction:column;align-items:flex-end;}.kadence-column18416_c5ca3a-80 > .kt-inside-inner-col > .kb-image-is-ratio-size{align-self:stretch;}.kadence-column18416_c5ca3a-80 > .kt-inside-inner-col > .wp-block-kadence-advancedgallery{align-self:stretch;}.kadence-column18416_c5ca3a-80 > .kt-inside-inner-col > .aligncenter{width:100%;}.kadence-column18416_c5ca3a-80 > .kt-inside-inner-col:before{opacity:0.3;}.kadence-column18416_c5ca3a-80{position:relative;}@media all and (max-width: 1024px){.kadence-column18416_c5ca3a-80 > .kt-inside-inner-col{flex-direction:column;align-items:flex-end;}}@media all and (max-width: 767px){.kadence-column18416_c5ca3a-80 > .kt-inside-inner-col{flex-direction:column;align-items:flex-end;}}</style>
<div class="wp-block-kadence-column kadence-column18416_c5ca3a-80 kvs-sm-false"><div class="kt-inside-inner-col">
<ul class="wp-block-social-links has-large-icon-size has-icon-color is-style-logos-only is-content-justification-left is-layout-flex wp-container-core-social-links-is-layout-fdcfc74e wp-block-social-links-is-layout-flex"><li style="color: #6aaaca; " class="wp-social-link wp-social-link-linkedin  wp-block-social-link"><a href="https://www.linkedin.com/company/machine-learning-mastery/" class="wp-block-social-link-anchor"><svg width="24" height="24" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path d="M19.7,3H4.3C3.582,3,3,3.582,3,4.3v15.4C3,20.418,3.582,21,4.3,21h15.4c0.718,0,1.3-0.582,1.3-1.3V4.3 C21,3.582,20.418,3,19.7,3z M8.339,18.338H5.667v-8.59h2.672V18.338z M7.004,8.574c-0.857,0-1.549-0.694-1.549-1.548 c0-0.855,0.691-1.548,1.549-1.548c0.854,0,1.547,0.694,1.547,1.548C8.551,7.881,7.858,8.574,7.004,8.574z M18.339,18.338h-2.669 v-4.177c0-0.996-0.017-2.278-1.387-2.278c-1.389,0-1.601,1.086-1.601,2.206v4.249h-2.667v-8.59h2.559v1.174h0.037 c0.356-0.675,1.227-1.387,2.526-1.387c2.703,0,3.203,1.779,3.203,4.092V18.338z"></path></svg><span class="wp-block-social-link-label screen-reader-text">LinkedIn</span></a></li>

<li style="color: #6aaaca; " class="wp-social-link wp-social-link-facebook  wp-block-social-link"><a href="https://www.facebook.com/MachineLearningMastery/" class="wp-block-social-link-anchor"><svg width="24" height="24" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path d="M12 2C6.5 2 2 6.5 2 12c0 5 3.7 9.1 8.4 9.9v-7H7.9V12h2.5V9.8c0-2.5 1.5-3.9 3.8-3.9 1.1 0 2.2.2 2.2.2v2.5h-1.3c-1.2 0-1.6.8-1.6 1.6V12h2.8l-.4 2.9h-2.3v7C18.3 21.1 22 17 22 12c0-5.5-4.5-10-10-10z"></path></svg><span class="wp-block-social-link-label screen-reader-text">Facebook</span></a></li>

<li style="color: #6aaaca; " class="wp-social-link wp-social-link-twitter  wp-block-social-link"><a href="https://twitter.com/TeachTheMachine" class="wp-block-social-link-anchor"><svg width="24" height="24" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path d="M22.23,5.924c-0.736,0.326-1.527,0.547-2.357,0.646c0.847-0.508,1.498-1.312,1.804-2.27 c-0.793,0.47-1.671,0.812-2.606,0.996C18.324,4.498,17.257,4,16.077,4c-2.266,0-4.103,1.837-4.103,4.103 c0,0.322,0.036,0.635,0.106,0.935C8.67,8.867,5.647,7.234,3.623,4.751C3.27,5.357,3.067,6.062,3.067,6.814 c0,1.424,0.724,2.679,1.825,3.415c-0.673-0.021-1.305-0.206-1.859-0.513c0,0.017,0,0.034,0,0.052c0,1.988,1.414,3.647,3.292,4.023 c-0.344,0.094-0.707,0.144-1.081,0.144c-0.264,0-0.521-0.026-0.772-0.074c0.522,1.63,2.038,2.816,3.833,2.85 c-1.404,1.1-3.174,1.756-5.096,1.756c-0.331,0-0.658-0.019-0.979-0.057c1.816,1.164,3.973,1.843,6.29,1.843 c7.547,0,11.675-6.252,11.675-11.675c0-0.178-0.004-0.355-0.012-0.531C20.985,7.47,21.68,6.747,22.23,5.924z"></path></svg><span class="wp-block-social-link-label screen-reader-text">Twitter</span></a></li>

<li style="color: #6aaaca; " class="wp-social-link wp-social-link-feed  wp-block-social-link"><a href="https://machinelearningmastery.com/feed/" class="wp-block-social-link-anchor"><svg width="24" height="24" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path d="M2,8.667V12c5.515,0,10,4.485,10,10h3.333C15.333,14.637,9.363,8.667,2,8.667z M2,2v3.333 c9.19,0,16.667,7.477,16.667,16.667H22C22,10.955,13.045,2,2,2z M4.5,17C3.118,17,2,18.12,2,19.5S3.118,22,4.5,22S7,20.88,7,19.5 S5.882,17,4.5,17z"></path></svg><span class="wp-block-social-link-label screen-reader-text">RSS Feed</span></a></li>

<li style="color: #6aaaca; " class="wp-social-link wp-social-link-mail  wp-block-social-link"><a href="https://machinelearningmastery.com/contact/" class="wp-block-social-link-anchor"><svg width="24" height="24" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path d="M19,5H5c-1.1,0-2,.9-2,2v10c0,1.1.9,2,2,2h14c1.1,0,2-.9,2-2V7c0-1.1-.9-2-2-2zm.5,12c0,.3-.2.5-.5.5H5c-.3,0-.5-.2-.5-.5V9.8l7.5,5.6,7.5-5.6V17zm0-9.1L12,13.6,4.5,7.9V7c0-.3.2-.5.5-.5h14c.3,0,.5.2.5.5v.9z"></path></svg><span class="wp-block-social-link-label screen-reader-text">Mail</span></a></li></ul>
</div></div>

</div></div>		

	</footer>

	
	</div><!-- /#inner-wrapper -->

</div><!-- /#wrapper -->

<div class="fix"></div><!--/.fix-->

<script type='text/javascript'>
/* <![CDATA[ */
var advancedAds = {"adHealthNotice":{"enabled":true,"pattern":"AdSense fallback was loaded for empty AdSense ad \"[ad_title]\""},"frontendPrefix":"machi-","tracking":{"googleEvents":{"impression":"advanced_ads_impression","click":"advanced_ads_click"}}};

/* ]]> */
</script>
<script data-no-optimize='1' data-cfasync='false' id='cls-insertion-9c650da'>!function(){"use strict";function e(){return e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},e.apply(this,arguments)}window.adthriveCLS.buildDate="2025-04-16";const t="addensity",i="adlayout",n="interstitial",s="stickyoutstream",o="Below_Post",r="Content",a="Recipe",l="Footer",c="Header",d="Sidebar",h="desktop",u="mobile",p="Video_Collapse_Autoplay_SoundOff",m="Video_Individual_Autoplay_SOff",g="Video_Coll_SOff_Smartphone",y="Video_In-Post_ClicktoPlay_SoundOn",_=e=>{const t={};return function(...i){const n=JSON.stringify(i);if(t[n])return t[n];const s=e.apply(this,i);return t[n]=s,s}},f=navigator.userAgent,v=_((e=>/Chrom|Applechromium/.test(e||f))),b=_((()=>/WebKit/.test(f))),S=_((()=>v()?"chromium":b()?"webkit":"other"));const x=new class{info(e,t,...i){this.call(console.info,e,t,...i)}warn(e,t,...i){this.call(console.warn,e,t,...i)}error(e,t,...i){this.call(console.error,e,t,...i),this.sendErrorLogToCommandQueue(e,t,...i)}event(e,t,...i){var n;"debug"===(null==(n=window.adthriveCLS)?void 0:n.bucket)&&this.info(e,t)}sendErrorLogToCommandQueue(e,t,...i){window.adthrive=window.adthrive||{},window.adthrive.cmd=window.adthrive.cmd||[],window.adthrive.cmd.push((()=>{void 0!==window.adthrive.logError&&"function"==typeof window.adthrive.logError&&window.adthrive.logError(e,t,i)}))}call(e,t,i,...n){const s=[`%c${t}::${i} `],o=["color: #999; font-weight: bold;"];n.length>0&&"string"==typeof n[0]&&s.push(n.shift()),o.push(...n);try{Function.prototype.apply.call(e,console,[s.join(""),...o])}catch(e){return void console.error(e)}}},w=(e,t)=>null==e||e!=e?t:e,E=e=>{const t=e.offsetHeight,i=e.offsetWidth,n=e.getBoundingClientRect(),s=document.body,o=document.documentElement,r=window.pageYOffset||o.scrollTop||s.scrollTop,a=window.pageXOffset||o.scrollLeft||s.scrollLeft,l=o.clientTop||s.clientTop||0,c=o.clientLeft||s.clientLeft||0,d=Math.round(n.top+r-l),h=Math.round(n.left+a-c);return{top:d,left:h,bottom:d+t,right:h+i,width:i,height:t}},C=e=>{let t={};const i=((e=window.location.search)=>{const t=0===e.indexOf("?")?1:0;return e.slice(t).split("&").reduce(((e,t)=>{const[i,n]=t.split("=");return e.set(i,n),e}),new Map)})().get(e);if(i)try{const n=decodeURIComponent(i).replace(/\+/g,"");t=JSON.parse(n),x.event("ExperimentOverridesUtil","getExperimentOverrides",e,t)}catch(e){}return t},A=_(((e=navigator.userAgent)=>/Windows NT|Macintosh/i.test(e))),D=_((()=>{const e=navigator.userAgent,t=/Tablet|iPad|Playbook|Nook|webOS|Kindle|Android (?!.*Mobile).*Safari|CrOS/i.test(e);return/Mobi|iP(hone|od)|Opera Mini/i.test(e)&&!t})),P=(e,t,i=document)=>{const n=((e=document)=>{const t=e.querySelectorAll("article");if(0===t.length)return null;const i=Array.from(t).reduce(((e,t)=>t.offsetHeight>e.offsetHeight?t:e));return i&&i.offsetHeight>1.5*window.innerHeight?i:null})(i),s=n?[n]:[],o=[];e.forEach((e=>{const n=Array.from(i.querySelectorAll(e.elementSelector)).slice(0,e.skip);var r;(r=e.elementSelector,r.includes(",")?r.split(","):[r]).forEach((r=>{const a=i.querySelectorAll(r);for(let i=0;i<a.length;i++){const r=a[i];if(t.map.some((({el:e})=>e.isEqualNode(r))))continue;const l=r&&r.parentElement;l&&l!==document.body?s.push(l):s.push(r),-1===n.indexOf(r)&&o.push({dynamicAd:e,element:r})}}))}));const r=((e=document)=>(e===document?document.body:e).getBoundingClientRect().top)(i),a=o.sort(((e,t)=>e.element.getBoundingClientRect().top-r-(t.element.getBoundingClientRect().top-r)));return[s,a]};class k{}const O=["mcmpfreqrec"];const I=new class extends k{init(e){this._gdpr="true"===e.gdpr,this._shouldQueue=this._gdpr}clearQueue(e){e&&(this._shouldQueue=!1,this._sessionStorageHandlerQueue.forEach((e=>{this.setSessionStorage(e.key,e.value)})),this._localStorageHandlerQueue.forEach((e=>{if("adthrive_abgroup"===e.key){const t=Object.keys(e.value)[0],i=e.value[t],n=e.value[`${t}_weight`];this.getOrSetABGroupLocalStorageValue(t,i,n,{value:24,unit:"hours"})}else e.expiry?"internal"===e.type?this.setExpirableInternalLocalStorage(e.key,e.value,{expiry:e.expiry,resetOnRead:e.resetOnRead}):this.setExpirableExternalLocalStorage(e.key,e.value,{expiry:e.expiry,resetOnRead:e.resetOnRead}):"internal"===e.type?this.setInternalLocalStorage(e.key,e.value):this.setExternalLocalStorage(e.key,e.value)})),this._cookieHandlerQueue.forEach((e=>{"internal"===e.type?this.setInternalCookie(e.key,e.value):this.setExternalCookie(e.key,e.value)}))),this._sessionStorageHandlerQueue=[],this._localStorageHandlerQueue=[],this._cookieHandlerQueue=[]}readInternalCookie(e){return this._verifyInternalKey(e),this._readCookie(e)}readExternalCookie(e){return this._readCookie(e)}readInternalLocalStorage(e){return this._verifyInternalKey(e),this._readFromLocalStorage(e)}readExternalLocalStorage(e){return this._readFromLocalStorage(e)}readSessionStorage(e){const t=window.sessionStorage.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch(e){return t}}deleteCookie(e){document.cookie=`${e}=; SameSite=None; Secure; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/`}deleteLocalStorage(e){window.localStorage.removeItem(e)}deleteSessionStorage(e){window.sessionStorage.removeItem(e)}setInternalCookie(e,t,i){this._verifyInternalKey(e),this._setCookieValue("internal",e,t,i)}setExternalCookie(e,t,i){this._setCookieValue("external",e,t,i)}setInternalLocalStorage(e,t){if(this._verifyInternalKey(e),this._gdpr&&this._shouldQueue){const i={key:e,value:t,type:"internal"};this._localStorageHandlerQueue.push(i)}else{const i="string"==typeof t?t:JSON.stringify(t);window.localStorage.setItem(e,i)}}setExternalLocalStorage(e,t){if(this._gdpr&&this._shouldQueue){const i={key:e,value:t,type:"external"};this._localStorageHandlerQueue.push(i)}else{const i="string"==typeof t?t:JSON.stringify(t);window.localStorage.setItem(e,i)}}setExpirableInternalLocalStorage(e,t,i){this._verifyInternalKey(e);try{var n;const o=null!=(n=null==i?void 0:i.expiry)?n:{value:400,unit:"days"};var s;const r=null!=(s=null==i?void 0:i.resetOnRead)&&s;if(this._gdpr&&this._shouldQueue){const i={key:e,value:t,type:"internal",expires:this._getExpiryDate(o),expiry:o,resetOnRead:r};this._localStorageHandlerQueue.push(i)}else{const i={value:t,type:"internal",expires:this._getExpiryDate(o),expiry:o,resetOnRead:r};window.localStorage.setItem(e,JSON.stringify(i))}}catch(e){console.error(e)}}setExpirableExternalLocalStorage(e,t,i){try{var n;const o=null!=(n=null==i?void 0:i.expiry)?n:{value:400,unit:"days"};var s;const r=null!=(s=null==i?void 0:i.resetOnRead)&&s;if(this._gdpr&&this._shouldQueue){const i={key:e,value:JSON.stringify(t),type:"external",expires:this._getExpiryDate(o),expiry:o,resetOnRead:r};this._localStorageHandlerQueue.push(i)}else{const i={value:t,type:"external",expires:this._getExpiryDate(o),expiry:o,resetOnRead:r};window.localStorage.setItem(e,JSON.stringify(i))}}catch(e){console.error(e)}}setSessionStorage(e,t){if(this._gdpr&&this._shouldQueue){const i={key:e,value:t};this._sessionStorageHandlerQueue.push(i)}else{const i="string"==typeof t?t:JSON.stringify(t);window.sessionStorage.setItem(e,i)}}getOrSetABGroupLocalStorageValue(t,i,n,s,o=!0){const r="adthrive_abgroup",a=this.readInternalLocalStorage(r);if(null!==a){const e=a[t];var l;const i=null!=(l=a[`${t}_weight`])?l:null;if(this._isValidABGroupLocalStorageValue(e))return[e,i]}const c=e({},a,{[t]:i,[`${t}_weight`]:n});return s?this.setExpirableInternalLocalStorage(r,c,{expiry:s,resetOnRead:o}):this.setInternalLocalStorage(r,c),[i,n]}_isValidABGroupLocalStorageValue(e){return null!=e&&!("number"==typeof e&&isNaN(e))}_getExpiryDate({value:e,unit:t}){const i=new Date;return"milliseconds"===t?i.setTime(i.getTime()+e):"seconds"==t?i.setTime(i.getTime()+1e3*e):"minutes"===t?i.setTime(i.getTime()+60*e*1e3):"hours"===t?i.setTime(i.getTime()+60*e*60*1e3):"days"===t?i.setTime(i.getTime()+24*e*60*60*1e3):"months"===t&&i.setTime(i.getTime()+30*e*24*60*60*1e3),i.toUTCString()}_resetExpiry(e){return e.expires=this._getExpiryDate(e.expiry),e}_readCookie(e){const t=document.cookie.split("; ").find((t=>t.split("=")[0]===e));if(!t)return null;const i=t.split("=")[1];if(i)try{return JSON.parse(decodeURIComponent(i))}catch(e){return decodeURIComponent(i)}return null}_readFromLocalStorage(e){const t=window.localStorage.getItem(e);if(!t)return null;try{const n=JSON.parse(t),s=n.expires&&(new Date).getTime()>new Date(n.expires).getTime();if("adthrive_abgroup"===e&&n.created)return window.localStorage.removeItem(e),null;if(n.resetOnRead&&n.expires&&!s){const t=this._resetExpiry(n);var i;return window.localStorage.setItem(e,JSON.stringify(n)),null!=(i=t.value)?i:t}if(s)return window.localStorage.removeItem(e),null;if(!n.hasOwnProperty("value"))return n;try{return JSON.parse(n.value)}catch(e){return n.value}}catch(e){return t}}_setCookieValue(e,t,i,n){try{if(this._gdpr&&this._shouldQueue){const n={key:t,value:i,type:e};this._cookieHandlerQueue.push(n)}else{var s;const e=this._getExpiryDate(null!=(s=null==n?void 0:n.expiry)?s:{value:400,unit:"days"});var o;const a=null!=(o=null==n?void 0:n.sameSite)?o:"None";var r;const l=null==(r=null==n?void 0:n.secure)||r,c="object"==typeof i?JSON.stringify(i):i;document.cookie=`${t}=${c}; SameSite=${a}; ${l?"Secure;":""} expires=${e}; path=/`}}catch(e){}}_verifyInternalKey(e){const t=e.startsWith("adthrive_"),i=e.startsWith("adt_");if(!t&&!i&&!O.includes(e))throw new Error('When reading an internal cookie, the key must start with "adthrive_" or "adt_" or be part of the allowed legacy keys.')}constructor(...e){super(...e),this.name="BrowserStorage",this.disable=!1,this.gdprPurposes=[1],this._sessionStorageHandlerQueue=[],this._localStorageHandlerQueue=[],this._cookieHandlerQueue=[],this._shouldQueue=!1}},M=(e,i,o)=>{switch(i){case t:return((e,t)=>{const i=e.adDensityEnabled,n=e.adDensityLayout.pageOverrides.find((e=>!!document.querySelector(e.pageSelector)&&(e[t].onePerViewport||"number"==typeof e[t].adDensity)));return!i||!n})(e,o);case s:return(e=>{var t,i,n;const s=null==(n=e.videoPlayers)||null==(i=n.partners)||null==(t=i.stickyOutstream)?void 0:t.blockedPageSelectors;return!s||!document.querySelector(s)})(e);case n:return(e=>{const t=e.adOptions.interstitialBlockedPageSelectors;return!t||!document.querySelector(t)})(e);default:return!0}},L=t=>{try{return{valid:!0,elements:document.querySelectorAll(t)}}catch(t){return e({valid:!1},t)}},R=e=>""===e?{valid:!0}:L(e),T=(e,t)=>{if(!e)return!1;const i=!!e.enabled,n=null==e.dateStart||Date.now()>=e.dateStart,s=null==e.dateEnd||Date.now()<=e.dateEnd,o=null===e.selector||""!==e.selector&&!!document.querySelector(e.selector),r="mobile"===e.platform&&"mobile"===t,a="desktop"===e.platform&&"desktop"===t,l=null===e.platform||"all"===e.platform||r||a,c="bernoulliTrial"===e.experimentType?1===e.variants.length:(e=>{const t=e.reduce(((e,t)=>t.weight?t.weight+e:e),0);return e.length>0&&e.every((e=>{const t=e.value,i=e.weight;return!(null==t||"number"==typeof t&&isNaN(t)||!i)}))&&100===t})(e.variants);return c||x.error("SiteTest","validateSiteExperiment","experiment presented invalid choices for key:",e.key,e.variants),i&&n&&s&&o&&l&&c},j=["siteId","siteName","adOptions","breakpoints","adUnits"];class H{get enabled(){return!!this._clsGlobalData&&!!this._clsGlobalData.siteAds&&((e,t=j)=>{if(!e)return!1;for(let i=0;i<t.length;i++)if(!e[t[i]])return!1;return!0})(this._clsGlobalData.siteAds)}get error(){return!(!this._clsGlobalData||!this._clsGlobalData.error)}set siteAds(e){this._clsGlobalData.siteAds=e}get siteAds(){return this._clsGlobalData.siteAds}set disableAds(e){this._clsGlobalData.disableAds=e}get disableAds(){return this._clsGlobalData.disableAds}set enabledLocations(e){this._clsGlobalData.enabledLocations=e}get enabledLocations(){return this._clsGlobalData.enabledLocations}get injectedFromPlugin(){return this._clsGlobalData.injectedFromPlugin}set injectedFromPlugin(e){this._clsGlobalData.injectedFromPlugin=e}get injectedFromSiteAds(){return this._clsGlobalData.injectedFromSiteAds}set injectedFromSiteAds(e){this._clsGlobalData.injectedFromSiteAds=e}overwriteInjectedSlots(e){this._clsGlobalData.injectedSlots=e}setInjectedSlots(e){this._clsGlobalData.injectedSlots=this._clsGlobalData.injectedSlots||[],this._clsGlobalData.injectedSlots.push(e)}get injectedSlots(){return this._clsGlobalData.injectedSlots}setInjectedVideoSlots(e){this._clsGlobalData.injectedVideoSlots=this._clsGlobalData.injectedVideoSlots||[],this._clsGlobalData.injectedVideoSlots.push(e)}get injectedVideoSlots(){return this._clsGlobalData.injectedVideoSlots}setInjectedScripts(e){this._clsGlobalData.injectedScripts=this._clsGlobalData.injectedScripts||[],this._clsGlobalData.injectedScripts.push(e)}get getInjectedScripts(){return this._clsGlobalData.injectedScripts}setExperiment(e,t,i=!1){this._clsGlobalData.experiments=this._clsGlobalData.experiments||{},this._clsGlobalData.siteExperiments=this._clsGlobalData.siteExperiments||{};(i?this._clsGlobalData.siteExperiments:this._clsGlobalData.experiments)[e]=t}getExperiment(e,t=!1){const i=t?this._clsGlobalData.siteExperiments:this._clsGlobalData.experiments;return i&&i[e]}setWeightedChoiceExperiment(e,t,i=!1){this._clsGlobalData.experimentsWeightedChoice=this._clsGlobalData.experimentsWeightedChoice||{},this._clsGlobalData.siteExperimentsWeightedChoice=this._clsGlobalData.siteExperimentsWeightedChoice||{};(i?this._clsGlobalData.siteExperimentsWeightedChoice:this._clsGlobalData.experimentsWeightedChoice)[e]=t}getWeightedChoiceExperiment(e,t=!1){var i,n;const s=t?null==(i=this._clsGlobalData)?void 0:i.siteExperimentsWeightedChoice:null==(n=this._clsGlobalData)?void 0:n.experimentsWeightedChoice;return s&&s[e]}get branch(){return this._clsGlobalData.branch}get bucket(){return this._clsGlobalData.bucket}set videoDisabledFromPlugin(e){this._clsGlobalData.videoDisabledFromPlugin=e}get videoDisabledFromPlugin(){return this._clsGlobalData.videoDisabledFromPlugin}set targetDensityLog(e){this._clsGlobalData.targetDensityLog=e}get targetDensityLog(){return this._clsGlobalData.targetDensityLog}getIOSDensity(e){const t=[{weight:100,adDensityPercent:0},{weight:0,adDensityPercent:25},{weight:0,adDensityPercent:50}],i=t.map((e=>e.weight)),{index:n}=(e=>{const t={index:-1,weight:-1};if(!e||0===e.length)return t;const i=e.reduce(((e,t)=>e+t),0);if(0===i)return t;const n=Math.random()*i;let s=0,o=e[s];for(;n>o;)o+=e[++s];return{index:s,weight:e[s]}})(i),s=e-e*(t[n].adDensityPercent/100);return this.setWeightedChoiceExperiment("iosad",t[n].adDensityPercent),s}getTargetDensity(e){return((e=navigator.userAgent)=>/iP(hone|od|ad)/i.test(e))()?this.getIOSDensity(e):e}get removeVideoTitleWrapper(){return this._clsGlobalData.siteAds.adOptions.removeVideoTitleWrapper}constructor(){this._clsGlobalData=window.adthriveCLS}}class V{static getScrollTop(){return(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0)}static getScrollBottom(){return this.getScrollTop()+(document.documentElement.clientHeight||0)}static shufflePlaylist(e){let t,i,n=e.length;for(;0!==n;)i=Math.floor(Math.random()*e.length),n-=1,t=e[n],e[n]=e[i],e[i]=t;return e}static isMobileLandscape(){return window.matchMedia("(orientation: landscape) and (max-height: 480px)").matches}static playerViewable(e){const t=e.getBoundingClientRect();return this.isMobileLandscape()?window.innerHeight>t.top+t.height/2&&t.top+t.height/2>0:window.innerHeight>t.top+t.height/2}static createQueryString(e){return Object.keys(e).map((t=>`${t}=${e[t]}`)).join("&")}static createEncodedQueryString(e){return Object.keys(e).map((t=>`${t}=${encodeURIComponent(e[t])}`)).join("&")}static setMobileLocation(e){return"top-left"===(e=e||"bottom-right")?e="adthrive-collapse-top-left":"top-right"===e?e="adthrive-collapse-top-right":"bottom-left"===e?e="adthrive-collapse-bottom-left":"bottom-right"===e?e="adthrive-collapse-bottom-right":"top-center"===e&&(e=D()?"adthrive-collapse-top-center":"adthrive-collapse-bottom-right"),e}static addMaxResolutionQueryParam(e){const t=`max_resolution=${D()?"320":"1280"}`,[i,n]=String(e).split("?");return`${i}?${n?n+`&${t}`:t}`}}class G{constructor(e){this._clsOptions=e,this.removeVideoTitleWrapper=w(this._clsOptions.siteAds.adOptions.removeVideoTitleWrapper,!1);const t=this._clsOptions.siteAds.videoPlayers;this.footerSelector=w(t&&t.footerSelector,""),this.players=w(t&&t.players.map((e=>(e.mobileLocation=V.setMobileLocation(e.mobileLocation),e))),[]),this.relatedSettings=t&&t.contextual}}class N{constructor(e){this.mobileStickyPlayerOnPage=!1,this.playlistPlayerAdded=!1,this.relatedPlayerAdded=!1,this.footerSelector="",this.removeVideoTitleWrapper=!1,this.videoAdOptions=new G(e),this.players=this.videoAdOptions.players,this.relatedSettings=this.videoAdOptions.relatedSettings,this.removeVideoTitleWrapper=this.videoAdOptions.removeVideoTitleWrapper,this.footerSelector=this.videoAdOptions.footerSelector}}class W{}class B extends W{get(){if(this._probability<0||this._probability>1)throw new Error(`Invalid probability: ${this._probability}`);return Math.random()<this._probability}constructor(e){super(),this._probability=e}}class F{setExperimentKey(e=!1){this._clsOptions.setExperiment(this.abgroup,this.result,e)}constructor(){this._clsOptions=new H,this.shouldUseCoreExperimentsConfig=!1}}class z extends F{get result(){return this._result}run(){return new B(this.weight).get()}constructor(e){super(),this._result=!1,this.key="ParallaxAdsExperiment",this.abgroup="parallax",this._choices=[{choice:!0},{choice:!1}],this.weight=0;!!D()&&e.largeFormatsMobile&&(this._result=this.run(),this.setExperimentKey())}}const q=[[728,90],[300,250],[300,600],[320,50],[970,250],[160,600],[300,1050],[336,280],[970,90],[300,50],[320,100],[468,60],[250,250],[120,240],[1,1],[300,300],[552,334],[300,420],[728,250],[320,300],[300,390]],U=[[300,600],[160,600]],Q=new Map([[l,1],[c,2],[d,3],[r,4],[a,5],["Sidebar_sticky",6],["Below Post",7]]),J=(e,t)=>{const{location:i,sticky:n}=e;if(i===a&&t){const{recipeMobile:e,recipeDesktop:i}=t;if(D()&&(null==e?void 0:e.enabled))return!0;if(!D()&&(null==i?void 0:i.enabled))return!0}return i===l||n},K=(e,t)=>{const i=t.adUnits,n=(e=>!!e.adTypes&&new z(e.adTypes).result)(t);return i.filter((e=>void 0!==e.dynamic&&e.dynamic.enabled)).map((i=>{const s=i.location.replace(/\s+/g,"_"),o="Sidebar"===s?0:2;return{auctionPriority:Q.get(s)||8,location:s,sequence:w(i.sequence,1),sizes:(h=i.adSizes,q.filter((([e,t])=>h.some((([i,n])=>e===i&&t===n))))).filter((t=>((e,[t,i],n)=>{const{location:s,sequence:o}=e;if(s===l)return!("phone"===n&&320===t&&100===i);if(s===c)return!0;if(s===a)return!(D()&&"phone"===n&&(300===t&&390===i||320===t&&300===i));if(s===d){const t=e.adSizes.some((([,e])=>e<=300)),n=i>300;return!(!n||t)||9===o||(o&&o<=5?!n||e.sticky:!n)}return!0})(i,t,e))).concat(n&&i.location===r?U:[]),devices:i.devices,pageSelector:w(i.dynamic.pageSelector,"").trim(),elementSelector:w(i.dynamic.elementSelector,"").trim(),position:w(i.dynamic.position,"beforebegin"),max:Math.floor(w(i.dynamic.max,0)),spacing:w(i.dynamic.spacing,0),skip:Math.floor(w(i.dynamic.skip,0)),every:Math.max(Math.floor(w(i.dynamic.every,1)),1),classNames:i.dynamic.classNames||[],sticky:J(i,t.adOptions.stickyContainerConfig),stickyOverlapSelector:w(i.stickyOverlapSelector,"").trim(),autosize:i.autosize,special:w(i.targeting,[]).filter((e=>"special"===e.key)).reduce(((e,t)=>e.concat(...t.value)),[]),lazy:w(i.dynamic.lazy,!1),lazyMax:w(i.dynamic.lazyMax,o),lazyMaxDefaulted:0!==i.dynamic.lazyMax&&!i.dynamic.lazyMax,name:i.name};var h}))},Y=(e,t)=>{const i=(e=>{let t=e.clientWidth;if(getComputedStyle){const i=getComputedStyle(e,null);t-=parseFloat(i.paddingLeft||"0")+parseFloat(i.paddingRight||"0")}return t})(t),n=e.sticky&&e.location===d;return e.sizes.filter((t=>{const s=!e.autosize||(t[0]<=i||t[0]<=320),o=!n||t[1]<=window.innerHeight-100;return s&&o}))};class Z{constructor(e){this.clsOptions=e,this.enabledLocations=[o,r,a,d]}}const X=e=>`adthrive-${e.location.replace("_","-").toLowerCase()}`,ee=e=>`${X(e)}-${e.sequence}`;function te(e,t){void 0===t&&(t={});var i=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css","top"===i&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}const ie=e=>e.some((e=>null!==document.querySelector(e)));function ne(e,t,i,n){var s,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,i,r):s(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r}function se(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}"function"==typeof SuppressedError&&SuppressedError;class oe extends W{static fromArray(e,t){return new oe(e.map((([e,t])=>({choice:e,weight:t}))),t)}addChoice(e,t){this._choices.push({choice:e,weight:t})}get(){const e=(t=0,i=100,Math.random()*(i-t)+t);var t,i;let n=0;for(const{choice:t,weight:i}of this._choices)if(n+=i,n>=e)return t;return this._default}get totalWeight(){return this._choices.reduce(((e,{weight:t})=>e+t),0)}constructor(e=[],t){super(),this._choices=e,this._default=t}}const re=()=>(e,t,i)=>{const n=i.value;n&&(i.value=function(...e){const t=(e=>{if(null===e)return null;const t=e.map((({choice:e})=>e));return(e=>{let t=5381,i=e.length;for(;i;)t=33*t^e.charCodeAt(--i);return t>>>0})(JSON.stringify(t)).toString(16)})(this._choices),i=this._expConfigABGroup?this._expConfigABGroup:this.abgroup,s=i?i.toLowerCase():this.key?this.key.toLowerCase():"",o=t?`${s}_${t}`:s,r=this.localStoragePrefix?`${this.localStoragePrefix}-${o}`:o,a=I.readInternalLocalStorage("adthrive_branch");!1===(a&&a.enabled)&&I.deleteLocalStorage(r);const l=(()=>n.apply(this,e))(),c=(d=this._choices,h=l,null!=(p=null==(u=d.find((({choice:e})=>e===h)))?void 0:u.weight)?p:null);var d,h,u,p;const[m,g]=I.getOrSetABGroupLocalStorageValue(r,l,c,{value:24,unit:"hours"});return this._stickyResult=m,this._stickyWeight=g,m})};class ae{get enabled(){return void 0!==this.experimentConfig}_isValidResult(e,t=()=>!0){return t()&&(e=>null!=e&&!("number"==typeof e&&isNaN(e)))(e)}}class le extends ae{_isValidResult(e){return super._isValidResult(e,(()=>this._resultValidator(e)||"control"===e))}run(){if(!this.enabled)return x.error("CLSWeightedChoiceSiteExperiment","run","() => %o","No experiment config found. Defaulting to control."),"control";if(!this._mappedChoices||0===this._mappedChoices.length)return x.error("CLSWeightedChoiceSiteExperiment","run","() => %o","No experiment variants found. Defaulting to control."),"control";const e=new oe(this._mappedChoices).get();return this._isValidResult(e)?e:(x.error("CLSWeightedChoiceSiteExperiment","run","() => %o","Invalid result from experiment choices. Defaulting to control."),"control")}constructor(...e){super(...e),this._resultValidator=()=>!0}}class ce{getSiteExperimentByKey(e){const t=this.siteExperiments.filter((t=>t.key.toLowerCase()===e.toLowerCase()))[0],i=C("at_site_features"),n=(s=(null==t?void 0:t.variants[1])?null==t?void 0:t.variants[1].value:null==t?void 0:t.variants[0].value,o=i[e],typeof s==typeof o);var s,o;return t&&i[e]&&n&&(t.variants=[{displayName:"test",value:i[e],weight:100,id:0}]),t}constructor(e){var t,i;this.siteExperiments=[],this._clsOptions=e,this._device=D()?"mobile":"desktop",this.siteExperiments=null!=(i=null==(t=this._clsOptions.siteAds.siteExperiments)?void 0:t.filter((e=>{const t=e.key,i=T(e,this._device),n=M(this._clsOptions.siteAds,t,this._device);return i&&n})))?i:[]}}class de extends le{get result(){return this._result}run(){if(!this.enabled)return x.error("CLSAdLayoutSiteExperiment","run","() => %o","No experiment config found. Defaulting to empty class name."),"";const e=new oe(this._mappedChoices).get();return this._isValidResult(e)?e:(x.error("CLSAdLayoutSiteExperiment","run","() => %o","Invalid result from experiment choices. Defaulting to empty class name."),"")}_mapChoices(){return this._choices.map((({weight:e,value:t})=>({weight:e,choice:t})))}constructor(e){super(),this._choices=[],this._mappedChoices=[],this._result="",this._resultValidator=e=>"string"==typeof e,this.key=i,this.abgroup=i,this._clsSiteExperiments=new ce(e),this.experimentConfig=this._clsSiteExperiments.getSiteExperimentByKey(this.key),this.enabled&&this.experimentConfig&&(this._choices=this.experimentConfig.variants,this._mappedChoices=this._mapChoices(),this._result=this.run(),e.setWeightedChoiceExperiment(this.abgroup,this._result,!0))}}ne([re(),se("design:type",Function),se("design:paramtypes",[]),se("design:returntype",void 0)],de.prototype,"run",null);class he extends le{get result(){return this._result}run(){if(!this.enabled)return x.error("CLSTargetAdDensitySiteExperiment","run","() => %o","No experiment config found. Defaulting to control."),"control";const e=new oe(this._mappedChoices).get();return this._isValidResult(e)?e:(x.error("CLSTargetAdDensitySiteExperiment","run","() => %o","Invalid result from experiment choices. Defaulting to control."),"control")}_mapChoices(){return this._choices.map((({weight:e,value:t})=>({weight:e,choice:"number"==typeof t?(t||0)/100:"control"})))}constructor(e){super(),this._choices=[],this._mappedChoices=[],this._result="control",this._resultValidator=e=>"number"==typeof e,this.key=t,this.abgroup=t,this._clsSiteExperiments=new ce(e),this.experimentConfig=this._clsSiteExperiments.getSiteExperimentByKey(this.key),this.enabled&&this.experimentConfig&&(this._choices=this.experimentConfig.variants,this._mappedChoices=this._mapChoices(),this._result=this.run(),e.setWeightedChoiceExperiment(this.abgroup,this._result,!0))}}ne([re(),se("design:type",Function),se("design:paramtypes",[]),se("design:returntype",void 0)],he.prototype,"run",null);const ue="250px";class pe{start(){try{var e,t;(e=>{const t=document.body,i=`adthrive-device-${e}`;if(!t.classList.contains(i))try{t.classList.add(i)}catch(e){x.error("BodyDeviceClassComponent","init",{message:e.message});const t="classList"in document.createElement("_");x.error("BodyDeviceClassComponent","init.support",{support:t})}})(this._device);const s=new de(this._clsOptions);if(s.enabled){const e=s.result,t=e.startsWith(".")?e.substring(1):e;if((e=>/^[-_a-zA-Z]+[-_a-zA-Z0-9]*$/.test(e))(t))try{document.body.classList.add(t)}catch(e){x.error("ClsDynamicAdsInjector","start",`Uncaught CSS Class error: ${e}`)}else x.error("ClsDynamicAdsInjector","start",`Invalid class name: ${t}`)}const o=K(this._device,this._clsOptions.siteAds).filter((e=>this._locationEnabled(e))).filter((e=>{return t=e,i=this._device,t.devices.includes(i);var t,i})).filter((e=>{return 0===(t=e).pageSelector.length||null!==document.querySelector(t.pageSelector);var t})),r=this.inject(o);var i,n;if(null==(t=this._clsOptions.siteAds.adOptions.stickyContainerConfig)||null==(e=t.content)?void 0:e.enabled)if(!ie(this._clsOptions.siteAds.adOptions.stickyContainerConfig.blockedSelectors||[]))te(`\n  .adthrive-device-phone .adthrive-sticky-content {\n    height: 450px !important;\n    margin-bottom: 100px !important;\n  }\n  .adthrive-content.adthrive-sticky {\n    position: -webkit-sticky;\n    position: sticky !important;\n    top: 42px !important;\n    margin-top: 42px !important;\n  }\n  .adthrive-content.adthrive-sticky:after {\n    content: "— Advertisement. Scroll down to continue. —";\n    font-size: 10pt;\n    margin-top: 5px;\n    margin-bottom: 5px;\n    display:block;\n    color: #888;\n  }\n  .adthrive-sticky-container {\n    position: relative;\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-start;\n    align-items: center;\n    min-height:${(null==(n=this._clsOptions.siteAds.adOptions.stickyContainerConfig)||null==(i=n.content)?void 0:i.minHeight)||400}px !important;\n    margin: 10px 0 10px 0;\n    background-color: #FAFAFA;\n    padding-bottom:0px;\n  }\n  `);r.forEach((e=>this._clsOptions.setInjectedSlots(e)))}catch(e){x.error("ClsDynamicAdsInjector","start",e)}}inject(e,t=document){this._densityDevice="desktop"===this._device?h:u,this._overrideDefaultAdDensitySettingsWithSiteExperiment();const i=this._clsOptions.siteAds,n=w(i.adDensityEnabled,!0),s=i.adDensityLayout&&n,o=e.filter((e=>s?e.location!==r:e)),a=e.filter((e=>s?e.location===r:null));return[...o.length?this._injectNonDensitySlots(o,t):[],...a.length?this._injectDensitySlots(a,t):[]]}_injectNonDensitySlots(e,t=document){var i;const n=[],s=[];if(e.some((e=>e.location===a&&e.sticky))&&!ie((null==(i=this._clsOptions.siteAds.adOptions.stickyContainerConfig)?void 0:i.blockedSelectors)||[])){var o,r;const e=this._clsOptions.siteAds.adOptions.stickyContainerConfig;(e=>{te(`\n  .adthrive-recipe.adthrive-sticky {\n    position: -webkit-sticky;\n    position: sticky !important;\n    top: 42px !important;\n    margin-top: 42px !important;\n  }\n  .adthrive-recipe-sticky-container {\n    position: relative;\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-start;\n    align-items: center;\n    min-height:${e||400}px !important;\n    margin: 10px 0 10px 0;\n    background-color: #FAFAFA;\n    padding-bottom:0px;\n  }\n  `)})("phone"===this._device?null==e||null==(o=e.recipeMobile)?void 0:o.minHeight:null==e||null==(r=e.recipeDesktop)?void 0:r.minHeight)}for(const i of e)this._insertNonDensityAds(i,n,s,t);return s.forEach((({location:e,element:t})=>{t.style.minHeight=this.locationToMinHeight[e]})),n}_injectDensitySlots(e,t=document){try{this._calculateMainContentHeightAndAllElements(e,t)}catch(e){return[]}const{onePerViewport:i,targetAll:n,targetDensityUnits:s,combinedMax:o,numberOfUnits:r}=this._getDensitySettings(e,t);return this._absoluteMinimumSpacingByDevice=i?window.innerHeight:this._absoluteMinimumSpacingByDevice,r?(this._adInjectionMap.filterUsed(),this._findElementsForAds(r,i,n,o,s,t),this._insertAds()):[]}_overrideDefaultAdDensitySettingsWithSiteExperiment(){var e;if(null==(e=this._clsTargetAdDensitySiteExperiment)?void 0:e.enabled){const e=this._clsTargetAdDensitySiteExperiment.result;"number"==typeof e&&(this._clsOptions.siteAds.adDensityEnabled=!0,this._clsOptions.siteAds.adDensityLayout[this._densityDevice].adDensity=e)}}_getDensitySettings(e,t=document){const i=this._clsOptions.siteAds.adDensityLayout,n=this._determineOverrides(i.pageOverrides),s=n.length?n[0]:i[this._densityDevice],o=this._clsOptions.getTargetDensity(s.adDensity),r=s.onePerViewport,a=this._shouldTargetAllEligible(o);let l=this._getTargetDensityUnits(o,a);const c=this._clsOptions.getWeightedChoiceExperiment("iosad");l<1&&c&&(l=1);const d=this._getCombinedMax(e,t),h=Math.min(this._totalAvailableElements.length,l,...d>0?[d]:[]);return this._pubLog={onePerViewport:r,targetDensity:o,targetDensityUnits:l,combinedMax:d},{onePerViewport:r,targetAll:a,targetDensityUnits:l,combinedMax:d,numberOfUnits:h}}_determineOverrides(e){return e.filter((e=>{const t=R(e.pageSelector);return""===e.pageSelector||t.elements&&t.elements.length})).map((e=>e[this._densityDevice]))}_shouldTargetAllEligible(e){return e===this._densityMax}_getTargetDensityUnits(e,t){return t?this._totalAvailableElements.length:Math.floor(e*this._mainContentHeight/(1-e)/this._minDivHeight)-this._recipeCount}_getCombinedMax(e,t=document){return w(e.filter((e=>{let i;try{i=t.querySelector(e.elementSelector)}catch(e){}return i})).map((e=>Number(e.max)+Number(e.lazyMaxDefaulted?0:e.lazyMax))).sort(((e,t)=>t-e))[0],0)}_elementLargerThanMainContent(e){return e.offsetHeight>=this._mainContentHeight&&this._totalAvailableElements.length>1}_elementDisplayNone(e){const t=window.getComputedStyle(e,null).display;return t&&"none"===t||"none"===e.style.display}_isBelowMaxes(e,t){return this._adInjectionMap.map.length<e&&this._adInjectionMap.map.length<t}_findElementsForAds(e,t,i,n,s,o=document){this._clsOptions.targetDensityLog={onePerViewport:t,combinedMax:n,targetDensityUnits:s,targetDensityPercentage:this._pubLog.targetDensity,mainContentHeight:this._mainContentHeight,recipeCount:this._recipeCount,numberOfEls:this._totalAvailableElements.length};const r=e=>{for(const{dynamicAd:t,element:r}of this._totalAvailableElements)if(this._logDensityInfo(r,t.elementSelector,e),!(!i&&this._elementLargerThanMainContent(r)||this._elementDisplayNone(r))){if(!this._isBelowMaxes(n,s))break;this._checkElementSpacing({dynamicAd:t,element:r,insertEvery:e,targetAll:i,target:o})}!this._usedAbsoluteMinimum&&this._smallerIncrementAttempts<5&&(++this._smallerIncrementAttempts,r(this._getSmallerIncrement(e)))},a=this._getInsertEvery(e,t,s);r(a)}_getSmallerIncrement(e){let t=.6*e;return t<=this._absoluteMinimumSpacingByDevice&&(t=this._absoluteMinimumSpacingByDevice,this._usedAbsoluteMinimum=!0),t}_insertNonDensityAds(e,t,i,n=document){let s=0,o=0,r=0;e.spacing>0&&(s=window.innerHeight*e.spacing,o=s);const l=this._repeatDynamicAds(e),c=this.getElements(e.elementSelector,n);e.skip;for(let h=e.skip;h<c.length&&!(r+1>l.length);h+=e.every){let u=c[h];if(s>0){const{bottom:e}=E(u);if(e<=o)continue;o=e+s}const p=l[r],m=`${p.location}_${p.sequence}`;t.some((e=>e.name===m))&&(r+=1);const g=this.getDynamicElementId(p),y=X(e),_=ee(e),f=[e.location===d&&e.sticky&&e.sequence&&e.sequence<=5?"adthrive-sticky-sidebar":"",e.location===a&&e.sticky?"adthrive-recipe-sticky-container":"",y,_,...e.classNames],v=this.addAd(u,g,e.position,f);if(v){const s=Y(p,v);if(s.length){const o={clsDynamicAd:e,dynamicAd:p,element:v,sizes:s,name:m,infinite:n!==document};t.push(o),i.push({location:p.location,element:v}),e.location===a&&++this._recipeCount,r+=1}u=v}}}_insertAds(){const e=[];return this._adInjectionMap.filterUsed(),this._adInjectionMap.map.forEach((({el:t,dynamicAd:i,target:n},s)=>{const o=Number(i.sequence)+s,r=i.max,a=i.lazy&&o>r;i.sequence=o,i.lazy=a;const l=this._addContentAd(t,i,n);l&&(i.used=!0,e.push(l))})),e}_getInsertEvery(e,t,i){let n=this._absoluteMinimumSpacingByDevice;return this._moreAvailableElementsThanUnitsToInject(i,e)?(this._usedAbsoluteMinimum=!1,n=this._useWiderSpacing(i,e)):(this._usedAbsoluteMinimum=!0,n=this._useSmallestSpacing(t)),t&&window.innerHeight>n?window.innerHeight:n}_useWiderSpacing(e,t){return this._mainContentHeight/Math.min(e,t)}_useSmallestSpacing(e){return e&&window.innerHeight>this._absoluteMinimumSpacingByDevice?window.innerHeight:this._absoluteMinimumSpacingByDevice}_moreAvailableElementsThanUnitsToInject(e,t){return this._totalAvailableElements.length>e||this._totalAvailableElements.length>t}_logDensityInfo(e,t,i){const{onePerViewport:n,targetDensity:s,targetDensityUnits:o,combinedMax:r}=this._pubLog;this._totalAvailableElements.length}_checkElementSpacing({dynamicAd:t,element:i,insertEvery:n,targetAll:s,target:o=document}){(this._isFirstAdInjected()||this._hasProperSpacing(i,t,s,n))&&this._markSpotForContentAd(i,e({},t),o)}_isFirstAdInjected(){return!this._adInjectionMap.map.length}_markSpotForContentAd(e,t,i=document){const n="beforebegin"===t.position||"afterbegin"===t.position;this._adInjectionMap.add(e,this._getElementCoords(e,n),t,i),this._adInjectionMap.sort()}_hasProperSpacing(e,t,i,n){const s="beforebegin"===t.position||"afterbegin"===t.position,r="beforeend"===t.position||"afterbegin"===t.position,a=i||this._isElementFarEnoughFromOtherAdElements(e,n,s),l=r||this._isElementNotInRow(e,s),c=-1===e.id.indexOf(`AdThrive_${o}`);return a&&l&&c}_isElementFarEnoughFromOtherAdElements(e,t,i){const n=this._getElementCoords(e,i);let s=!1;for(let e=0;e<this._adInjectionMap.map.length;e++){const i=this._adInjectionMap.map[e].coords,o=this._adInjectionMap.map[e+1]&&this._adInjectionMap.map[e+1].coords;if(s=n-t>i&&(!o||n+t<o),s)break}return s}_isElementNotInRow(e,t){const i=e.previousElementSibling,n=e.nextElementSibling,s=t?!i&&n||i&&e.tagName!==i.tagName?n:i:n;return!(!s||0!==e.getBoundingClientRect().height)||(!s||e.getBoundingClientRect().top!==s.getBoundingClientRect().top)}_calculateMainContentHeightAndAllElements(e,t=document){const[i,n]=((e,t,i=document)=>{const[n,s]=P(e,t,i);if(0===n.length)throw Error("No Main Content Elements Found");return[Array.from(n).reduce(((e,t)=>t.offsetHeight>e.offsetHeight?t:e))||document.body,s]})(e,this._adInjectionMap,t);this._mainContentDiv=i,this._totalAvailableElements=n,this._mainContentHeight=((e,t="div #comments, section .comments")=>{const i=e.querySelector(t);return i?e.offsetHeight-i.offsetHeight:e.offsetHeight})(this._mainContentDiv)}_getElementCoords(e,t=!1){const i=e.getBoundingClientRect();return(t?i.top:i.bottom)+window.scrollY}_addContentAd(e,t,i=document){var n,s;let o=null;const r=X(t),a=ee(t),l=(null==(s=this._clsOptions.siteAds.adOptions.stickyContainerConfig)||null==(n=s.content)?void 0:n.enabled)?"adthrive-sticky-container":"",c=this.addAd(e,this.getDynamicElementId(t),t.position,[l,r,a,...t.classNames]);if(c){const e=Y(t,c);if(e.length){c.style.minHeight=this.locationToMinHeight[t.location];o={clsDynamicAd:t,dynamicAd:t,element:c,sizes:e,name:`${t.location}_${t.sequence}`,infinite:i!==document}}}return o}getDynamicElementId(e){return`AdThrive_${e.location}_${e.sequence}_${this._device}`}getElements(e,t=document){return t.querySelectorAll(e)}addAd(e,t,i,n=[]){if(!document.getElementById(t)){const s=`<div id="${t}" class="adthrive-ad ${n.join(" ")}"></div>`;e.insertAdjacentHTML(i,s)}return document.getElementById(t)}_repeatDynamicAds(t){const i=[],n=t.location===a?99:this.locationMaxLazySequence.get(t.location),s=t.lazy?w(n,0):0,o=t.max,r=t.lazyMax,l=0===s&&t.lazy?o+r:Math.min(Math.max(s-t.sequence+1,0),o+r),c=Math.max(o,l);for(let n=0;n<c;n++){const s=Number(t.sequence)+n;if("Recipe_1"!==t.name||5!==s){const r=t.lazy&&n>=o;i.push(e({},t,{sequence:s,lazy:r}))}}return i}_locationEnabled(e){const t=this._clsOptions.enabledLocations.includes(e.location),i=this._clsOptions.disableAds&&this._clsOptions.disableAds.all||document.body.classList.contains("adthrive-disable-all"),n=!document.body.classList.contains("adthrive-disable-content")&&!this._clsOptions.disableAds.reasons.has("content_plugin");return t&&!i&&n}constructor(e,t){this._clsOptions=e,this._adInjectionMap=t,this._recipeCount=0,this._mainContentHeight=0,this._mainContentDiv=null,this._totalAvailableElements=[],this._minDivHeight=250,this._densityDevice=h,this._pubLog={onePerViewport:!1,targetDensity:0,targetDensityUnits:0,combinedMax:0},this._densityMax=.99,this._smallerIncrementAttempts=0,this._absoluteMinimumSpacingByDevice=250,this._usedAbsoluteMinimum=!1,this._infPageEndOffset=0,this.locationMaxLazySequence=new Map([[a,5]]),this.locationToMinHeight={Below_Post:ue,Content:ue,Recipe:ue,Sidebar:ue};const{tablet:i,desktop:n}=this._clsOptions.siteAds.breakpoints;this._device=((e,t)=>{const i=window.innerWidth;return i>=t?"desktop":i>=e?"tablet":"phone"})(i,n),this._config=new Z(e),this._clsOptions.enabledLocations=this._config.enabledLocations,this._clsTargetAdDensitySiteExperiment=this._clsOptions.siteAds.siteExperiments?new he(this._clsOptions):null}}function me(e,t){if(null==e)return{};var i,n,s={},o=Object.keys(e);for(n=0;n<o.length;n++)i=o[n],t.indexOf(i)>=0||(s[i]=e[i]);return s}class ge{get enabled(){return!0}}class ye extends ge{setPotentialPlayersMap(){const e=this._videoConfig.players||[],t=this._filterPlayerMap(),i=e.filter((e=>"stationaryRelated"===e.type&&e.enabled));return t.stationaryRelated=i,this._potentialPlayerMap=t,this._potentialPlayerMap}_filterPlayerMap(){const e=this._videoConfig.players,t={stickyRelated:[],stickyPlaylist:[],stationaryRelated:[]};return e&&e.length?e.filter((e=>{var t;return null==(t=e.devices)?void 0:t.includes(this._device)})).reduce(((e,t)=>(e[t.type]||(x.event(this._component,"constructor","Unknown Video Player Type detected",t.type),e[t.type]=[]),t.enabled&&e[t.type].push(t),e)),t):t}_checkPlayerSelectorOnPage(e){const t=this._potentialPlayerMap[e].map((e=>({player:e,playerElement:this._getPlacementElement(e)})));return t.length?t[0]:{player:null,playerElement:null}}_getOverrideElement(e,t,i){if(e&&t){const n=document.createElement("div");t.insertAdjacentElement(e.position,n),i=n}else{const{player:e,playerElement:t}=this._checkPlayerSelectorOnPage("stickyPlaylist");if(e&&t){const n=document.createElement("div");t.insertAdjacentElement(e.position,n),i=n}}return i}_shouldOverrideElement(e){const t=e.getAttribute("override-embed");return"true"===t||"false"===t?"true"===t:!!this._videoConfig.relatedSettings&&this._videoConfig.relatedSettings.overrideEmbedLocation}_checkPageSelector(e,t,i=[]){if(e&&t&&0===i.length){return!("/"===window.location.pathname)&&x.event("VideoUtils","getPlacementElement",new Error(`PSNF: ${e} does not exist on the page`)),!1}return!0}_getElementSelector(e,t,i){return t&&t.length>i?t[i]:(x.event("VideoUtils","getPlacementElement",new Error(`ESNF: ${e} does not exist on the page`)),null)}_getPlacementElement(e){const{pageSelector:t,elementSelector:i,skip:n}=e,s=R(t),{valid:o,elements:r}=s,a=me(s,["valid","elements"]),l=L(i),{valid:c,elements:d}=l,h=me(l,["valid","elements"]);if(""!==t&&!o)return x.error("VideoUtils","getPlacementElement",new Error(`${t} is not a valid selector`),a),null;if(!c)return x.error("VideoUtils","getPlacementElement",new Error(`${i} is not a valid selector`),h),null;if(!this._checkPageSelector(t,o,r))return null;return this._getElementSelector(i,d,n)||null}_getEmbeddedPlayerType(e){let t=e.getAttribute("data-player-type");return t&&"default"!==t||(t=this._videoConfig.relatedSettings?this._videoConfig.relatedSettings.defaultPlayerType:"static"),this._stickyRelatedOnPage&&(t="static"),t}_getMediaId(e){const t=e.getAttribute("data-video-id");return!!t&&(this._relatedMediaIds.push(t),t)}_createRelatedPlayer(e,t,i,n){"collapse"===t?this._createCollapsePlayer(e,i):"static"===t&&this._createStaticPlayer(e,i,n)}_createCollapsePlayer(t,i){const{player:n,playerElement:s}=this._checkPlayerSelectorOnPage("stickyRelated"),o=n||this._potentialPlayerMap.stationaryRelated[0];if(o&&o.playerId){this._shouldOverrideElement(i)&&(i=this._getOverrideElement(n,s,i)),i=document.querySelector(`#cls-video-container-${t} > div`)||i,this._createStickyRelatedPlayer(e({},o,{mediaId:t}),i)}else x.error(this._component,"_createCollapsePlayer","No video player found")}_createStaticPlayer(t,i,n){if(this._potentialPlayerMap.stationaryRelated.length&&this._potentialPlayerMap.stationaryRelated[0].playerId){const s=this._potentialPlayerMap.stationaryRelated[0];this._createStationaryRelatedPlayer(e({},s,{mediaOrPlaylistId:t}),i,n)}else x.error(this._component,"_createStaticPlayer","No video player found")}_shouldRunAutoplayPlayers(){return!(!this._isVideoAllowedOnPage()||!this._potentialPlayerMap.stickyRelated.length&&!this._potentialPlayerMap.stickyPlaylist.length)}_setPlaylistMediaIdWhenStationaryOnPage(t,i){if(this._potentialPlayerMap.stationaryRelated.length&&this._potentialPlayerMap.stationaryRelated[0].playerId&&t&&t.length){const n=t[0].getAttribute("data-video-id");return n?e({},i,{mediaId:n}):i}return i}_determineAutoplayPlayers(e){const t=this._component,i="VideoManagerComponent"===t,n=this._context;if(this._stickyRelatedOnPage)return void x.event(t,"stickyRelatedOnPage",i&&{device:n&&n.device,isDesktop:this._device}||{});const{playerElement:s}=this._checkPlayerSelectorOnPage("stickyPlaylist");let{player:o}=this._checkPlayerSelectorOnPage("stickyPlaylist");o&&o.playerId&&s?(o=this._setPlaylistMediaIdWhenStationaryOnPage(e,o),this._createPlaylistPlayer(o,s)):Math.random()<.01&&setTimeout((()=>{x.event(t,"noStickyPlaylist",i&&{vendor:"none",device:n&&n.device,isDesktop:this._device}||{})}),1e3)}_initializeRelatedPlayers(e){const t=new Map;for(let i=0;i<e.length;i++){const n=e[i],s=n.offsetParent,o=this._getEmbeddedPlayerType(n),r=this._getMediaId(n);if(s&&r){const e=(t.get(r)||0)+1;t.set(r,e),this._createRelatedPlayer(r,o,n,e)}}}constructor(e,t,i){super(),this._videoConfig=e,this._component=t,this._context=i,this._stickyRelatedOnPage=!1,this._relatedMediaIds=[],this._device=A()?"desktop":"mobile",this._potentialPlayerMap=this.setPotentialPlayersMap()}}class _e extends ye{init(){this._initializePlayers()}_wrapVideoPlayerWithCLS(e,t,i=0){if(e.parentNode){const n=e.offsetWidth*(9/16),s=this._createGenericCLSWrapper(n,t,i);return e.parentNode.insertBefore(s,e),s.appendChild(e),s}return null}_createGenericCLSWrapper(e,t,i){const n=document.createElement("div");return n.id=`cls-video-container-${t}`,n.className="adthrive",n.style.minHeight=`${e+i}px`,n}_getTitleHeight(){const e=document.createElement("h3");e.style.margin="10px 0",e.innerText="Title",e.style.visibility="hidden",document.body.appendChild(e);const t=window.getComputedStyle(e),i=parseInt(t.height,10),n=parseInt(t.marginTop,10),s=parseInt(t.marginBottom,10);return document.body.removeChild(e),Math.min(i+s+n,50)}_initializePlayers(){const e=document.querySelectorAll(this._IN_POST_SELECTOR);e.length&&this._initializeRelatedPlayers(e),this._shouldRunAutoplayPlayers()&&this._determineAutoplayPlayers(e)}_createStationaryRelatedPlayer(e,t,i){const n="mobile"===this._device?[400,225]:[640,360],s=y;if(t&&e.mediaOrPlaylistId){const o=`${e.mediaOrPlaylistId}_${i}`,r=this._wrapVideoPlayerWithCLS(t,o);this._playersAddedFromPlugin.push(e.mediaOrPlaylistId),r&&this._clsOptions.setInjectedVideoSlots({playerId:e.playerId,playerName:s,playerSize:n,element:r,type:"stationaryRelated"})}}_createStickyRelatedPlayer(e,t){const i="mobile"===this._device?[400,225]:[640,360],n=m;if(this._stickyRelatedOnPage=!0,this._videoConfig.mobileStickyPlayerOnPage="mobile"===this._device,t&&e.position&&e.mediaId){const s=document.createElement("div");t.insertAdjacentElement(e.position,s);const o=this._getTitleHeight(),r=this._wrapVideoPlayerWithCLS(s,e.mediaId,this._WRAPPER_BAR_HEIGHT+o);this._playersAddedFromPlugin.push(e.mediaId),r&&this._clsOptions.setInjectedVideoSlots({playlistId:e.playlistId,playerId:e.playerId,playerSize:i,playerName:n,element:s,type:"stickyRelated"})}}_createPlaylistPlayer(e,t){const i=e.playlistId,n="mobile"===this._device?g:p,s="mobile"===this._device?[400,225]:[640,360];this._videoConfig.mobileStickyPlayerOnPage=!0;const o=document.createElement("div");t.insertAdjacentElement(e.position,o);let r=this._WRAPPER_BAR_HEIGHT;e.title&&(r+=this._getTitleHeight());const a=this._wrapVideoPlayerWithCLS(o,i,r);this._playersAddedFromPlugin.push(`playlist-${i}`),a&&this._clsOptions.setInjectedVideoSlots({playlistId:e.playlistId,playerId:e.playerId,playerSize:s,playerName:n,element:o,type:"stickyPlaylist"})}_isVideoAllowedOnPage(){const e=this._clsOptions.disableAds;if(e&&e.video){let t="";e.reasons.has("video_tag")?t="video tag":e.reasons.has("video_plugin")?t="video plugin":e.reasons.has("video_page")&&(t="command queue");const i=t?"ClsVideoInsertionMigrated":"ClsVideoInsertion";return x.error(i,"isVideoAllowedOnPage",new Error(`DBP: Disabled by publisher via ${t||"other"}`)),!1}return!this._clsOptions.videoDisabledFromPlugin}constructor(e,t){super(e,"ClsVideoInsertion"),this._videoConfig=e,this._clsOptions=t,this._IN_POST_SELECTOR=".adthrive-video-player",this._WRAPPER_BAR_HEIGHT=36,this._playersAddedFromPlugin=[],t.removeVideoTitleWrapper&&(this._WRAPPER_BAR_HEIGHT=0)}}class fe{add(e,t,i,n=document){this._map.push({el:e,coords:t,dynamicAd:i,target:n})}get map(){return this._map}sort(){this._map.sort((({coords:e},{coords:t})=>e-t))}filterUsed(){this._map=this._map.filter((({dynamicAd:e})=>!e.used))}reset(){this._map=[]}constructor(){this._map=[]}}class ve extends fe{}const be=e=>{const t=S(),i=(()=>{const e=D()?"mobile":"tablet";return A(f)?"desktop":e})(),n=e.siteAdsProfiles;let s=null;if(n&&n.length)for(const e of n){const n=e.targeting.device,o=e.targeting.browserEngine,r=n&&n.length&&n.includes(i),a=o&&o.length&&o.includes(t);r&&a&&(s=e)}return s};try{(()=>{const e=new H;e&&e.enabled&&(e.siteAds&&(e=>{const t=be(e);if(t){const e=t.profileId;document.body.classList.add(`raptive-profile-${e}`)}})(e.siteAds),new pe(e,new ve).start(),new _e(new N(e),e).init())})()}catch(e){x.error("CLS","pluginsertion-iife",e),window.adthriveCLS&&(window.adthriveCLS.injectedFromPlugin=!1)}}();
</script><script data-no-optimize="1" data-cfasync="false">(function () {var clsElements = document.querySelectorAll("script[id^='cls-']"); window.adthriveCLS && clsElements && clsElements.length === 0 ? window.adthriveCLS.injectedFromPlugin = false : ""; })();</script><script>(function(){var advanced_ads_ga_UID="G-JZP3DWZZ8W",advanced_ads_ga_anonymIP=!!1;window.advanced_ads_check_adblocker=function(){var t=[],n=null;function e(t){var n=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(t){return setTimeout(t,16)};n.call(window,t)}return e((function(){var a=document.createElement("div");a.innerHTML="&nbsp;",a.setAttribute("class","ad_unit ad-unit text-ad text_ad pub_300x250"),a.setAttribute("style","width: 1px !important; height: 1px !important; position: absolute !important; left: 0px !important; top: 0px !important; overflow: hidden !important;"),document.body.appendChild(a),e((function(){var e,o,i=null===(e=(o=window).getComputedStyle)||void 0===e?void 0:e.call(o,a),d=null==i?void 0:i.getPropertyValue("-moz-binding");n=i&&"none"===i.getPropertyValue("display")||"string"==typeof d&&-1!==d.indexOf("about:");for(var c=0,r=t.length;c<r;c++)t[c](n);t=[]}))})),function(e){"undefined"==typeof advanced_ads_adblocker_test&&(n=!0),null!==n?e(n):t.push(e)}}(),(()=>{function t(t){this.UID=t,this.analyticsObject="function"==typeof gtag;var n=this;return this.count=function(){gtag("event","AdBlock",{event_category:"Advanced Ads",event_label:"Yes",non_interaction:!0,send_to:n.UID})},function(){if(!n.analyticsObject){var e=document.createElement("script");e.src="https://www.googletagmanager.com/gtag/js?id="+t,e.async=!0,document.body.appendChild(e),window.dataLayer=window.dataLayer||[],window.gtag=function(){dataLayer.push(arguments)},n.analyticsObject=!0,gtag("js",new Date)}var a={send_page_view:!1,transport_type:"beacon"};window.advanced_ads_ga_anonymIP&&(a.anonymize_ip=!0),gtag("config",t,a)}(),this}advanced_ads_check_adblocker((function(n){n&&new t(advanced_ads_ga_UID).count()}))})();})();</script><script type="speculationrules">
{"prefetch":[{"source":"document","where":{"and":[{"href_matches":"\/*"},{"not":{"href_matches":["\/wp-*.php","\/wp-admin\/*","\/wp-content\/uploads\/*","\/wp-content\/*","\/wp-content\/plugins\/*","\/wp-content\/themes\/canvas-new\/*","\/*\\?(.+)"]}},{"not":{"selector_matches":"a[rel~=\"nofollow\"]"}},{"not":{"selector_matches":".no-prefetch, .no-prefetch a"}}]},"eagerness":"conservative"}]}
</script>
<!-- Drip -->
<script data-cfasync="false" type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip -->
<script data-cfasync="false">
(function (w,d,t) {
  _ml = w._ml || {};
  _ml.eid = '91520';
  var s, cd, tag; s = d.getElementsByTagName(t)[0]; cd = new Date();
  tag = d.createElement(t); tag.async = 1;
  tag.src = 'https://ml314.com/tag.aspx?' + cd.getDate() + cd.getMonth();
  s.parentNode.insertBefore(tag, s);
})(window,document,'script');
</script><script type="text/javascript">
		/* MonsterInsights Scroll Tracking */
		if ( typeof(jQuery) !== 'undefined' ) {
		jQuery( document ).ready(function(){
		function monsterinsights_scroll_tracking_load() {
		if ( ( typeof(__gaTracker) !== 'undefined' && __gaTracker && __gaTracker.hasOwnProperty( "loaded" ) && __gaTracker.loaded == true ) || ( typeof(__gtagTracker) !== 'undefined' && __gtagTracker ) ) {
		(function(factory) {
		factory(jQuery);
		}(function($) {

		/* Scroll Depth */
		"use strict";
		var defaults = {
		percentage: true
		};

		var $window = $(window),
		cache = [],
		scrollEventBound = false,
		lastPixelDepth = 0;

		/*
		* Plugin
		*/

		$.scrollDepth = function(options) {

		var startTime = +new Date();

		options = $.extend({}, defaults, options);

		/*
		* Functions
		*/

		function sendEvent(action, label, scrollDistance, timing) {
		if ( 'undefined' === typeof MonsterInsightsObject || 'undefined' === typeof MonsterInsightsObject.sendEvent ) {
		return;
		}
			var paramName = action.toLowerCase();
	var fieldsArray = {
	send_to: 'G-JZP3DWZZ8W',
	non_interaction: true
	};
	fieldsArray[paramName] = label;

	if (arguments.length > 3) {
	fieldsArray.scroll_timing = timing
	MonsterInsightsObject.sendEvent('event', 'scroll_depth', fieldsArray);
	} else {
	MonsterInsightsObject.sendEvent('event', 'scroll_depth', fieldsArray);
	}
			}

		function calculateMarks(docHeight) {
		return {
		'25%' : parseInt(docHeight * 0.25, 10),
		'50%' : parseInt(docHeight * 0.50, 10),
		'75%' : parseInt(docHeight * 0.75, 10),
		/* Cushion to trigger 100% event in iOS */
		'100%': docHeight - 5
		};
		}

		function checkMarks(marks, scrollDistance, timing) {
		/* Check each active mark */
		$.each(marks, function(key, val) {
		if ( $.inArray(key, cache) === -1 && scrollDistance >= val ) {
		sendEvent('Percentage', key, scrollDistance, timing);
		cache.push(key);
		}
		});
		}

		function rounded(scrollDistance) {
		/* Returns String */
		return (Math.floor(scrollDistance/250) * 250).toString();
		}

		function init() {
		bindScrollDepth();
		}

		/*
		* Public Methods
		*/

		/* Reset Scroll Depth with the originally initialized options */
		$.scrollDepth.reset = function() {
		cache = [];
		lastPixelDepth = 0;
		$window.off('scroll.scrollDepth');
		bindScrollDepth();
		};

		/* Add DOM elements to be tracked */
		$.scrollDepth.addElements = function(elems) {

		if (typeof elems == "undefined" || !$.isArray(elems)) {
		return;
		}

		$.merge(options.elements, elems);

		/* If scroll event has been unbound from window, rebind */
		if (!scrollEventBound) {
		bindScrollDepth();
		}

		};

		/* Remove DOM elements currently tracked */
		$.scrollDepth.removeElements = function(elems) {

		if (typeof elems == "undefined" || !$.isArray(elems)) {
		return;
		}

		$.each(elems, function(index, elem) {

		var inElementsArray = $.inArray(elem, options.elements);
		var inCacheArray = $.inArray(elem, cache);

		if (inElementsArray != -1) {
		options.elements.splice(inElementsArray, 1);
		}

		if (inCacheArray != -1) {
		cache.splice(inCacheArray, 1);
		}

		});

		};

		/*
		* Throttle function borrowed from:
		* Underscore.js 1.5.2
		* http://underscorejs.org
		* (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
		* Underscore may be freely distributed under the MIT license.
		*/

		function throttle(func, wait) {
		var context, args, result;
		var timeout = null;
		var previous = 0;
		var later = function() {
		previous = new Date;
		timeout = null;
		result = func.apply(context, args);
		};
		return function() {
		var now = new Date;
		if (!previous) previous = now;
		var remaining = wait - (now - previous);
		context = this;
		args = arguments;
		if (remaining <= 0) {
		clearTimeout(timeout);
		timeout = null;
		previous = now;
		result = func.apply(context, args);
		} else if (!timeout) {
		timeout = setTimeout(later, remaining);
		}
		return result;
		};
		}

		/*
		* Scroll Event
		*/

		function bindScrollDepth() {

		scrollEventBound = true;

		$window.on('scroll.scrollDepth', throttle(function() {
		/*
		* We calculate document and window height on each scroll event to
		* account for dynamic DOM changes.
		*/

		var docHeight = $(document).height(),
		winHeight = window.innerHeight ? window.innerHeight : $window.height(),
		scrollDistance = $window.scrollTop() + winHeight,

		/* Recalculate percentage marks */
		marks = calculateMarks(docHeight),

		/* Timing */
		timing = +new Date - startTime;

		checkMarks(marks, scrollDistance, timing);
		}, 500));

		}

		init();
		};

		/* UMD export */
		return $.scrollDepth;

		}));

		jQuery.scrollDepth();
		} else {
		setTimeout(monsterinsights_scroll_tracking_load, 200);
		}
		}
		monsterinsights_scroll_tracking_load();
		});
		}
		/* End MonsterInsights Scroll Tracking */
		
</script><style id='core-block-supports-inline-css' type='text/css'>
.wp-container-core-social-links-is-layout-fdcfc74e{justify-content:flex-start;}
</style>
<script type="text/javascript" src="https://machinelearningmastery.com/wp-includes/js/comment-reply.min.js?ver=6.8" id="comment-reply-js" async="async" data-wp-strategy="async"></script>
<script type="text/javascript" src="https://machinelearningmastery.com/wp-content/plugins/simple-social-buttons/assets/js/frontend-blocks.js?ver=6.1.0" id="ssb-blocks-front-js-js"></script>
<script type="text/javascript" src="//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=6.8" id="mathjax-js"></script>
<script type="text/javascript" id="ssb-front-js-js-extra">
/* <![CDATA[ */
var SSB = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","fb_share_nonce":"28693cd6bc"};
/* ]]> */
</script>
<script type="text/javascript" src="https://machinelearningmastery.com/wp-content/plugins/simple-social-buttons/assets/js/front.js?ver=6.1.0" id="ssb-front-js-js"></script>
<script type="text/javascript" id="advanced-ads-pro/front-js-extra">
/* <![CDATA[ */
var advanced_ads_cookies = {"cookie_path":"\/","cookie_domain":""};
var advadsCfpInfo = {"cfpExpHours":"3","cfpClickLimit":"3","cfpBan":"7","cfpPath":"","cfpDomain":"","cfpEnabled":""};
/* ]]> */
</script>
<script type="text/javascript" src="https://machinelearningmastery.com/wp-content/uploads/966/902/assets/js/161.js?ver=3.0.3" id="advanced-ads-pro/front-js"></script>
<script type="text/javascript" id="q2w3_fixed_widget-js-extra">
/* <![CDATA[ */
var q2w3_sidebar_options = [{"use_sticky_position":false,"margin_top":10,"margin_bottom":0,"stop_elements_selectors":"","screen_max_width":400,"screen_max_height":0,"widgets":[]}];
/* ]]> */
</script>
<script type="text/javascript" src="https://machinelearningmastery.com/wp-content/plugins/q2w3-fixed-widget/js/frontend.min.js?ver=6.2.3" id="q2w3_fixed_widget-js"></script>
<script type="text/javascript" src="https://machinelearningmastery.com/wp-content/uploads/966/902/assets/js/28.js?ver=3.0.3" id="advanced-ads-pro/postscribe-js"></script>
<script type="text/javascript" id="advanced-ads-pro/cache_busting-js-extra">
/* <![CDATA[ */
var advanced_ads_pro_ajax_object = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","lazy_load_module_enabled":"","lazy_load":{"default_offset":0,"offsets":[]},"moveintohidden":"","wp_timezone_offset":"36000","the_id":"7553","is_singular":"1"};
var advanced_ads_responsive = {"reload_on_resize":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="https://machinelearningmastery.com/wp-content/uploads/966/902/assets/js/10/510.js?ver=3.0.3" id="advanced-ads-pro/cache_busting-js"></script>
<script type="text/javascript" id="advadsTrackingScript-js-extra">
/* <![CDATA[ */
var advadsTracking = {"impressionActionName":"aatrack-records","clickActionName":"aatrack-click","targetClass":"machi-target","blogId":"1","frontendPrefix":"machi-"};
/* ]]> */
</script>
<script type="text/javascript" src="https://machinelearningmastery.com/wp-content/uploads/966/202/assets/js/679/14.js?ver=3.0.2" id="advadsTrackingScript-js"></script>
<script type="text/javascript" src="https://machinelearningmastery.com/wp-content/uploads/966/202/assets/js/679/965.js?ver=3.0.2" id="advadsTrackingGAFront-js"></script>
<script type="text/javascript" src="https://machinelearningmastery.com/wp-includes/js/hoverIntent.min.js?ver=1.10.2" id="hoverIntent-js"></script>
<script type="text/javascript" src="https://machinelearningmastery.com/wp-content/plugins/megamenu/js/maxmegamenu.js?ver=3.5" id="megamenu-js"></script>
<script type="text/javascript" src="https://machinelearningmastery.com/wp-content/plugins/megamenu-pro/assets/public.js?ver=2.4" id="megamenu-pro-js"></script>
<script defer type="text/javascript" src="https://machinelearningmastery.com/wp-content/plugins/akismet/_inc/akismet-frontend.js?ver=1704837122" id="akismet-frontend-js"></script>
<script>window.advads_admin_bar_items = [];</script><script>window.advads_ajax_queries = [{"id":19301,"method":"placement","params":{"previous_id":19301,"previous_method":"placement","post":"r0","url_parameter":"\/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification\/","placement_type":"default","title":"Header","content":"New placement content goes here","type":"default","slug":"header","status":"publish","item":"group_512","display":{"0":{"type":"posttypes","operator":"is","value":["post"]},"2":{"type":"request_uri","operator":"contain_not","value":"\/blog\/"},"3":{"type":"request_uri","operator":"contain_not","value":"\/category\/"}},"visitors":[],"placement_position":"center","inline-css":"","cache-busting":"auto","cache_busting_empty":"0","visitor":[],"output":{"class":["machi-header"],"placement_id":19301}},"elementid":"machi-3ac169673c4bf5d96fcd467c493d7f6b","blog_id":1}];
window.advads_ajax_queries_args = {"r0":{"id":7553,"author":"1","post_type":"post"}};
( window.advanced_ads_ready || jQuery( document ).ready ).call( null, function() {if ( !window.advanced_ads_pro ) {console.log("Advanced Ads Pro: cache-busting can not be initialized");} });</script>		<script type="text/javascript">
			(function() {
			var t   = document.createElement( 'script' );
			t.type  = 'text/javascript';
			t.async = true;
			t.id    = 'gauges-tracker';
			t.setAttribute( 'data-site-id', '67058eec9c227c66ad914f97' );
			t.src = '//secure.gaug.es/track.js';
			var s = document.getElementsByTagName( 'script' )[0];
			s.parentNode.insertBefore( t, s );
			})();
		</script>
		<script>!function(){window.advanced_ads_ready_queue=window.advanced_ads_ready_queue||[],advanced_ads_ready_queue.push=window.advanced_ads_ready;for(var d=0,a=advanced_ads_ready_queue.length;d<a;d++)advanced_ads_ready(advanced_ads_ready_queue[d])}();</script><script>!function(){"use strict";!function(e){if(-1===e.cookie.indexOf("__adblocker")){e.cookie="__adblocker=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/";var t=new XMLHttpRequest;t.open("GET","https://ads.adthrive.com/abd/abd.js",!0),t.onreadystatechange=function(){if(XMLHttpRequest.DONE===t.readyState)if(200===t.status){var a=e.createElement("script");a.innerHTML=t.responseText,e.getElementsByTagName("head")[0].appendChild(a)}else{var n=new Date;n.setTime(n.getTime()+3e5),e.cookie="__adblocker=true; expires="+n.toUTCString()+"; path=/"}},t.send()}}(document)}();
</script><script id="machi-tracking">var advads_tracking_ads = {};var advads_tracking_urls = {"1":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php"};var advads_tracking_methods = {"1":"ga"};var advads_tracking_parallel = {"1":false};var advads_tracking_linkbases = {"1":"https:\/\/machinelearningmastery.com\/linkout\/"};var advads_gatracking_uids = {"1":["G-JZP3DWZZ8W"]};var advads_gatracking_allads = {"1":{"19726":{"title":"t1-pny-2504","target":"https:\/\/www.pny.com\/nvidia-rtx-pro-6000-blackwell?iscommercial=true&utm_source=KDNuggets+Banner+728x90&utm_medium=Web+Banners&utm_campaign=Blackwell+Server&utm_id=RTX+PRO+6000+","impression":true,"click":true},"19725":{"title":"s1-pny-2504","target":"https:\/\/www.pny.com\/nvidia-rtx-pro-6000-blackwell?iscommercial=true&utm_source=KDNuggets+Banner+300x250&utm_medium=Web+Banners&utm_campaign=Blackwell+Server&utm_id=RTX+PRO+6000+","impression":true,"click":true},"14921":{"title":"mlm-t1-cmu-2302","target":"","impression":true,"click":true}}};var advads_gatracking_anonym = false;var advads_gatracking_transmitpageqs = {};</script><script>!function(){"use strict";var e;e=document,function(){var t,n;function r(){var t=e.createElement("script");t.src="https://cafemedia-com.videoplayerhub.com/galleryplayer.js",e.head.appendChild(t)}function a(){var t=e.cookie.match("(^|[^;]+)\\s*__adblocker\\s*=\\s*([^;]+)");return t&&t.pop()}function c(){clearInterval(n)}return{init:function(){var e;"true"===(t=a())?r():(e=0,n=setInterval((function(){100!==e&&"false"!==t||c(),"true"===t&&(r(),c()),t=a(),e++}),50))}}}().init()}();
</script></body>
</html>
